<!DOCTYPE html><html lang="C"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0"><meta name="apple-mobile-web-app-capable" content="yes"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta property="og:type" content="website"><meta name="twitter:card" content="summary"><style>@media screen{body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container button{-webkit-tap-highlight-color:transparent;-webkit-appearance:none;appearance:none;background-color:transparent;border:0;color:inherit;cursor:pointer;font-size:inherit;opacity:.8;outline:none;padding:0;transition:opacity .2s linear}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:disabled,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:disabled,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:disabled,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container button:disabled{cursor:not-allowed;opacity:.15!important}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container button:hover{opacity:1}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:active,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:active,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover:active,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container button:hover:active{opacity:.6}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:not(:disabled),body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:not(:disabled),body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover:not(:disabled),body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container button:hover:not(:disabled){transition:none}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button.bespoke-marp-presenter-info-page-prev{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJNNjggOTAgMjggNTBsNDAtNDAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button.bespoke-marp-presenter-info-page-next{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJtMzIgOTAgNDAtNDAtNDAtNDAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen]{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6NXB4fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJhIiB4PSIxMCIgeT0iMjAiIHdpZHRoPSI4MCIgaGVpZ2h0PSI2MCIgcng9IjUuNjciLz48cGF0aCBjbGFzcz0iYSIgZD0iTTQwIDcwSDIwVjUwbTIwIDBMMjAgNzBtNDAtNDBoMjB2MjBtLTIwIDAgMjAtMjAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button.exit[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button.exit[data-bespoke-marp-osc=fullscreen]{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6NXB4fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJhIiB4PSIxMCIgeT0iMjAiIHdpZHRoPSI4MCIgaGVpZ2h0PSI2MCIgcng9IjUuNjciLz48cGF0aCBjbGFzcz0iYSIgZD0iTTIwIDUwaDIwdjIwbS0yMCAwIDIwLTIwbTQwIDBINjBWMzBtMjAgMEw2MCA1MCIvPjwvc3ZnPg==")}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter]{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBkPSJNODcuOCA0Ny41Qzg5IDUwIDg3LjcgNTIgODUgNTJIMzVhOC43IDguNyAwIDAgMS03LjItNC41bC0xNS42LTMxQzExIDE0IDEyLjIgMTIgMTUgMTJoNTBhOC44IDguOCAwIDAgMSA3LjIgNC41ek02MCA1MnYzNm0tMTAgMGgyME00NSA0MmgyMCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZmZmIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iNSIvPjwvc3ZnPg==") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container button.bespoke-marp-presenter-note-bigger{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBkPSJNMTIgNTBoODBNNTIgOTBWMTAiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjUiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container button.bespoke-marp-presenter-note-smaller{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBkPSJNMTIgNTBoODAiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjUiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}}@keyframes __bespoke_marp_transition_reduced_outgoing__{0%{opacity:1}to{opacity:0}}@keyframes __bespoke_marp_transition_reduced_incoming__{0%{mix-blend-mode:plus-lighter;opacity:0}to{mix-blend-mode:plus-lighter;opacity:1}}.bespoke-marp-note,.bespoke-marp-osc,.bespoke-progress-parent{display:none;transition:none}@media screen{::page-transition-container(*){animation-duration:var(--marp-bespoke-transition-animation-duration,.5s);animation-timing-function:ease}::page-transition-incoming-image(*),::page-transition-outgoing-image(*){animation-delay:0s;animation-direction:var(--marp-bespoke-transition-animation-direction,normal);animation-duration:var(--marp-bespoke-transition-animation-duration,.5s);animation-fill-mode:both;animation-name:var(--marp-bespoke-transition-animation-name,var(--marp-bespoke-transition-animation-name-fallback,__bespoke_marp_transition_no_animation__));mix-blend-mode:normal}::page-transition-outgoing-image(*){--marp-bespoke-transition-animation-name-fallback:__bespoke_marp_transition_reduced_outgoing__;animation-timing-function:ease}::page-transition-incoming-image(*){--marp-bespoke-transition-animation-name-fallback:__bespoke_marp_transition_reduced_incoming__;animation-timing-function:ease}::page-transition-incoming-image(root),::page-transition-outgoing-image(root){animation-timing-function:linear}::page-transition-incoming-image(__bespoke_marp_transition_osc__),::page-transition-outgoing-image(__bespoke_marp_transition_osc__){animation-duration:0s!important;animation-name:__bespoke_marp_transition_osc__!important}::page-transition-incoming-image(__bespoke_marp_transition_osc__){opacity:0!important}.bespoke-marp-transition-warming-up::page-transition-container(*),.bespoke-marp-transition-warming-up::page-transition-incoming-image(*),.bespoke-marp-transition-warming-up::page-transition-outgoing-image(*){animation-play-state:paused!important}body,html{height:100%;margin:0}body{background:#000;overflow:hidden}svg.bespoke-marp-slide{content-visibility:hidden;opacity:0;pointer-events:none;z-index:-1}svg.bespoke-marp-slide:not(.bespoke-marp-active) *{page-transition-tag:none!important}svg.bespoke-marp-slide.bespoke-marp-active{content-visibility:visible;opacity:1;pointer-events:auto;z-index:0}svg.bespoke-marp-slide.bespoke-marp-active.bespoke-marp-active-ready *{animation-name:__bespoke_marp__!important}@supports not (content-visibility:hidden){svg.bespoke-marp-slide[data-bespoke-marp-load=hideable]{display:none}svg.bespoke-marp-slide[data-bespoke-marp-load=hideable].bespoke-marp-active{display:block}}}@media screen and (prefers-reduced-motion:reduce){svg.bespoke-marp-slide *{page-transition-tag:none!important}}@media screen{[data-bespoke-marp-fragment=inactive]{visibility:hidden}body[data-bespoke-view=""] .bespoke-marp-parent,body[data-bespoke-view=next] .bespoke-marp-parent{bottom:0;left:0;position:absolute;right:0;top:0}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc{page-transition-tag:__bespoke_marp_transition_osc__;background:rgba(0,0,0,.65);border-radius:7px;bottom:50px;color:#fff;contain:paint;display:block;font-family:Helvetica,Arial,sans-serif;font-size:16px;left:50%;line-height:0;opacity:1;padding:12px;position:absolute;touch-action:manipulation;transform:translateX(-50%);transition:opacity .2s linear;-webkit-user-select:none;user-select:none;white-space:nowrap;will-change:transform;z-index:1}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>*,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>*{margin-left:6px}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>:first-child,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>:first-child{margin-left:0}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>span,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>span{opacity:.8}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>span[data-bespoke-marp-osc=page],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>span[data-bespoke-marp-osc=page]{display:inline-block;min-width:140px;text-align:center}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev]{height:32px;line-height:32px;width:32px}body[data-bespoke-view=""] .bespoke-marp-parent.bespoke-marp-inactive,body[data-bespoke-view=next] .bespoke-marp-parent.bespoke-marp-inactive{cursor:none}body[data-bespoke-view=""] .bespoke-marp-parent.bespoke-marp-inactive>.bespoke-marp-osc,body[data-bespoke-view=next] .bespoke-marp-parent.bespoke-marp-inactive>.bespoke-marp-osc{opacity:0;pointer-events:none}body[data-bespoke-view=""] svg.bespoke-marp-slide,body[data-bespoke-view=next] svg.bespoke-marp-slide{height:100%;left:0;position:absolute;top:0;width:100%}body[data-bespoke-view=""] .bespoke-progress-parent{background:#222;display:flex;height:5px;width:100%}body[data-bespoke-view=""] .bespoke-progress-parent+.bespoke-marp-parent{top:5px}body[data-bespoke-view=""] .bespoke-progress-parent .bespoke-progress-bar{background:#0288d1;flex:0 0 0;transition:flex-basis .2s cubic-bezier(0,1,1,1)}body[data-bespoke-view=next]{background:transparent}body[data-bespoke-view=presenter]{background:#161616}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container{display:grid;font-family:Helvetica,Arial,sans-serif;grid-template:"current dragbar next" minmax(140px,1fr) "current dragbar note" 2fr "info    dragbar note" 3em;grid-template-columns:minmax(3px,var(--bespoke-marp-presenter-split-ratio,66%)) 0 minmax(3px,1fr);height:100%;left:0;position:absolute;top:0;width:100%}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent{grid-area:current;overflow:hidden;position:relative}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent svg.bespoke-marp-slide{height:calc(100% - 40px);left:20px;pointer-events:none;position:absolute;top:20px;-webkit-user-select:none;user-select:none;width:calc(100% - 40px)}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent svg.bespoke-marp-slide.bespoke-marp-active{filter:drop-shadow(0 3px 10px rgba(0,0,0,.5))}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-dragbar-container{background:#0288d1;cursor:col-resize;grid-area:dragbar;margin-left:-3px;opacity:0;position:relative;transition:opacity .4s linear .1s;width:6px;z-index:10}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-dragbar-container:hover{opacity:1}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-dragbar-container.active{opacity:1;transition-delay:0s}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container{background:#222;cursor:pointer;display:none;grid-area:next;overflow:hidden;position:relative}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container.active{display:block}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container iframe.bespoke-marp-presenter-next{background:transparent;border:0;display:block;filter:drop-shadow(0 3px 10px rgba(0,0,0,.5));height:calc(100% - 40px);left:20px;pointer-events:none;position:absolute;top:20px;-webkit-user-select:none;user-select:none;width:calc(100% - 40px)}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container{background:#222;color:#eee;grid-area:note;position:relative;z-index:1}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container button{height:1.5em;line-height:1.5em;width:1.5em}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-presenter-note-wrapper{bottom:0;display:block;left:0;position:absolute;right:0;top:0}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-presenter-note-buttons{background:rgba(0,0,0,.65);border-radius:4px;bottom:0;display:flex;gap:4px;margin:12px;opacity:0;padding:6px;pointer-events:none;position:absolute;right:0;transition:opacity .2s linear}}@media screen{body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-presenter-note-buttons:focus-within,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-presenter-note-wrapper:focus-within+.bespoke-marp-presenter-note-buttons,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container:hover .bespoke-marp-presenter-note-buttons{opacity:1;pointer-events:auto}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note{word-wrap:break-word;box-sizing:border-box;font-size:calc(1.1em*var(--bespoke-marp-note-font-scale, 1));height:calc(100% - 40px);margin:20px;overflow:auto;padding-right:3px;scrollbar-color:hsla(0,0%,93%,.5) transparent;scrollbar-width:thin;white-space:pre-wrap;width:calc(100% - 40px)}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar{width:6px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar-track{background:transparent}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar-thumb{background:hsla(0,0%,93%,.5);border-radius:6px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note:empty{pointer-events:none}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note.active{display:block}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note p:first-child{margin-top:0}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note p:last-child{margin-bottom:0}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container{align-items:center;box-sizing:border-box;color:#eee;display:flex;flex-wrap:nowrap;grid-area:info;justify-content:center;overflow:hidden;padding:0 10px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-time,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-timer{box-sizing:border-box;display:block;padding:0 10px;white-space:nowrap;width:100%}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button{height:1.5em;line-height:1.5em;width:1.5em}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page{order:2;text-align:center}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page .bespoke-marp-presenter-info-page-text{display:inline-block;min-width:120px;text-align:center}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-time{color:#999;order:1;text-align:left}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-timer{color:#999;order:3;text-align:right}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-timer:hover{cursor:pointer}}@media print{.bespoke-marp-presenter-info-container,.bespoke-marp-presenter-next-container,.bespoke-marp-presenter-note-container{display:none}}</style><style>@charset "UTF-8";@import url("https://fonts.googleapis.com/css?family=Lato:400,900|Roboto+Mono:400,700&display=swap");div#p>svg>foreignObject>section{width:1280px;height:720px;box-sizing:border-box;overflow:hidden;position:relative;scroll-snap-align:center center}div#p>svg>foreignObject>section:after{bottom:0;content:attr(data-marpit-pagination);padding:inherit;pointer-events:none;position:absolute;right:0}div#p>svg>foreignObject>section:not([data-marpit-pagination]):after{display:none}/* Normalization */div#p>svg>foreignObject>section :is(h1,marp-h1){font-size:2em;margin:0.67em 0}div#p>svg>foreignObject>section video::-webkit-media-controls{will-change:transform}@page{size:1280px 720px;margin:0}@media print{body,html{background-color:#fff;margin:0;page-break-inside:avoid;break-inside:avoid-page}div#p>svg>foreignObject>section{page-break-before:always;break-before:page}div#p>svg>foreignObject>section,div#p>svg>foreignObject>section *{-webkit-print-color-adjust:exact!important;animation-delay:0s!important;animation-duration:0s!important;color-adjust:exact!important;transition:none!important}div#p>svg[data-marpit-svg]{display:block;height:100vh;width:100vw}}div#p>svg>foreignObject>section mjx-container[jax=SVG]{direction:ltr}div#p>svg>foreignObject>section mjx-container[jax=SVG]>svg{overflow:visible;min-height:1px;min-width:1px}div#p>svg>foreignObject>section mjx-container[jax=SVG]>svg a{fill:blue;stroke:blue}div#p>svg>foreignObject>section mjx-container[jax=SVG][display=true]{display:block;text-align:center;margin:1em 0}div#p>svg>foreignObject>section mjx-container[jax=SVG][display=true][width=full]{display:flex}div#p>svg>foreignObject>section mjx-container[jax=SVG][justify=left]{text-align:left}div#p>svg>foreignObject>section mjx-container[jax=SVG][justify=right]{text-align:right}div#p>svg>foreignObject>section g[data-mml-node=merror]>g{fill:red;stroke:red}div#p>svg>foreignObject>section g[data-mml-node=merror]>rect[data-background]{fill:yellow;stroke:none}div#p>svg>foreignObject>section g[data-mml-node=mtable]>line[data-line],div#p>svg>foreignObject>section svg[data-table]>g>line[data-line]{stroke-width:70px;fill:none}div#p>svg>foreignObject>section g[data-mml-node=mtable]>rect[data-frame],div#p>svg>foreignObject>section svg[data-table]>g>rect[data-frame]{stroke-width:70px;fill:none}div#p>svg>foreignObject>section g[data-mml-node=mtable]>.mjx-dashed,div#p>svg>foreignObject>section svg[data-table]>g>.mjx-dashed{stroke-dasharray:140}div#p>svg>foreignObject>section g[data-mml-node=mtable]>.mjx-dotted,div#p>svg>foreignObject>section svg[data-table]>g>.mjx-dotted{stroke-linecap:round;stroke-dasharray:0,140}div#p>svg>foreignObject>section g[data-mml-node=mtable]>g>svg{overflow:visible}div#p>svg>foreignObject>section [jax=SVG] mjx-tool{display:inline-block;position:relative;width:0;height:0}div#p>svg>foreignObject>section [jax=SVG] mjx-tool>mjx-tip{position:absolute;top:0;left:0}div#p>svg>foreignObject>section mjx-tool>mjx-tip{display:inline-block;padding:.2em;border:1px solid #888;font-size:70%;background-color:#F8F8F8;color:black;box-shadow:2px 2px 5px #AAAAAA}div#p>svg>foreignObject>section g[data-mml-node=maction][data-toggle]{cursor:pointer}div#p>svg>foreignObject>section mjx-status{display:block;position:fixed;left:1em;bottom:1em;min-width:25%;padding:.2em .4em;border:1px solid #888;font-size:90%;background-color:#F8F8F8;color:black}div#p>svg>foreignObject>section foreignObject[data-mjx-xml]{font-family:initial;line-height:normal;overflow:visible}div#p>svg>foreignObject>section mjx-container[jax=SVG] path[data-c],div#p>svg>foreignObject>section mjx-container[jax=SVG] use[data-c]{stroke-width:3}@media print{div#p>svg>foreignObject>section mjx-container[jax=SVG] path[data-c],div#p>svg>foreignObject>section mjx-container[jax=SVG] use[data-c]{stroke-width:0}}div#p>svg>foreignObject>section img[data-marp-twemoji]{background:transparent;height:1em;margin:0 .05em 0 .1em;vertical-align:-.1em;width:1em}
/*!
 * Marp / Marpit Gaia theme.
 *
 * @theme gaia
 * @author Yuki Hattori
 *
 * @auto-scaling true
 * @size 16:9 1280px 720px
 * @size 4:3 960px 720px
 */div#p>svg>foreignObject>section :is(pre,marp-pre) code.hljs{display:block;overflow-x:auto;padding:1em}div#p>svg>foreignObject>section code.hljs{padding:3px 5px}div#p>svg>foreignObject>section .hljs{background:#000;color:#f8f8f8}div#p>svg>foreignObject>section .hljs-comment,div#p>svg>foreignObject>section .hljs-quote{color:#aeaeae;font-style:italic}div#p>svg>foreignObject>section .hljs-keyword,div#p>svg>foreignObject>section .hljs-selector-tag,div#p>svg>foreignObject>section .hljs-type{color:#e28964}div#p>svg>foreignObject>section .hljs-string{color:#65b042}div#p>svg>foreignObject>section .hljs-subst{color:#daefa3}div#p>svg>foreignObject>section .hljs-link,div#p>svg>foreignObject>section .hljs-regexp{color:#e9c062}div#p>svg>foreignObject>section .hljs-name,div#p>svg>foreignObject>section .hljs-section,div#p>svg>foreignObject>section .hljs-tag,div#p>svg>foreignObject>section .hljs-title{color:#89bdff}div#p>svg>foreignObject>section .hljs-class .hljs-title,div#p>svg>foreignObject>section .hljs-doctag,div#p>svg>foreignObject>section .hljs-title.class_{text-decoration:underline}div#p>svg>foreignObject>section .hljs-bullet,div#p>svg>foreignObject>section .hljs-number,div#p>svg>foreignObject>section .hljs-symbol{color:#3387cc}div#p>svg>foreignObject>section .hljs-params,div#p>svg>foreignObject>section .hljs-template-variable,div#p>svg>foreignObject>section .hljs-variable{color:#3e87e3}div#p>svg>foreignObject>section .hljs-attribute{color:#cda869}div#p>svg>foreignObject>section .hljs-meta{color:#8996a8}div#p>svg>foreignObject>section .hljs-formula{background-color:#0e2231;color:#f8f8f8;font-style:italic}div#p>svg>foreignObject>section .hljs-addition{background-color:#253b22;color:#f8f8f8}div#p>svg>foreignObject>section .hljs-deletion{background-color:#420e09;color:#f8f8f8}div#p>svg>foreignObject>section .hljs-selector-class{color:#9b703f}div#p>svg>foreignObject>section .hljs-selector-id{color:#8b98ab}div#p>svg>foreignObject>section .hljs-emphasis{font-style:italic}div#p>svg>foreignObject>section .hljs-strong{font-weight:700}div#p>svg>foreignObject>section :is(h1,marp-h1),div#p>svg>foreignObject>section :is(h2,marp-h2),div#p>svg>foreignObject>section :is(h3,marp-h3),div#p>svg>foreignObject>section :is(h4,marp-h4),div#p>svg>foreignObject>section :is(h5,marp-h5),div#p>svg>foreignObject>section :is(h6,marp-h6){margin:.5em 0 0}div#p>svg>foreignObject>section :is(h1,marp-h1) strong,div#p>svg>foreignObject>section :is(h2,marp-h2) strong,div#p>svg>foreignObject>section :is(h3,marp-h3) strong,div#p>svg>foreignObject>section :is(h4,marp-h4) strong,div#p>svg>foreignObject>section :is(h5,marp-h5) strong,div#p>svg>foreignObject>section :is(h6,marp-h6) strong{font-weight:inherit}div#p>svg>foreignObject>section :is(h1,marp-h1)::part(auto-scaling),div#p>svg>foreignObject>section :is(h2,marp-h2)::part(auto-scaling),div#p>svg>foreignObject>section :is(h3,marp-h3)::part(auto-scaling),div#p>svg>foreignObject>section :is(h4,marp-h4)::part(auto-scaling),div#p>svg>foreignObject>section :is(h5,marp-h5)::part(auto-scaling),div#p>svg>foreignObject>section :is(h6,marp-h6)::part(auto-scaling){max-height:580px}div#p>svg>foreignObject>section :is(h1,marp-h1){font-size:1.8em}div#p>svg>foreignObject>section :is(h2,marp-h2){font-size:1.5em}div#p>svg>foreignObject>section :is(h3,marp-h3){font-size:1.3em}div#p>svg>foreignObject>section :is(h4,marp-h4){font-size:1.1em}div#p>svg>foreignObject>section :is(h5,marp-h5){font-size:1em}div#p>svg>foreignObject>section :is(h6,marp-h6){font-size:.9em}div#p>svg>foreignObject>section blockquote,div#p>svg>foreignObject>section p{margin:1em 0 0}div#p>svg>foreignObject>section ol>li,div#p>svg>foreignObject>section ul>li{margin:.3em 0 0}div#p>svg>foreignObject>section ol>li>p,div#p>svg>foreignObject>section ul>li>p{margin:.6em 0 0}div#p>svg>foreignObject>section code{display:inline-block;font-family:Roboto Mono,monospace;font-size:.8em;letter-spacing:0;margin:-.1em .15em;padding:.1em .2em;vertical-align:baseline}div#p>svg>foreignObject>section :is(pre,marp-pre){display:block;margin:1em 0 0;overflow:visible}div#p>svg>foreignObject>section :is(pre,marp-pre) code{box-sizing:border-box;font-size:.7em;margin:0;min-width:100%;padding:.5em}div#p>svg>foreignObject>section :is(pre,marp-pre)::part(auto-scaling){max-height:calc(580px - 1em)}div#p>svg>foreignObject>section blockquote{margin:1em 0 0;padding:0 1em;position:relative}div#p>svg>foreignObject>section blockquote:after,div#p>svg>foreignObject>section blockquote:before{content:"“";display:block;font-family:Times New Roman,serif;font-weight:700;position:absolute}div#p>svg>foreignObject>section blockquote:before{left:0;top:0}div#p>svg>foreignObject>section blockquote:after{bottom:0;right:0;transform:rotate(180deg)}div#p>svg>foreignObject>section blockquote>:first-child{margin-top:0}div#p>svg>foreignObject>section mark{background:transparent}div#p>svg>foreignObject>section table{border-collapse:collapse;border-spacing:0;margin:1em 0 0}div#p>svg>foreignObject>section table td,div#p>svg>foreignObject>section table th{border-style:solid;border-width:1px;padding:.2em .4em}div#p>svg>foreignObject>section footer,div#p>svg>foreignObject>section header,div#p>svg>foreignObject>section:after{box-sizing:border-box;font-size:66%;height:70px;line-height:50px;overflow:hidden;padding:10px 25px;position:absolute}div#p>svg>foreignObject>section:after{--marpit-root-font-size:66%}div#p>svg>foreignObject>section header{top:0}div#p>svg>foreignObject>section footer,div#p>svg>foreignObject>section header{left:0;right:0}div#p>svg>foreignObject>section footer{bottom:0}div#p>svg>foreignObject>section{word-wrap:break-word;--color-background:#fff8e1;--color-background-stripe:rgba(69,90,100,.1);--color-foreground:#455a64;--color-dimmed:#6a7a7d;--color-highlight:#0288d1;background-color:var(--color-background);background-image:linear-gradient(135deg,hsla(0,0%,53%,0),hsla(0,0%,53%,.02) 50%,hsla(0,0%,100%,0) 0,hsla(0,0%,100%,.05));color:var(--color-foreground);font-family:Lato,Avenir Next,Avenir,Trebuchet MS,Segoe UI,sans-serif;font-size:35px;height:720px;letter-spacing:1.25px;line-height:1.35;padding:70px;width:1280px}div#p>svg>foreignObject>section{--marpit-root-font-size:35px}div#p>svg>foreignObject>section:after{bottom:0;font-size:80%;right:0}div#p>svg>foreignObject>section:after{--marpit-root-font-size:80%}div#p>svg>foreignObject>section a,div#p>svg>foreignObject>section mark{color:var(--color-highlight)}div#p>svg>foreignObject>section code{background:var(--color-dimmed);color:var(--color-background)}div#p>svg>foreignObject>section :is(h1,marp-h1) strong,div#p>svg>foreignObject>section :is(h2,marp-h2) strong,div#p>svg>foreignObject>section :is(h3,marp-h3) strong,div#p>svg>foreignObject>section :is(h4,marp-h4) strong,div#p>svg>foreignObject>section :is(h5,marp-h5) strong,div#p>svg>foreignObject>section :is(h6,marp-h6) strong{color:var(--color-highlight)}div#p>svg>foreignObject>section :is(pre,marp-pre){background:var(--color-foreground)}div#p>svg>foreignObject>section :is(pre,marp-pre)>code{background:transparent}div#p>svg>foreignObject>section blockquote:after,div#p>svg>foreignObject>section blockquote:before,div#p>svg>foreignObject>section footer,div#p>svg>foreignObject>section header,div#p>svg>foreignObject>section section:after{color:var(--color-dimmed)}div#p>svg>foreignObject>section table td,div#p>svg>foreignObject>section table th{border-color:var(--color-foreground)}div#p>svg>foreignObject>section table thead th{background:var(--color-foreground);color:var(--color-background)}div#p>svg>foreignObject>section table tbody>tr:nth-child(odd) td,div#p>svg>foreignObject>section table tbody>tr:nth-child(odd) th{background:var(--color-background-stripe,transparent)}div#p>svg>foreignObject>section>:first-child,div#p>svg>foreignObject>section>header:first-child+*{margin-top:0}div#p>svg>foreignObject>section:where(.invert){--color-background:#455a64;--color-background-stripe:rgba(255,248,225,.1);--color-foreground:#fff8e1;--color-dimmed:#dad8c8;--color-highlight:#81d4fa}div#p>svg>foreignObject>section:where(.gaia){--color-background:#0288d1;--color-background-stripe:rgba(255,248,225,.1);--color-foreground:#fff8e1;--color-dimmed:#cce2de;--color-highlight:#81d4fa}div#p>svg>foreignObject>section:where(.lead){display:flex;flex-flow:column nowrap;justify-content:center}div#p>svg>foreignObject>section:where(.lead) :is(h1,marp-h1),div#p>svg>foreignObject>section:where(.lead) :is(h2,marp-h2),div#p>svg>foreignObject>section:where(.lead) :is(h3,marp-h3),div#p>svg>foreignObject>section:where(.lead) :is(h4,marp-h4),div#p>svg>foreignObject>section:where(.lead) :is(h5,marp-h5),div#p>svg>foreignObject>section:where(.lead) :is(h6,marp-h6){text-align:center}div#p>svg>foreignObject>section:where(.lead) p{text-align:center}div#p>svg>foreignObject>section:where(.lead) blockquote>:is(h1,marp-h1),div#p>svg>foreignObject>section:where(.lead) blockquote>:is(h2,marp-h2),div#p>svg>foreignObject>section:where(.lead) blockquote>:is(h3,marp-h3),div#p>svg>foreignObject>section:where(.lead) blockquote>:is(h4,marp-h4),div#p>svg>foreignObject>section:where(.lead) blockquote>:is(h5,marp-h5),div#p>svg>foreignObject>section:where(.lead) blockquote>:is(h6,marp-h6),div#p>svg>foreignObject>section:where(.lead) blockquote>p{text-align:left}div#p>svg>foreignObject>section:where(.lead) ol>li>p,div#p>svg>foreignObject>section:where(.lead) ul>li>p{text-align:left}div#p>svg>foreignObject>section:where(.lead) table{margin-left:auto;margin-right:auto}div#p>svg>foreignObject>section .columns{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:calc(var(--marpit-root-font-size, 1rem) * 1)}div#p>svg>foreignObject>section{padding:30px 50px 30px}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]{columns:initial!important;display:block!important;padding:0!important}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]:after,div#p>svg>foreignObject>section[data-marpit-advanced-background=background]:before,div#p>svg>foreignObject>section[data-marpit-advanced-background=content]:after,div#p>svg>foreignObject>section[data-marpit-advanced-background=content]:before{display:none!important}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]>div[data-marpit-advanced-background-container]{all:initial;display:flex;flex-direction:row;height:100%;overflow:hidden;width:100%}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]>div[data-marpit-advanced-background-container][data-marpit-advanced-background-direction=vertical]{flex-direction:column}div#p>svg>foreignObject>section[data-marpit-advanced-background=background][data-marpit-advanced-background-split]>div[data-marpit-advanced-background-container]{width:var(--marpit-advanced-background-split,50%)}div#p>svg>foreignObject>section[data-marpit-advanced-background=background][data-marpit-advanced-background-split=right]>div[data-marpit-advanced-background-container]{margin-left:calc(100% - var(--marpit-advanced-background-split, 50%))}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]>div[data-marpit-advanced-background-container]>figure{all:initial;background-position:center;background-repeat:no-repeat;background-size:cover;flex:auto;margin:0}div#p>svg>foreignObject>section[data-marpit-advanced-background=content],div#p>svg>foreignObject>section[data-marpit-advanced-background=pseudo]{background:transparent!important}div#p>svg>foreignObject>section[data-marpit-advanced-background=pseudo],div#p>svg[data-marpit-svg]>foreignObject[data-marpit-advanced-background=pseudo]{pointer-events:none!important}div#p>svg>foreignObject>section[data-marpit-advanced-background-split]{width:100%;height:100%}</style></head><body><div class="bespoke-marp-osc"><button data-bespoke-marp-osc="prev" tabindex="-1" title="Previous slide">Previous slide</button><span data-bespoke-marp-osc="page"></span><button data-bespoke-marp-osc="next" tabindex="-1" title="Next slide">Next slide</button><button data-bespoke-marp-osc="fullscreen" tabindex="-1" title="Toggle fullscreen (f)">Toggle fullscreen</button><button data-bespoke-marp-osc="presenter" tabindex="-1" title="Open presenter view (p)">Open presenter view</button></div><div id="p"><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-paginate="true" data-background-image="url('img/bg.jpg')" data-class="lead" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" class="lead" data-marpit-pagination="1" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--class:lead;--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;--marpit-advanced-background-split:33%;" data-marpit-advanced-background="background" data-marpit-advanced-background-split="left"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;img/java_icon.png&quot;);background-size:6cm auto;"></figure></div></section></foreignObject><foreignObject width="67%" height="720" x="33%"><section id="1" data-paginate="true" data-background-image="url('img/bg.jpg')" data-class="lead" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" class="lead" data-marpit-pagination="1" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--class:lead;--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;--marpit-advanced-background-split:33%;" data-marpit-advanced-background="content" data-marpit-advanced-background-split="left">
<h1><strong>Tour of Java</strong></h1>
<p><em>科协智能体部 计06 徐晨曦</em></p>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section data-paginate="true" data-background-image="url('img/bg.jpg')" data-class="lead" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" class="lead" data-marpit-pagination="1" data-marpit-pagination-total="290" style="" data-marpit-advanced-background="pseudo" data-marpit-advanced-background-split="left"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="2" data-paginate="true" data-background-image="url('img/bg.jpg')" data-class="lead" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" class="lead" data-marpit-pagination="2" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--class:lead;--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>PREFACE</em></h1>
<h1>Introduction to Java Platform</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="3" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="3" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>What is Java</h1>
<ul>
<li>Java是一门<em>高层次</em>，<em>强类型</em>，<em>编译型</em>，<em>基于类的面向对象</em>的<em>通用</em>编程语言</li>
<li>Java保证<em>一次编写，到处运行 (write once, run anywhere)</em>，即Java编译出的字节码文件可以保证在任何系统上的Java运行时环境运行</li>
<li>Java保证向前兼容性</li>
<li>Java是一门<em>类C语言</em></li>
<li>从1995年开始，历史悠久的Java平台积累了兼具广度和可靠性的生态系统和开发者社区</li>
<li>Java至今仍然是最流行、最知名、使用最广的编程语言之一</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="4" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="4" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>History of Java</h1>
<ul>
<li>1991, <em>James Gosling</em>, C++ and Oak</li>
<li>1995, <em>Sun Microsystems</em> and Java 1.0</li>
<li>1996, Dynamic Web &amp; Java Applets</li>
<li>2006, Java EE, Java SE, Java ME</li>
<li>2007, Java visual machine is opened under GPL</li>
<li>2009, Sunset of the <em>Sun</em></li>
<li>2014, Java 8 reached General Availability</li>
<li>2018, Java 10 started to adopt Time-Based Release Versioning</li>
<li>Today, Java 17 is current LTS, Java 18 GA, Java 19 RDP 2</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="5" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="5" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Why Java</h1>
<ul>
<li>Easy!</li>
<li>Cross-Platform</li>
<li>Rich and Reliable Ecosystem</li>
<li>Forward evolution with backwards compatibility</li>
<li>Performance</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="6" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="6" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Why NOT Java</h1>
<ul>
<li>Performance ?</li>
<li>相对贫弱的语法特性削弱了对程序员的吸引力</li>
<li>JavaScript, Python等语言的流行和其生态系统的逐步完善</li>
<li>Go, Rust等新星语言的涌现</li>
<li>Kotlin, Scala, Clojure, Groovy等JVM平台语言提供了利用Java生态系统的其他选项
<ul>
<li>Kotlin获得了Google的青睐和Android平台的优先支持</li>
<li>Scala极为灵活的语法和强大的表达能力长期以来收到科学计算领域和分布式数据处理领域的欢迎</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="7" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="7" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Before we start,</h1>
<h1>Let's recognize some terms of Java</h1>
<ul>
<li>JDK, Java Develop Kit, Java开发工具包</li>
<li>JRE, Java Runtime Environment, Java运行时环境</li>
<li>JVM, Java Virtual Machine, Java虚拟机</li>
<li>OpenJDK, 开源Java平台实现的合作组织</li>
<li>LTS，Long Term Support, 长期支持版本</li>
<li>IDE, Integrated Development Environment, 集成开发环境</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="8" data-paginate="true" data-background-image="url('img/bg.jpg')" data-class="lead" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" class="lead" data-marpit-pagination="8" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--class:lead;--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>Chapter 0</em></h1>
<h1>Installation of JDK &amp; IntelliJ IDEA</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="9" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="9" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Eclipse Adoptium</h1>
<ul>
<li><strong>TLDR</strong>: <a href="https://adoptium.net/">Eclipse Adoptium</a>是一个提供一大堆平台和一大堆不同版本的JDK的网站</li>
<li><strong>太长不看版</strong>
<ul>
<li>OpenJDK顾名思义，是开源的，因此很多公司和组织都提供了自己的构建版本</li>
<li>2017年启动的AdoptOpenJDK项目是第一个提供一大堆平台和一大堆不同版本的JDK的网站，同时也提供了多种平台的构建和测试平台</li>
<li>Eclipse Adoptium是AdoptOpenJDK的继任者</li>
<li>它们提供的OpenJDK分发版称为Eclipse Temurin</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="10" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="10" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Java Version</h1>
<ul>
<li><strong>TLDR</strong>：作为最新的<em>长期支持版本LTS</em>，<strong>Java 17</strong>将成为本次课程的目标平台。Java平台保证前向兼容，因此更新版本的Java支持本课程讲得绝大多数内容。</li>
<li><strong>太长不看版</strong>
<ul>
<li>Java的语法特性和版本绑定，大版本的后续更新大多都是bug修复和性能增强。但是Java7-9的发布时间分别是2011-2014-2017，以多年为跨度的更新使Java语法特性的进化严重落后于时代。</li>
<li>因此，从 <em>[<a href="https://openjdk.org/jeps/322">JEP 322</a>, Java10]</em> 开始，采用新的根据固定时间的新版本发布计划和命名方案。Java将会<em>每六个月</em>固定发布新版本，用于快速滚动开发、预览、发布新语法特性和修改。</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="11" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="11" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Install JDK <em>(Eclipse Temurin)</em></h1>
<ul>
<li>所有系统通用：进网站，点下载，双击安装包</li>
<li>macOS &amp; Homebrew<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-bash">$ brew install --cask temurin      // Install latest JDK18
$ brew tap homebrew/cask-versions
$ brew install --cask temurin17
</code></pre>
</li>
<li>Linux<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-bash">$ apt install temurin-17-jdk     // Debian/Ubuntu
$ yum install temurin-17-jdk     // CentOS/RHEL/Fedora
$ zypper install temurin-17-jdk  // openSUSE
</code></pre>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="12" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="12" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Install JDK <em>(Eclipse Temurin)</em></h1>
<ul>
<li>如果Temurin网站或者Linux源下载速度较慢，可以使用<a href="https://mirrors.tuna.tsinghua.edu.cn/help/adoptium/">TUNA镜像</a></li>
<li>Homebrew如果下载速度慢，需要为其设置代理</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="13" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="13" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Other OpenJDK Distribution ?</h1>
<ul>
<li><a href="https://www.azul.com/downloads/">Azul Zulu</a></li>
<li><a href="https://bell-sw.com/pages/downloads/?">BellSoft Liberica JDK</a>
<ul>
<li>上面两个在业界均有一定应用率，可以信赖</li>
<li>均提供JDK8在ARM Mac的构建版本</li>
<li>均提供JavaFX的支持</li>
</ul>
</li>
<li><a href="https://www.graalvm.org/">GraalVM</a>
<ul>
<li>Oracle开发的下一代JDK和全新的多语言虚拟机</li>
<li>将Java编译为本地代码以消除大部分根本上的性能问题</li>
<li>提供高性能的Python, R, Ruby等语言的运行时</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="14" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="14" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>First Command</h1>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-bash">$ java --version
openjdk 17.0.3 2022-04-19
OpenJDK Runtime Environment Temurin-17.0.3+7 (build 17.0.3+7)
OpenJDK 64-Bit Server VM Temurin-17.0.3+7 (build 17.0.3+7, mixed mode)
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="15" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="15" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>CodeLab 0-1</em>: helloworld</h1>
<p>**第<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="0.781ex" height="1.52ex" role="img" focusable="false" viewBox="0 -661 345 672"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></svg></mjx-container>章的CodeLab代码位于<code>codelab/chapter&lt;i&gt;/src</code></p>
<p><code>Helloworld.java</code></p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Helloworld</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        System.out.println(<span class="hljs-string">&quot;helloworld&quot;</span>);
    }
}
</code></pre>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-bash">codelab/chapter0/src $ javac Helloworld.java
codelab/chapter0/src $ java Helloworld
helloworld
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="16" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="16" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>CodeLab 0-1</em> helloworld</h1>
<p><em>[JEP330, Java11]</em> Launch Single-File Source-Code Programs</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-bash">codelab/chapter0/src $ java Helloworld.java
helloworld
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="17" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="17" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>CodeLab 0-1</em>: helloworld</h1>
<ol>
<li><code>public class Helloworld</code>：定义一个公开类<code>Helloworld</code>。Java规定一个<code>java</code>源文件应当有且只有一个公开类，且类名应该和文件名相同</li>
<li><code>public static void main(String[] args)</code>：Java的<code>main</code>函数写法，<code>String[] args</code>是命令行参数数组</li>
<li><code>System.out.println(&quot;helloworld&quot;);</code>：<code>System.out</code>是标准输出流，<code>println</code>是输出函数</li>
</ol>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="18" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="18" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>CodeLab 0-1</em> helloworld</h1>
<p><em>[JEP222, Java9]</em> <code>jshell</code>: The Java Shell (Read-Eval-Print Loop)</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-bash">$ jshell
jshell
|  欢迎使用 JShell -- 版本 17.0.3
|  要大致了解该版本, 请键入: /help intro

jshell&gt; System.out.println(<span class="hljs-string">&quot;helloworld&quot;</span>)
helloworld

</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="19" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="19" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>JetBrains IntelliJ IDEA</h1>
<ul>
<li><a href="https://www.jetbrains.com/idea/">https://www.jetbrains.com/idea/</a></li>
<li>目前最强大、使用最广泛的Java IDE</li>
<li>IntelliJ IDEA Community Edition是免费开源版本，其包含了基础的Java语言支持、分析、构建与版本管理和Docker支持</li>
<li>IntelliJ IDEA Ultimate是收费版本，支持性能剖析，企业级框架支持，Web技术支持，数据库工具，远程协作开发支持
<ul>
<li>使用<code>@mails.thu.edu.cn</code>可以申请JetBrains学生包以获取全部开发工具</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="20" data-paginate="true" data-background-image="url('img/bg.jpg')" data-class="lead" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" class="lead" data-marpit-pagination="20" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--class:lead;--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>Chapter 1</em></h1>
<h1>Basic language structure</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="21" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="21" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Java is a <em>C-style</em> language</h1>
<h2>Comments</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-comment">// This is a one-line comment</span>

<span class="hljs-comment">/*
 * This is a multi-line comment
 */</span>

<span class="hljs-comment">/**
 * This is JavaDoc
 */</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="22" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="22" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Java is a <em>C-style</em> language</h1>
<h2>Variable Declare &amp; Assignment / Data types</h2>
&lt;div class="columns"&gt;
&lt;div&gt;
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-type">int</span> a;
a ==&gt; <span class="hljs-number">0</span>
jshell&gt; a = <span class="hljs-number">1</span>;
a ==&gt; <span class="hljs-number">1</span>
jshell&gt; <span class="hljs-type">long</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-number">1L</span>
b ==&gt; <span class="hljs-number">1</span>
jshell&gt; <span class="hljs-type">char</span> <span class="hljs-variable">e</span> <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;E&#x27;</span>
e ==&gt; <span class="hljs-string">&#x27;E&#x27;</span>
jshell&gt; <span class="hljs-type">String</span> <span class="hljs-variable">f</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;java&quot;</span>
f ==&gt; <span class="hljs-string">&quot;java&quot;</span>
jshell&gt; <span class="hljs-type">boolean</span> <span class="hljs-variable">g</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>
g ==&gt; <span class="hljs-literal">true</span>
</code></pre>
&lt;/div&gt;
&lt;div&gt;
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-type">float</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> <span class="hljs-number">1.0</span>
|  错误:
|  不兼容的类型: 从<span class="hljs-type">double</span>转换到<span class="hljs-type">float</span>可能会有损失
|  <span class="hljs-type">float</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> <span class="hljs-number">1.0</span>;
|            ^-^
jshell&gt; <span class="hljs-type">float</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> <span class="hljs-number">1.0f</span>
c ==&gt; <span class="hljs-number">1.0</span>
jshell&gt; c = (<span class="hljs-type">float</span>) <span class="hljs-number">2.0</span>
c ==&gt; <span class="hljs-number">2.0</span>
jshell&gt; <span class="hljs-type">double</span> <span class="hljs-variable">d</span> <span class="hljs-operator">=</span> <span class="hljs-number">1.0</span>
d ==&gt; <span class="hljs-number">1.0</span>
</code></pre>
&lt;/div&gt;
&lt;/div&gt;
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="23" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="23" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Java is a <em>C-style</em> language</h1>
<h2>Variable Declare &amp; Assignment / Data types</h2>
<ul>
<li>整数类型：<code>byte</code> <code>short</code> <code>int</code> <code>long</code>分别为1、2、4、8字节<em>有符号</em>整数</li>
<li>浮点数：<code>float</code> <code>double</code>分别为4、8字节浮点数</li>
<li>逻辑值：<code>boolean</code></li>
<li>字符：<code>char</code> 2字节Unicode字符</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="24" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="24" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Java is a <em>C-style</em> language</h1>
<h2>Operators: Arithmetic</h2>
&lt;div class="columns"&gt;
&lt;div&gt;
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-number">1</span> + <span class="hljs-number">1</span>
$<span class="hljs-number">2</span> ==&gt; <span class="hljs-number">2</span>
jshell&gt; <span class="hljs-number">2</span> * <span class="hljs-number">2</span>
$<span class="hljs-number">3</span> ==&gt; <span class="hljs-number">4</span>
jshell&gt; <span class="hljs-number">3</span> / <span class="hljs-number">2</span>
$<span class="hljs-number">4</span> ==&gt; <span class="hljs-number">1</span>
jshell&gt; <span class="hljs-number">3.0</span> / <span class="hljs-number">2</span>
$<span class="hljs-number">5</span> ==&gt; <span class="hljs-number">1.5</span>
jshell&gt; <span class="hljs-number">3</span> % <span class="hljs-number">2</span>
$<span class="hljs-number">6</span> ==&gt; <span class="hljs-number">1</span>
jshell&gt; -<span class="hljs-number">3</span> % <span class="hljs-number">2</span>
$<span class="hljs-number">6</span> ==&gt; -<span class="hljs-number">1</span>
</code></pre>
&lt;/div&gt;
&lt;div&gt;
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
a ==&gt; <span class="hljs-number">1</span>
jshell&gt; a += <span class="hljs-number">100</span>;
$<span class="hljs-number">17</span> ==&gt; <span class="hljs-number">101</span>
jshell&gt; a *= <span class="hljs-number">20</span>;
$<span class="hljs-number">18</span> ==&gt; <span class="hljs-number">2020</span>
jshell&gt; a /= <span class="hljs-number">3</span>;
$<span class="hljs-number">19</span> ==&gt; <span class="hljs-number">673</span>
jshell&gt; a %= <span class="hljs-number">20</span>;
$<span class="hljs-number">20</span> ==&gt; <span class="hljs-number">13</span>
</code></pre>
&lt;/div&gt;
&lt;/div&gt;
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="25" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="25" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Java is a <em>C-style</em> language</h1>
<h2>Operators: <code>++</code> <code>--</code></h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
a ==&gt; <span class="hljs-number">1</span>

jshell&gt; ++a
$<span class="hljs-number">29</span> ==&gt; <span class="hljs-number">2</span>
jshell&gt; --a
$<span class="hljs-number">30</span> ==&gt; <span class="hljs-number">1</span>

jshell&gt; a++
$<span class="hljs-number">31</span> ==&gt; <span class="hljs-number">1</span>
jshell&gt; a--
$<span class="hljs-number">32</span> ==&gt; <span class="hljs-number">2</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="26" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="26" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Java is a <em>C-style</em> language</h1>
<h2>Operators: Bitwise</h2>
&lt;div class="columns"&gt;
&lt;div&gt;
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-number">1</span> &amp; <span class="hljs-number">2</span>
$<span class="hljs-number">11</span> ==&gt; <span class="hljs-number">0</span>

jshell&gt; <span class="hljs-number">1</span> | <span class="hljs-number">2</span>
$<span class="hljs-number">12</span> ==&gt; <span class="hljs-number">3</span>

jshell&gt; <span class="hljs-number">1</span> ^ <span class="hljs-number">2</span>
$<span class="hljs-number">13</span> ==&gt; <span class="hljs-number">3</span>

jshell&gt; ~<span class="hljs-number">1</span>
$<span class="hljs-number">14</span> ==&gt; -<span class="hljs-number">2</span>
</code></pre>
&lt;/div&gt;
&lt;div&gt;
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">20</span>;
$<span class="hljs-number">21</span> ==&gt; <span class="hljs-number">1048576</span>

jshell&gt; -<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">20</span>;
$<span class="hljs-number">22</span> ==&gt; -<span class="hljs-number">1048576</span>

jshell&gt; <span class="hljs-number">1024</span> &gt;&gt; <span class="hljs-number">3</span>;
$<span class="hljs-number">23</span> ==&gt; <span class="hljs-number">128</span>

jshell&gt; -<span class="hljs-number">1024</span> &gt;&gt; <span class="hljs-number">3</span>;
$<span class="hljs-number">24</span> ==&gt; -<span class="hljs-number">128</span>

jshell&gt; -<span class="hljs-number">1024</span> &gt;&gt;&gt; <span class="hljs-number">3</span>;
$<span class="hljs-number">25</span> ==&gt; <span class="hljs-number">536870784</span>
</code></pre>
&lt;/div&gt;
&lt;/div&gt;
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="27" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="27" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Java is a <em>C-style</em> language</h1>
<h2>Operators: Compare</h2>
&lt;div class="columns"&gt;
&lt;div&gt;
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>, b = <span class="hljs-number">2</span>;
a ==&gt; <span class="hljs-number">1</span>
b ==&gt; <span class="hljs-number">2</span>

jshell&gt; a &lt; b
$<span class="hljs-number">3</span> ==&gt; <span class="hljs-literal">true</span>

jshell&gt; a &lt;= b
$<span class="hljs-number">4</span> ==&gt; <span class="hljs-literal">true</span>

jshell&gt; a == b
$<span class="hljs-number">5</span> ==&gt; <span class="hljs-literal">false</span>
</code></pre>
&lt;/div&gt;
&lt;div&gt;
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; a != b
$<span class="hljs-number">8</span> ==&gt; <span class="hljs-literal">true</span>

jshell&gt; a &gt;= b
$<span class="hljs-number">6</span> ==&gt; <span class="hljs-literal">false</span>

jshell&gt; a &gt; b
$<span class="hljs-number">7</span> ==&gt; <span class="hljs-literal">false</span>
</code></pre>
&lt;/div&gt;
&lt;/div&gt;
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="28" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="28" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Java is a <em>C-style</em> language</h1>
<h2>Operators: Logic</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-literal">true</span> &amp;&amp; <span class="hljs-literal">false</span>
$<span class="hljs-number">15</span> ==&gt; <span class="hljs-literal">false</span>

jshell&gt; <span class="hljs-literal">true</span> || <span class="hljs-literal">false</span>
$<span class="hljs-number">16</span> ==&gt; <span class="hljs-literal">true</span>

jshell&gt; !<span class="hljs-literal">true</span>
$<span class="hljs-number">17</span> ==&gt; <span class="hljs-literal">false</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="29" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="29" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Java is a <em>C-style</em> language</h1>
<h2>Operators: String</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-string">&quot;hello&quot;</span> + <span class="hljs-string">&quot;world&quot;</span>
$<span class="hljs-number">10</span> ==&gt; <span class="hljs-string">&quot;helloworld&quot;</span>

jshell&gt; <span class="hljs-string">&quot;1 + 1 = &quot;</span> + (<span class="hljs-number">1</span> + <span class="hljs-number">1</span>)
$<span class="hljs-number">11</span> ==&gt; <span class="hljs-string">&quot;1 + 1 = 2&quot;</span>

jshell&gt; System.out.println(<span class="hljs-string">&quot;hello\nworld&quot;</span>)
hello
world

jshell&gt; System.out.println(<span class="hljs-string">&quot;Col1\tCol2\n1\t2\n11111\t22222&quot;</span>)
Col1	Col2
<span class="hljs-number">1</span>	<span class="hljs-number">2</span>
<span class="hljs-number">11111</span>	<span class="hljs-number">22222</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="30" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="30" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Java is a <em>C-style</em> language</h1>
<h2>Function / Method Syntax</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-type">int</span> <span class="hljs-title function_">mul</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> {
   ...&gt;     <span class="hljs-keyword">return</span> a * b;
   ...&gt; }
|  已创建 方法 mul(<span class="hljs-type">int</span>,<span class="hljs-type">int</span>)

jshell&gt; mul(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)
$<span class="hljs-number">20</span> ==&gt; <span class="hljs-number">6</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="31" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="31" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Java is a <em>C-style</em> language</h1>
<h2>Control Flow: <code>if-else</code></h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-type">boolean</span> <span class="hljs-title function_">canIGetA</span><span class="hljs-params">(<span class="hljs-type">double</span> score)</span> {
   ...&gt;     <span class="hljs-keyword">if</span> (score &gt;= <span class="hljs-number">90</span>) {
   ...&gt;         System.out.println(<span class="hljs-string">&quot;Good Job! You got a 4.0!&quot;</span>);
   ...&gt;         <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
   ...&gt;     } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (score &gt;= <span class="hljs-number">70</span>) {
   ...&gt;         System.out.println(<span class="hljs-string">&quot;Keep Going! You can do better!&quot;</span>);
   ...&gt;         <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
   ...&gt;     } <span class="hljs-keyword">else</span> {
   ...&gt;         System.out.println(<span class="hljs-string">&quot;Emm... What happends?&quot;</span>);
   ...&gt;         <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
   ...&gt;     }
   ...&gt; }
|  已创建 方法 canIGetA(<span class="hljs-type">double</span>)
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="32" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="32" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Java is a <em>C-style</em> language</h1>
<h2>Control Flow: <code>if-else</code></h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; canIGetA(<span class="hljs-number">100</span>)
Good Job! You got a <span class="hljs-number">4.0</span>!
$<span class="hljs-number">2</span> ==&gt; <span class="hljs-literal">true</span>

jshell&gt; canIGetA(<span class="hljs-number">80</span>)
Keep Going! You can <span class="hljs-keyword">do</span> better!
$<span class="hljs-number">3</span> ==&gt; <span class="hljs-literal">false</span>

jshell&gt; canIGetA(<span class="hljs-number">0</span>)
Emm... What happends?
$<span class="hljs-number">4</span> ==&gt; <span class="hljs-literal">false</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="33" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="33" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Java is a <em>C-style</em> language</h1>
<h2>Control Flow: <code>?:</code></h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-type">int</span> <span class="hljs-title function_">gcd</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> {
   ...&gt;     <span class="hljs-keyword">return</span> b == <span class="hljs-number">0</span> ? a : gcd(b, a % b);
   ...&gt; }
|  已创建 方法 gcd(<span class="hljs-type">int</span>,<span class="hljs-type">int</span>)

jshell&gt; gcd(<span class="hljs-number">48</span>, <span class="hljs-number">18</span>)
$<span class="hljs-number">26</span> ==&gt; <span class="hljs-number">6</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="34" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="34" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Java is a <em>C-style</em> language</h1>
<h2>Control Flow: <code>switch</code></h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-type">int</span> <span class="hljs-title function_">calculate</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b, <span class="hljs-type">char</span> op)</span> {
   ...&gt;     <span class="hljs-type">int</span> res;
   ...&gt;     <span class="hljs-keyword">switch</span>(op) {
   ...&gt;         <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;+&#x27;</span>: res = a + b; <span class="hljs-keyword">break</span>;
   ...&gt;         <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;-&#x27;</span>: res = a - b; <span class="hljs-keyword">break</span>;
   ...&gt;         <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;*&#x27;</span>: res = a * b; <span class="hljs-keyword">break</span>;
   ...&gt;         <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;/&#x27;</span>: res = a / b; <span class="hljs-keyword">break</span>;
   ...&gt;         <span class="hljs-keyword">default</span>: res = -<span class="hljs-number">1</span>;
   ...&gt;     }
   ...&gt;     <span class="hljs-keyword">return</span> res;
   ...&gt; }
|  已创建 方法 calculate(<span class="hljs-type">int</span>,<span class="hljs-type">int</span>,<span class="hljs-type">char</span>)
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="35" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="35" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Java is a <em>C-style</em> language</h1>
<h2>Control Flow: <code>switch</code></h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; calculate(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-string">&#x27;+&#x27;</span>)
$<span class="hljs-number">6</span> ==&gt; <span class="hljs-number">5</span>
jshell&gt; calculate(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-string">&#x27;-&#x27;</span>)
$<span class="hljs-number">7</span> ==&gt; -<span class="hljs-number">1</span>
jshell&gt; calculate(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-string">&#x27;*&#x27;</span>)
$<span class="hljs-number">8</span> ==&gt; <span class="hljs-number">6</span>
jshell&gt; calculate(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-string">&#x27;/&#x27;</span>)
$<span class="hljs-number">9</span> ==&gt; <span class="hljs-number">0</span>
jshell&gt; calculate(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-string">&#x27;^&#x27;</span>)
$<span class="hljs-number">10</span> ==&gt; -<span class="hljs-number">1</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="36" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="36" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Java is a <em>C-style</em> language</h1>
<h2>Control Flow: <code>for</code></h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-type">boolean</span> <span class="hljs-title function_">isPrime</span><span class="hljs-params">(<span class="hljs-type">int</span> a)</span> {
   ...&gt;     <span class="hljs-keyword">if</span> (a &lt;= <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
   ...&gt;     <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>; i * i &lt;= a; i++) {
   ...&gt;         <span class="hljs-keyword">if</span>(a % i == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
   ...&gt;     }
   ...&gt;     <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
   ...&gt; }
|  已创建 方法 isPrime(<span class="hljs-type">int</span>)

jshell&gt; <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; a &lt;= <span class="hljs-number">100</span>; a++) {
   ...&gt;     <span class="hljs-keyword">if</span> (isPrime(a)) System.out.print(a + <span class="hljs-string">&quot; &quot;</span>);
   ...&gt; }
<span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> <span class="hljs-number">11</span> <span class="hljs-number">13</span> <span class="hljs-number">17</span> <span class="hljs-number">19</span> <span class="hljs-number">23</span> <span class="hljs-number">29</span> <span class="hljs-number">31</span> <span class="hljs-number">37</span> <span class="hljs-number">41</span> <span class="hljs-number">43</span> <span class="hljs-number">47</span> <span class="hljs-number">53</span> <span class="hljs-number">59</span> <span class="hljs-number">61</span> <span class="hljs-number">67</span> <span class="hljs-number">71</span> <span class="hljs-number">73</span> <span class="hljs-number">79</span> <span class="hljs-number">83</span> <span class="hljs-number">89</span> <span class="hljs-number">97</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="37" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="37" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Java is a <em>C-style</em> language</h1>
<h2>Control Flow: <code>while</code></h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-keyword">import</span> java.lang.Math;

jshell&gt; <span class="hljs-type">double</span> x;
x ==&gt; <span class="hljs-number">0.0</span>

jshell&gt; <span class="hljs-keyword">while</span>( (x = Math.random()) &lt; <span class="hljs-number">0.8</span>) {
   ...&gt;     System.out.println(x + <span class="hljs-string">&quot; &lt; 0.8&quot;</span>);
   ...&gt; }
<span class="hljs-number">0.17636000596270907</span> &lt; <span class="hljs-number">0.8</span>
<span class="hljs-number">0.5029857602823097</span> &lt; <span class="hljs-number">0.8</span>
<span class="hljs-number">0.3349284868587292</span> &lt; <span class="hljs-number">0.8</span>
<span class="hljs-number">0.3650514335114553</span> &lt; <span class="hljs-number">0.8</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="38" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="38" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Java is a <em>C-style</em> language</h1>
<h2>Control Flow: <code>do-while</code></h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-keyword">do</span> {
   ...&gt;     x = Math.random();
   ...&gt; } <span class="hljs-keyword">while</span>(x &lt; <span class="hljs-number">0.8</span>);

jshell&gt; x <span class="hljs-comment">// is a random double &gt;= 0.8</span>
x ==&gt; <span class="hljs-number">0.8346328176085303</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="39" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="39" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Other basic syntax &amp; API</h1>
<h2><em>[<a href="https://openjdk.org/jeps/286">JEP286</a>, Java10]</em> <code>var</code> type inference</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-type">var</span> <span class="hljs-variable">mapOfMap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;String, Map&lt;String, String&gt;&gt;()
mapOfMap ==&gt; {}

jshell&gt; mapOfMap.put(<span class="hljs-string">&quot;Java&quot;</span>, Map.of(<span class="hljs-string">&quot;Type&quot;</span>, <span class="hljs-string">&quot;Strong-Typed&quot;</span>, <span class="hljs-string">&quot;Paradigm&quot;</span>, <span class="hljs-string">&quot;OOP&quot;</span>))
$<span class="hljs-number">111</span> ==&gt; <span class="hljs-literal">null</span>

jshell&gt; mapOfMap
mapOfMap ==&gt; {Java={Paradigm=OOP, Type=Strong-Typed}}

jshell&gt; mapOfMap.forEach(
    ..&gt;     (<span class="hljs-keyword">var</span> key, <span class="hljs-keyword">var</span> val) -&gt; System.out.println(key + <span class="hljs-string">&quot; : &quot;</span> + val))
Java : {Paradigm=OOP, Type=Strong-Typed}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="40" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="40" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Other basic syntax &amp; API</h1>
<h2><em>[<a href="https://openjdk.org/jeps/378">JEP378</a>, Java15]</em> Text Blocks</h2>
<p><code>&quot;&quot;&quot;</code>包含的字符串称为<em>文本块 TextBlock</em>。<br />
文本块允许使用<code>&quot;</code>而不需转义，<code>\&quot;&quot;&quot;</code>则需要转义。</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-string">&quot;&quot;&quot;
   ...&gt; Line 1
   ...&gt; Line 2
   ...&gt; Line 3
   ...&gt; Line 4
   ...&gt; &quot;&quot;&quot;</span>
$<span class="hljs-number">4</span> ==&gt; <span class="hljs-string">&quot;Line 1\nLine 2\nLine 3\nLine 4\n&quot;</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="41" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="41" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Other basic syntax &amp; API</h1>
<h2><em>[<a href="https://openjdk.org/jeps/378">JEP378</a>, Java15]</em> Text Blocks</h2>
<p>使用<code>\</code>取消换行</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-string">&quot;&quot;&quot;
   ...&gt; Line 1 \
   ...&gt; Line 2 \
   ...&gt; Line 3 \
   ...&gt; Line 4 \
   ...&gt; &quot;&quot;&quot;</span>
$<span class="hljs-number">5</span> ==&gt; <span class="hljs-string">&quot;Line 1 Line 2 Line 3 Line 4\n&quot;</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="42" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="42" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Other basic syntax &amp; API</h1>
<h2><em>[<a href="https://openjdk.org/jeps/378">JEP378</a>, Java15]</em> Text Blocks</h2>
<p>使用<code>\s</code>保证末尾空格不会删除，否则末尾空格会被替换为换行符。下面用<code>·</code>表示空格，而非实际字符：</p>
&lt;div class="columns"&gt;
&lt;div&gt;
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-string">&quot;&quot;&quot;
   ...&gt; red···
   ...&gt; green·
   ...&gt; blue··
   ...&gt; &quot;&quot;&quot;</span>
$<span class="hljs-number">1</span> ==&gt; <span class="hljs-string">&quot;red\ngreen\nblue\n&quot;</span>
</code></pre>
&lt;/div&gt;
&lt;div&gt;
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-string">&quot;&quot;&quot;
   ...&gt; red···\s
   ...&gt; green·\s
   ...&gt; blue··\s
   ...&gt; &quot;&quot;&quot;</span>
$<span class="hljs-number">1</span> ==&gt; <span class="hljs-string">&quot;red···\ngreen·\nblue··\n&quot;</span>
</code></pre>
&lt;/div&gt;
&lt;/div&gt;
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="43" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="43" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Other basic syntax &amp; API</h1>
<h2>Array</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-type">int</span>[] intArr = {<span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">9</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">5</span>};
intArr ==&gt; <span class="hljs-type">int</span>[<span class="hljs-number">10</span>] { <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">9</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">5</span> }
jshell&gt; intArr[<span class="hljs-number">1</span>]
$<span class="hljs-number">52</span> ==&gt; <span class="hljs-number">0</span>
jshell&gt; intArr[<span class="hljs-number">20</span>]
|  异常错误 java.lang.ArrayIndexOutOfBoundsException：Index <span class="hljs-number">20</span> out of bounds <span class="hljs-keyword">for</span> length <span class="hljs-number">10</span>
|        at (#<span class="hljs-number">53</span>:<span class="hljs-number">1</span>)
jshell&gt; <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i : intArr) System.out.print(i)
<span class="hljs-number">2019010895</span>
jshell&gt; intArr.length
$<span class="hljs-number">53</span> ==&gt; <span class="hljs-number">10</span>

jshell&gt; <span class="hljs-type">int</span>[] intArr2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">10</span>];
intArr2 ==&gt; <span class="hljs-type">int</span>[<span class="hljs-number">10</span>] { <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span> }
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="44" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="44" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Other basic syntax &amp; API</h1>
<h2>Array</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-type">var</span> <span class="hljs-variable">matrix</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">5</span>][<span class="hljs-number">5</span>];
matrix ==&gt; <span class="hljs-type">int</span>[<span class="hljs-number">5</span>][] { <span class="hljs-type">int</span>[<span class="hljs-number">5</span>] { <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span> }, <span class="hljs-type">int</span>[<span class="hljs-number">5</span>] { <span class="hljs-number">0</span>,  ... <span class="hljs-type">int</span>[<span class="hljs-number">5</span>] { <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span> } }
jshell&gt; <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i&lt;<span class="hljs-number">5</span>; i++) {
   ...&gt;     <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j&lt;<span class="hljs-number">5</span>; j++) {
   ...&gt;         matrix[i][j] = i * j;
   ...&gt;     }
   ...&gt; }
jshell&gt; matrix
matrix ==&gt; <span class="hljs-type">int</span>[<span class="hljs-number">5</span>][] {
    <span class="hljs-type">int</span>[<span class="hljs-number">5</span>] { <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span> },
    <span class="hljs-type">int</span>[<span class="hljs-number">5</span>] { <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span> },
    <span class="hljs-type">int</span>[<span class="hljs-number">5</span>] { <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span> },
    <span class="hljs-type">int</span>[<span class="hljs-number">5</span>] { <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">9</span>, <span class="hljs-number">12</span> },
    <span class="hljs-type">int</span>[<span class="hljs-number">5</span>] { <span class="hljs-number">0</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">12</span>, <span class="hljs-number">16</span> } }
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="45" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="45" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Other basic syntax &amp; API</h1>
<h2>Array Utility</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-keyword">import</span> java.util.Arrays;
jshell&gt; Arrays.sort(intArr)
jshell&gt; intArr
intArr ==&gt; <span class="hljs-type">int</span>[<span class="hljs-number">10</span>] { <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">9</span> }
jshell&gt; Arrays.binarySearch(intArr, <span class="hljs-number">5</span>)
$<span class="hljs-number">64</span> ==&gt; <span class="hljs-number">6</span>

jshell&gt; System.out.println(intArr)
[I@2d6eabae
jshell&gt; System.out.println(Arrays.toString(intArr))
[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">9</span>]
jshell&gt; System.out.println(Arrays.deepToString(matrix))
[[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">9</span>, <span class="hljs-number">12</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">12</span>, <span class="hljs-number">16</span>]]
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="46" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="46" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Other basic syntax &amp; API</h1>
<h2>Array Utility</h2>
<p>API Ref: <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Arrays.html">java.util.Arrays</a></p>
<ul>
<li>API是<em>应用编程接口 Application Programming Interface</em>，描述了Java类库向外提供的功能、使用方法、注意事项等信息。</li>
<li>JavaDoc是内置的生成网站形式的API文档的方式，Java标准库参考文档，也就是<a href="https://docs.oracle.com/en/java/javase/17/docs/api/">API Ref</a>就使用JavaDoc生成的。</li>
<li>Java标准库内容丰富，生态庞大，学会阅读、查找、遵循API文档是充分利用Java优势的第一步。</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="47" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="47" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Other basic syntax &amp; API</h1>
<h2>String</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-type">String</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;I Love Java&quot;</span>
s ==&gt; <span class="hljs-string">&quot;I Love Java&quot;</span>
jshell&gt; s.length()
$<span class="hljs-number">37</span> ==&gt; <span class="hljs-number">11</span>
jshell&gt; s.split(<span class="hljs-string">&quot; &quot;</span>)
$<span class="hljs-number">38</span> ==&gt; String[<span class="hljs-number">3</span>] { <span class="hljs-string">&quot;I&quot;</span>, <span class="hljs-string">&quot;Love&quot;</span>, <span class="hljs-string">&quot;Java&quot;</span> }
jshell&gt; s.concat(<span class="hljs-string">&quot; and Rust&quot;</span>)
$<span class="hljs-number">39</span> ==&gt; <span class="hljs-string">&quot;I Love Java and Rust&quot;</span>
jshell&gt; s.contains(<span class="hljs-string">&quot;C++&quot;</span>)
$<span class="hljs-number">40</span> ==&gt; <span class="hljs-literal">false</span>
jshell&gt; s.charAt(<span class="hljs-number">2</span>)
$<span class="hljs-number">41</span> ==&gt; <span class="hljs-string">&#x27;L&#x27;</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="48" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="48" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Other basic syntax &amp; API</h1>
<h2>String</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; s.replace(<span class="hljs-string">&quot;Java&quot;</span>, <span class="hljs-string">&quot;C++&quot;</span>)
$<span class="hljs-number">42</span> ==&gt; <span class="hljs-string">&quot;I Love C++&quot;</span>
jshell&gt; s.toUpperCase()
$<span class="hljs-number">46</span> ==&gt; <span class="hljs-string">&quot;I LOVE JAVA&quot;</span>
jshell&gt; s.toLowerCase()
$<span class="hljs-number">47</span> ==&gt; <span class="hljs-string">&quot;i love java&quot;</span>
jshell&gt; s.startsWith(<span class="hljs-string">&quot;I&quot;</span>)
$<span class="hljs-number">48</span> ==&gt; <span class="hljs-literal">true</span>
jshell&gt; s.endsWith(<span class="hljs-string">&quot;Java&quot;</span>)
$<span class="hljs-number">49</span> ==&gt; <span class="hljs-literal">true</span>
jshell&gt; s
s ==&gt; <span class="hljs-string">&quot;I Love Java&quot;</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="49" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="49" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Other basic syntax &amp; API</h1>
<h2>String</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; s == <span class="hljs-string">&quot;I Love Java&quot;</span>
$<span class="hljs-number">43</span> ==&gt; <span class="hljs-literal">true</span>
jshell&gt; s == <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(<span class="hljs-string">&quot;I Love Java&quot;</span>)
$<span class="hljs-number">44</span> ==&gt; <span class="hljs-literal">false</span>
jshell&gt; s.equals(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(<span class="hljs-string">&quot;I Love Java&quot;</span>))
$<span class="hljs-number">45</span> ==&gt; <span class="hljs-literal">true</span>
jshell&gt; s.equalsIgnoreCase(<span class="hljs-string">&quot;i lOve jAVA&quot;</span>)
$<span class="hljs-number">50</span> ==&gt; <span class="hljs-literal">true</span>
</code></pre>
<p>API Ref: <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html">java.lang.String</a></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="50" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="50" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Other basic syntax &amp; API</h1>
<h2>Console IO</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; System.out.println(<span class="hljs-string">&quot;I Love Java&quot;</span>)
I Love Java

jshell&gt; System.out.print(<span class="hljs-string">&quot;I Love Java&quot;</span>)
I Love Java
jshell&gt; System.out.printf(<span class="hljs-string">&quot;I Love %s\n&quot;</span>, <span class="hljs-string">&quot;Java&quot;</span>)
I Love Java
$<span class="hljs-number">82</span> ==&gt; java.io.PrintStream@4d95d2a2
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="51" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="51" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Other basic syntax &amp; API</h1>
<h2>Console IO</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-keyword">import</span> java.util.Scanner;
jshell&gt; <span class="hljs-type">var</span> <span class="hljs-variable">input</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);
jshell&gt; input.hasNextInt()
<span class="hljs-number">100</span>
$<span class="hljs-number">86</span> ==&gt; <span class="hljs-literal">true</span>
jshell&gt; input.nextInt()
$<span class="hljs-number">87</span> ==&gt; <span class="hljs-number">100</span>
jshell&gt; input.hasNextBoolean()
<span class="hljs-number">100</span>
$<span class="hljs-number">89</span> ==&gt; <span class="hljs-literal">false</span>
</code></pre>
<p>API Ref: <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Scanner.html">java.util.Scanner</a></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="52" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="52" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Other basic syntax &amp; API</h1>
<h2><code>BigInteger</code> <code>BigDecimal</code></h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-keyword">import</span> java.math.BigInteger;
jshell&gt; <span class="hljs-number">1000000000000000</span> + <span class="hljs-number">1</span>
|  错误:
|  整数太大
|  <span class="hljs-number">1000000000000000</span> + <span class="hljs-number">1</span>
|  ^
jshell&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInteger</span>(<span class="hljs-string">&quot;1000000000000000&quot;</span>).add(BigInteger.ONE)
$<span class="hljs-number">92</span> ==&gt; <span class="hljs-number">1000000000000001</span>
jshell&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInteger</span>(<span class="hljs-string">&quot;19260817&quot;</span>).isProbablePrime(<span class="hljs-number">10</span>)
$<span class="hljs-number">93</span> ==&gt; <span class="hljs-literal">true</span>
</code></pre>
<p>API Ref: <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/math/BigInteger.html">java.math.BigInteger</a></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="53" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="53" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Other basic syntax &amp; API</h1>
<h2><code>BigInteger</code> <code>BigDecimal</code></h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-keyword">import</span> java.math.BigDecimal;

jshell&gt; <span class="hljs-number">0.1</span> + <span class="hljs-number">0.2</span>
$<span class="hljs-number">94</span> ==&gt; <span class="hljs-number">0.30000000000000004</span>

jshell&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">&quot;0.1&quot;</span>).add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">&quot;0.2&quot;</span>))
$<span class="hljs-number">95</span> ==&gt; <span class="hljs-number">0.3</span>

jshell&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">&quot;0.000000001&quot;</span>).toEngineeringString()
$<span class="hljs-number">100</span> ==&gt; <span class="hljs-string">&quot;1E-9&quot;</span>
</code></pre>
<p>API Ref: <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/math/BigDecimal.html">java.math.BigDecimal</a></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="54" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="54" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Other basic syntax &amp; API</h1>
<h2><code>Math</code></h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; Math.
E                 <span class="hljs-title function_">IEEEremainder</span><span class="hljs-params">(    PI                abs(              absExact(
acos(             addExact(         asin(             atan(             atan2(
cbrt(             ceil(             class             copySign(         cos(
cosh(             decrementExact(   exp(              expm1(            floor(
floorDiv(         floorMod(         fma(              getExponent(      hypot(
incrementExact(   log(              log10(            log1p(            max(
min(              multiplyExact(    multiplyFull(     multiplyHigh(     negateExact(
nextAfter(        nextDown(         nextUp(           pow(              random()</span>
rint(             round(            scalb(            signum(           sin(
sinh(             sqrt(             subtractExact(    tan(              tanh(
toDegrees(        toIntExact(       toRadians(        ulp(
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="55" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="55" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Other basic syntax &amp; API</h1>
<h2><code>Math</code></h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; Math.sin(Math.PI / <span class="hljs-number">4</span>)
$<span class="hljs-number">103</span> ==&gt; <span class="hljs-number">0.7071067811865475</span>
jshell&gt; Math.floor(<span class="hljs-number">1.002</span>)
$<span class="hljs-number">104</span> ==&gt; <span class="hljs-number">1.0</span>
jshell&gt; Math.log(Math.E)
$<span class="hljs-number">107</span> ==&gt; <span class="hljs-number">1.0</span>
jshell&gt; Math.pow(<span class="hljs-number">2</span>, <span class="hljs-number">1.5</span>)
$<span class="hljs-number">108</span> ==&gt; <span class="hljs-number">2.82842712474619</span>
jshell&gt; Math.sqrt(<span class="hljs-number">2</span>)
$<span class="hljs-number">109</span> ==&gt; <span class="hljs-number">1.4142135623730951</span>
</code></pre>
<p>API Ref: <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Math.html">java.lang.Math</a></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="56" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="56" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>CodeLab 1-1</em> a +-*/^&amp;| b</h1>
<ul>
<li><code>codelab/chapter1/src/Lab1.java</code></li>
<li>标准输入输出</li>
<li>输入格式：若干行<code>a op b</code>，其中<code>op</code>是<code>+-*/^&amp;|</code>中的其中一种，以标准输入结束为终止</li>
<li>输出格式：若干行计算结果</li>
<li>提示：计算结果可能非常大</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="57" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="57" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>CodeLab 1-2</em> QuickSort</h1>
<ul>
<li><code>codelab/chapter1/src/Lab2.java</code></li>
<li>实现<code>public static void quickSort(int[] arr)</code></li>
<li>运行<code>main</code>方法会自动检测实现的正确性</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="58" data-paginate="true" data-background-image="url('img/bg.jpg')" data-class="lead" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" class="lead" data-marpit-pagination="58" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--class:lead;--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>Chapter 2</em></h1>
<h1>Fundamental OOP</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="59" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="59" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>What is OOP</h1>
<ul>
<li>OOP是面向对象编程 Object-Oriented Programming 的缩写</li>
<li>OOP是围绕<em>对象 Object</em>进行组织的一种编程<em>范式</em>
<ul>
<li>对象本身有利于程序员对一些概念进行自然的建模</li>
<li>使用对象封装状态、数据和行为有利于组织大规模、复杂的软件系统，也有利于团队协作开发</li>
</ul>
</li>
<li>经过多年的发展与经验的积累，已经有公认的一套<em>原则</em>和<em>设计模式</em>指导程序员正确有效的使用OOP解决现实问题</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="60" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="60" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Terms used in OOP</h1>
<ul>
<li>为了避免混淆，仅在这里列出相应术语的中英文对应，后面提到时只使用斜体英文</li>
<li><em>OOP</em> 面向对象编程</li>
<li><em>object</em> 对象：数据和行为的集合</li>
<li><em>class</em> 类：定义对象的模版</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="61" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="61" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Object</h1>
<ul>
<li><em>object</em>是数据和行为的集合</li>
<li>数据一般称为<em>member variable</em>, <em>field</em>, <em>state</em>, <em>data</em>等</li>
<li>行为一般称为<em>method</em>, <em>function</em>, <em>interface</em>, <em>protocol</em>等</li>
<li>面向对象编程原语是向<em>对象发送消息</em>，而不是面向过程编程中的<em>指令跳转</em></li>
<li><em>发送消息</em>就应当遵循一定的协议<em>protocol</em>，比如发送消息的类型和消息的内容，这表现为方法的名字和参数</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="62" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="62" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Class</h1>
<ul>
<li><em>class</em>是<em>object</em>的模版，是<em>object</em>的<em>类型</em></li>
<li><em>class</em>定义了<em>object</em>所拥有的数据和行为，而<em>object</em>包含了具体的数据值和对应行为的真正执行者</li>
<li><em>class</em>本身可以拥有一些数据和行为</li>
<li>面向对象编程的基本流程为：
<ol>
<li>设计类 <code>class Car { /* ... */ }</code></li>
<li>创建/实例化对象 <code>var myCar = new Car()</code></li>
<li>向对象发送消息 <code>myCar.move()</code></li>
</ol>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="63" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="63" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>OOP in Java</h1>
<ul>
<li><em>基本上</em> 万物皆对象
<ul>
<li>基本数据类型除外</li>
</ul>
</li>
<li>Java使用<em>引用</em>来控制对象
<ul>
<li>Java只有按值传递</li>
</ul>
</li>
<li>Java拥有自动内存管理机制
<ul>
<li>你只需要关系如何<code>new</code>，而无需担心对象是何时或如何被<code>delete</code></li>
<li>Java拥有多种优秀的垃圾收集器GC实现</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="64" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="64" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>CodeLab 2-1</em> Build a <code>Car</code> in Java</h1>
<h2><code>package</code></h2>
<p><code>package tourofjava.ch2.lab1;</code></p>
<ul>
<li>Java使用<em>包 package</em>组织代码。</li>
<li>包名使用<code>.</code>建立层次结构，应当与文件目录结构相同。</li>
<li>包虽然有嵌套结构，但是父目录和子目录之间没有如包含等的任何关系，仅仅是名字不同</li>
<li>包名通常全小写且单词之间无分隔</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="65" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="65" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>CodeLab 2-1</em> Build a <code>Car</code> in Java</h1>
<h2>Declare a <code>class</code></h2>
<p><code>public class Car { ... }</code></p>
<ul>
<li><code>public</code>是<em>访问控制关键字</em>的一种
<ul>
<li><code>public</code>代表其他所有类都可以访问，<code>private</code>代表只有这个类本身可以访问</li>
<li>应用于<em>class</em> <em>field</em> <em>method</em>的声明中</li>
<li>Java要求名为<code>&lt;name&gt;.java</code>的源文件中必须包含同名的<code>public class</code></li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="66" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="66" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>CodeLab 2-1</em> Build a <code>Car</code> in Java</h1>
<h2>Declare a <code>class</code></h2>
<p><code>public class Car { ... }</code></p>
<ul>
<li>类名通常采用大驼峰</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="67" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="67" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>CodeLab 2-1</em> Build a <code>Car</code> in Java</h1>
<h2>Declare member fields</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Car</span> {
    <span class="hljs-keyword">private</span> String brand;
    <span class="hljs-keyword">private</span> String model;
    <span class="hljs-keyword">private</span> String color;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> enginePower;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> currentSpeed;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> maxSpeed;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> price;
    
    <span class="hljs-comment">// ...</span>
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="68" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="68" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>CodeLab 2-1</em> Build a <code>Car</code> in Java</h1>
<h2>Declare member fields</h2>
<p><code>private String brand;</code></p>
<ul>
<li>访问控制 + 类型 + 成员域名 （通常采用小驼峰）</li>
<li><em>类成员变量的</em>默认值
<ul>
<li>数字类型：<code>0</code> <code>0.0</code></li>
<li><code>boolean</code>：<code>false</code></li>
<li>对象：<code>null</code>空指针</li>
</ul>
</li>
<li>可以定义时赋初始值</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="69" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="69" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>CodeLab 2-1</em> Build a <code>Car</code> in Java</h1>
<h2>Declare member fields</h2>
<ul>
<li><code>final</code>修饰的成员变量是常量，因此除了声明赋值、构造函数、实例初始化块之外，不允许对其进行其他修改
<ul>
<li><code>private final String finalVar</code>;</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="70" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="70" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>CodeLab 2-1</em> Build a <code>Car</code> in Java</h1>
<h2>Declare member fields</h2>
<ul>
<li><code>static</code>修饰的变量称为类变量，它不属于对象而属于类，因此访问的时候需要使用<code>&lt;class_name&gt;.</code><pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> { <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">String</span> <span class="hljs-variable">var</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;class var&quot;</span>; }

System.out.println(Test.<span class="hljs-keyword">var</span>);
</code></pre>
</li>
<li>通常使用<code>public static final</code>来声明一个全局类常量，常量的命名惯例是<em>全大写+用<code>_</code>分隔单词</em></li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="71" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="71" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>CodeLab 2-1</em> Build a <code>Car</code> in Java</h1>
<h2>构造器 constructor</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Car</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Car</span><span class="hljs-params">(String brand, String model, String color,
               <span class="hljs-type">int</span> enginePower, <span class="hljs-type">int</span> maxSpeed, <span class="hljs-type">int</span> price)</span> {
        <span class="hljs-built_in">this</span>.brand = brand;
        <span class="hljs-built_in">this</span>.model = model;
        <span class="hljs-built_in">this</span>.color = color;
        <span class="hljs-built_in">this</span>.enginePower = enginePower;
        <span class="hljs-built_in">this</span>.maxSpeed = maxSpeed;
        <span class="hljs-built_in">this</span>.price = price;
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="72" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="72" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>CodeLab 2-1</em> Build a <code>Car</code> in Java</h1>
<h2>构造器 constructor</h2>
<p><code>public Car(...)</code></p>
<ul>
<li>访问控制 + 类名 + (参数列表)</li>
<li>用于初始化对象数据</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="73" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="73" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>CodeLab 2-1</em> Build a <code>Car</code> in Java</h1>
<h2>构造器 constructor</h2>
<p><code>this.brand = brand;</code></p>
<ul>
<li>类的成员方法可以访问类的域和方法而不需要<code>this</code>指定</li>
<li>但是如果出现了变量或者形参名字冲突，则需要<code>this.</code>手动指定</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="74" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="74" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>CodeLab 2-1</em> Build a <code>Car</code> in Java</h1>
<h2>实例初始化块 Instance Initialization Block</h2>
<p>在类中直接使用<code>{}</code>扩起来的部分称为实例初始化块，它会在任何构造器运行之前运行。</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {
    { System.out.println(<span class="hljs-string">&quot;This is an Instance Initialization Block&quot;</span>); }
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Test</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">&quot;This is a constructor&quot;</span>);
    }
}

jshell&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>()
This is an Instance Initialization Block
This is a constructor
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="75" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="75" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>CodeLab 2-1</em> Build a <code>Car</code> in Java</h1>
<h2>静态初始化块 Static Initialization Block</h2>
<p>在类中使用<code>static {}</code>扩起来的部分称为静态初始化块。这个块会在类加载的时候运行一次。如果现在不是很清楚Java类加载的顺序和机制，那只需要记住，在绝大多数情况下，这个块在一个Java程序运行的过程中，会且只会运行一次。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="76" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="76" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>CodeLab 2-1</em> Build a <code>Car</code> in Java</h1>
<h2>Member methods</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Car</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">move</span><span class="hljs-params">(<span class="hljs-type">double</span> timeInSec)</span> {
        <span class="hljs-type">double</span> <span class="hljs-variable">distance</span> <span class="hljs-operator">=</span> currentSpeed / <span class="hljs-number">3.6</span> * timeInSec;
        System.out.println(<span class="hljs-string">&quot;Move &quot;</span> + distance + <span class="hljs-string">&quot; m in &quot;</span> + timeInSec + <span class="hljs-string">&quot; s&quot;</span>);
        <span class="hljs-keyword">return</span> distance;
    }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">honk</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">&quot;DiDi...&quot;</span>);
    }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">introduce</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">&quot;I&#x27;m a/an &quot;</span> + color + <span class="hljs-string">&quot; &quot;</span> + brand + <span class="hljs-string">&quot; &quot;</span> + model);
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="77" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="77" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>CodeLab 2-1</em> Build a <code>Car</code> in Java</h1>
<h2>Member methods</h2>
<ul>
<li>成员方法的命名习惯一般为<em>小驼峰</em></li>
<li>成员方法就是定义在类内部的方法/函数</li>
<li>并且也可以使用类内的成员变量和成员方法</li>
<li>类的<code>public</code>方法组成了类所定义的对象的公开接口/功能</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="78" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="78" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>CodeLab 2-1</em> Build a <code>Car</code> in Java</h1>
<h2>Getters &amp; Setters</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Car</span> {
    <span class="hljs-keyword">private</span> String brand;

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getBrand</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> brand;
    }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setBrand</span><span class="hljs-params">(String brand)</span> {
        <span class="hljs-built_in">this</span>.brand = brand;
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="79" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="79" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>CodeLab 2-1</em> Build a <code>Car</code> in Java</h1>
<h2>Getters &amp; Setters</h2>
<ul>
<li>在大多数情况下，类的成员变量应当被封装为<code>private</code>，对他们的访问和修改应该由相应的方法处理</li>
<li>对于<code>boolean</code>型域，一般使用<code>isXXX</code> <code>setXXX</code></li>
<li>对于其他类型域，一般使用<code>getXXX</code> <code>setXXX</code></li>
<li>对于简单的读写操作，这些代码确实是没什么用的模版代码，但是
<ul>
<li>IDE提供代码自动生成功能</li>
<li>Lombok等库提供了编译时生成方法机制</li>
<li>Record</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="80" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="80" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>CodeLab 2-1</em> Build a <code>Car</code> in Java</h1>
<h2>Using class &amp; object</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Car</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">var</span> <span class="hljs-variable">myCar</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Car</span>(<span class="hljs-string">&quot;BMW&quot;</span>, <span class="hljs-string">&quot;X7&quot;</span>, <span class="hljs-string">&quot;Black&quot;</span>, <span class="hljs-number">250</span>, <span class="hljs-number">245</span>, <span class="hljs-number">1_000_000</span>);
        myCar.introduce();
        myCar.honk();
        myCar.setSpeed(<span class="hljs-number">100</span>);
        myCar.move(<span class="hljs-number">600</span>);
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="81" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="81" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>CodeLab 2-1</em> Build a <code>Car</code> in Java</h1>
<h2>Using class &amp; object</h2>
<p><code>var myCar = new Car(&quot;BMW&quot;, &quot;X7&quot;, &quot;Black&quot;, 250, 245, 1_000_000);</code></p>
<ul>
<li>使用<code>new</code>创建新的对象，这个对象的生命周期、内存位置将由Java自动管理</li>
<li><code>new</code>会调用与提供参数类型对应的构造器
<ul>
<li>如果类不提供自定义构造器，那么默认提供无参数构造器</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="82" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="82" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>CodeLab 2-1</em> Build a <code>Car</code> in Java</h1>
<h2>Using class &amp; object</h2>
<p><code>myCar.introduce();</code></p>
<ul>
<li>使用<code>.</code>调用对象的方法/接口</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="83" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="83" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<p>所有人都喜欢代码重用。<br />
在面向对象的语义中，类定义了几乎所有的行为和数据，那么代码重用指的<em>重用类</em>，即<em>用已有的类来生成新的类</em>的过程。</p>
<p>下面就来介绍面向对象中最基本的<em>重用类</em>方式：</p>
<ul>
<li>组合 Composition</li>
<li>继承 Inheritance</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="84" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="84" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Composition</h2>
<ul>
<li>组合指的是在新类中包含已有类的对象 <em>（的引用）</em>。
<ul>
<li>你可能会说：就这？那确实，就这。</li>
<li>组合是最简单、但也是最基本的重用类的方式</li>
</ul>
</li>
<li>在我们的<code>Car</code>类中，我们实际上组合了若干个<code>String</code>对象来描述车的一些基本信息</li>
</ul>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Car</span> {
    <span class="hljs-keyword">private</span> String brand, model, color;
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="85" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="85" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Composition: 组合描述了 <em>&quot;has-a&quot;</em> 关系</h2>
<ul>
<li>我们可以这种语义来建模更复杂、更贴合实际的汽车，如：
<ul>
<li>一辆汽车 <em>有一个</em> 引擎</li>
<li>一辆汽车 <em>有四个</em> 轮子</li>
</ul>
</li>
<li>那么<em>汽车</em>的最大速度，就可以通过重用<em>引擎</em>中的数据或方法来进行计算</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="86" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="86" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Composition: 组合对象的初始化</h2>
<ul>
<li>前面提到，对象<em>引用</em>的默认值是<code>null</code>，对其进行任何访问都会引发空指针异常<code>java.lang.NullPointerException</code></li>
</ul>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span> {
   <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">s1</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;String 1&quot;</span>, s2, s3, s4; <span class="hljs-comment">// 1. definition</span>
   <span class="hljs-keyword">public</span> <span class="hljs-title function_">Demo</span><span class="hljs-params">()</span> { s2 = <span class="hljs-string">&quot;String 2&quot;</span>; }          <span class="hljs-comment">// 2. constructor</span>
   { s3 = <span class="hljs-string">&quot;String 3&quot;</span>; }                        <span class="hljs-comment">// 3. instance init</span>
   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">useS4</span><span class="hljs-params">()</span> {
      <span class="hljs-keyword">if</span> (s4 == <span class="hljs-literal">null</span>) s4 = <span class="hljs-string">&quot;String 4&quot;</span>;         <span class="hljs-comment">// 4. delayed init</span>
   }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="87" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="87" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance</h2>
<ul>
<li><em>继承</em>是面向对象编程的重要特征之一</li>
<li>在创建类的时候，总是使用了继承。在Java中，如果不手动指定，将会隐式继承自<code>java.lang.Object</code>类，表达了任何对象的通用接口</li>
<li><em>继承</em>将会使<em>子类</em>拥有所有<em>父类</em>的公开接口及其实现，并且可以访问<em>父类</em>中受保护的域和方法</li>
<li>使用<code>extends</code>关键字声明继承</li>
</ul>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Parent</span> { ... }
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Child</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Parent</span> { ... }
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="88" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="88" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance</h2>
<ul>
<li>Java不允许多重继承。原因在于：
<ul>
<li>规避<em>diamond problem</em>，即继承具有相同接口的不同的类导致子类的接口实现的歧义</li>
<li>多重继承带来的设计负担与带来的架构优势不对等</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="89" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="89" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance: 组合描述了 <em>&quot;is-a&quot;</em> 关系</h2>
<p>让我们考虑任何OOP课程都会讲的几何图形的例子：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Shape</span> {
   <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">area</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>; }
   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">()</span> {}
   <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">inside</span><span class="hljs-params">(<span class="hljs-type">double</span> x, <span class="hljs-type">double</span> y)</span> { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
}
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Rectangle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span> { ... }
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Circle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span> { ... }
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Triangle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span> { ... }
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="90" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="90" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance: 组合描述了 <em>&quot;is-a&quot;</em> 关系</h2>
<p>在这个例子中：</p>
<ul>
<li>矩形<code>Rectangle</code> 圆形<code>Circle</code> 三角形<code>Triangle</code> 都 <em>是一个</em> 几何图形 <code>Shape</code></li>
<li><code>Rectangle</code> <code>Circle</code> <code>Triangle</code>都包含了<code>Shape</code>提供的三个公开接口，即获取表面积<code>area()</code> 绘制<code>draw()</code> 判断点是否在图形内部<code>inside(double, double)</code></li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="91" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="91" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance: Override/重载方法</h2>
<p>子类会继承父类的接口，但是大多数情况下，子类需要提供自己的实现。这时就需要<em>override/重载</em>方法。比如<code>Shape</code>的<code>area()</code>和<code>inside(double, double)</code>都是无意义的。</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Circle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span> {
   <span class="hljs-type">double</span> x, y, r;
   <span class="hljs-keyword">public</span> <span class="hljs-title function_">Circle</span><span class="hljs-params">(<span class="hljs-type">double</span> x, <span class="hljs-type">double</span> y, <span class="hljs-type">double</span> r)</span> { ... }
   <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">area</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> Math.PI * r * r; }
   <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">inside</span><span class="hljs-params">(<span class="hljs-type">double</span> x1, <span class="hljs-type">double</span> y1)</span> {
      <span class="hljs-keyword">return</span> (x1 - x) * (x1 - x) + (y1 - y) * (y1 - y) &lt; r * r;
   }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="92" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="92" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance: Override/重载方法</h2>
<p>子类的重载方法实现中，可能需要重用父类方法的实现。Java中使用<code>super</code>关键字表示使用父类的接口与数据。<code>super</code>名字取自<em>超类 superclass</em>。</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> { <span class="hljs-keyword">public</span> String <span class="hljs-title function_">introduce</span><span class="hljs-params">()</span> { ... } }

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Person</span> {
   <span class="hljs-keyword">public</span> String <span class="hljs-title function_">introduce</span><span class="hljs-params">()</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.introduce() + <span class="hljs-string">&quot;24岁，事学生&quot;</span>;
   }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="93" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="93" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance: <code>@Override</code></h2>
<p>重载父类方法需要函数名和参数类型与顺序都相同，如果误写那么这个方法就是子类全新的方法，这会导致可能错误的调用父类的方法。<br />
如果明确知道自己想重载方法，可以使用<code>@Override</code><em>注解</em>来让编译器“提醒”你。</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Circle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span> {
   <span class="hljs-meta">@Override</span>
   <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">area</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> Math.PI * r * r; }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="94" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="94" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance: <code>@Override</code></h2>
<p>如果函数名不小心输入错误，那么编译器会很不高兴：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Circle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span> {
   <span class="hljs-meta">@Override</span>
   <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">arae</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> Math.PI * r * r; }
}
</code></pre>
<p><code>java: 方法不会覆盖或实现超类型的方法</code></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="95" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="95" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance: <code>@Override</code></h2>
<p>为了避免这种typo，除了使用<code>@Override</code>，我还建议使用IDE来为你自动生成函数签名。如在IntelliJ IDEA中，使用<code>control/ctrl + O</code>来自动重载方法。</p>
<p><em>毕竟Java语法还是比较繁琐的，我使用IDE就是为了延长我和我的键盘的寿命。</em></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="96" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="96" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance: 初始化父类</h2>
<p>父类中自然也会存在一些数据，所以可能有自定义的初始化/构造器实现。因为父类的成员域可能对子类不公开，即<code>private</code>，为了正确的初始化这些域，我们需要正确的使用父类的构造器。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="97" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="97" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance: 初始化父类</h2>
<p>如果父类<em>有无参数构造器</em>，那么子类的所有构造器，如果没有显式指定，将会<em>首先调用</em>父类的无参构造器。</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Shape</span> {
   <span class="hljs-comment">// ...</span>
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Circle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span> {
   <span class="hljs-type">double</span> x, y, r;
   <span class="hljs-keyword">public</span> <span class="hljs-title function_">Circle</span><span class="hljs-params">(<span class="hljs-type">double</span> x, <span class="hljs-type">double</span> y, <span class="hljs-type">double</span> r)</span> { ... }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="98" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="98" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance: 初始化父类</h2>
<p>如果父类<em>没有无参数构造器</em>，那么子类必须使用<code>super</code>关键字调用父类的构造器，而且这个语句<em>必须</em>在子类构造器的第一行。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="99" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="99" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance: 初始化父类</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> {
   <span class="hljs-keyword">private</span> String name;
   <span class="hljs-keyword">public</span> <span class="hljs-title function_">Person</span><span class="hljs-params">(String name)</span> { <span class="hljs-built_in">this</span>.name = name; }
}
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Person</span> {
   <span class="hljs-keyword">private</span> String university;
   <span class="hljs-keyword">public</span> <span class="hljs-title function_">Student</span><span class="hljs-params">(String name, String university)</span> {
      <span class="hljs-built_in">super</span>(name);
      <span class="hljs-built_in">this</span>.university = university;
   }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="100" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="100" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance: 初始化父类</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Person</span> {
   <span class="hljs-keyword">private</span> String university;
   <span class="hljs-keyword">public</span> <span class="hljs-title function_">Student</span><span class="hljs-params">(String name, String university)</span> {
      <span class="hljs-built_in">this</span>.university = university;
      <span class="hljs-built_in">super</span>(name);
   }
}
</code></pre>
<p><code>java: 对super的调用必须是构造器中的第一个语句</code></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="101" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="101" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance: 初始化父类</h2>
<p>这个限制是为了确保子类可以正确使用父类的域和方法。进而，<code>super()</code>的参数不可以传入、使用父类和子类的域或方法的返回值。</p>
<p><em>PS：不过确实有绕过这种限制的方法。但是试图访问未初始化的数据仍然是非常危险的，我在这里不介绍相关的方法，好奇的同学可以去查一查。</em></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="102" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="102" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance: 初始化父类</h2>
<p>下面的代码是非法的：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Parent</span> {
   <span class="hljs-keyword">public</span> String name;
   <span class="hljs-keyword">public</span> <span class="hljs-title function_">Parent</span><span class="hljs-params">(String name)</span> { <span class="hljs-built_in">this</span>.name = name; }
}
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Child</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Parent</span> {
   <span class="hljs-keyword">public</span> <span class="hljs-title function_">Child</span><span class="hljs-params">()</span> {
      <span class="hljs-built_in">super</span>(<span class="hljs-built_in">super</span>.name);
      <span class="hljs-comment">// super(name);</span>
   }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="103" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="103" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance: Upcasting &amp; Polymorphism</h2>
<p>继承带来的重要性质是<em>向上转型 Upcasting</em>和<em>多态 Polymorphism</em>。</p>
<p><em>Upcasting</em>指的是子类对象可以转型为父类。<br />
<code>Shape shape = new Circle(0, 0, 1);</code></p>
<p><em>Polymorphism</em>指的是对父类函数的调用可能使用的子类的实现，会根据代码运行时，对象的实际类型进行动态分发。<br />
<code>shape.area();  // Invoking Circle#area()</code></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="104" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="104" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance: Polymorphism in Depth</h2>
<ul>
<li>数据抽象、继承与多态时面向对象程序设计语言的三大基本特征</li>
<li>多态的作用在于，消除实际类型之间的耦合关系，使得代码设计中尽可能的依赖于公开接口而非具体实现</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="105" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="105" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance: Polymorphism in Depth</h2>
<p><strong>多态可以提升扩展性</strong>。考虑下面更加实际的绘制图形的代码，图形的绘制函数接收一个画板对象，用于执行实际的绘图指令，如<code>drawLine(int, int, int, int)</code>等：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Shape</span> { <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">(Canvas c)</span> {} }
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Circle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span> { <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">(Canvas c)</span> { ... } }
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Rectangle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span> { <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">(Canvas c)</span> { ... } }
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Triangle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span> { <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">(Canvas c)</span> { ... } }
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="106" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="106" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance: Polymorphism in Depth</h2>
<p>如果没有多态，我们需要根据具体的类型来调用具体的绘图实现：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">GUI</span> {
   <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">render</span><span class="hljs-params">(Circle    shape)</span> { shape.draw(getCanvas()); }
   <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">render</span><span class="hljs-params">(Rectangle shape)</span> { shape.draw(getCanvas()); }
   <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">render</span><span class="hljs-params">(Triangle  shape)</span> { shape.draw(getCanvas()); }
}
</code></pre>
<p>先不论这份代码做了多少重复工作，我们考虑加入一个新的图形子类<code>Ellipse</code>，那么<code>GUI</code>类还需要再添加一行<code>render</code>函数。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="107" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="107" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance: Polymorphism in Depth</h2>
<p>如果没有多态，我们需要根据具体的类型来调用具体的绘图实现：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">GUI</span> {
   <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">render</span><span class="hljs-params">(Circle    shape)</span> { shape.draw(getCanvas()); }
   <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">render</span><span class="hljs-params">(Rectangle shape)</span> { shape.draw(getCanvas()); }
   <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">render</span><span class="hljs-params">(Triangle  shape)</span> { shape.draw(getCanvas()); }
}
</code></pre>
<p>更有可能的是，<code>GUI</code>是别人提供的代码实现，我们没有修改他们的权力。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="108" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="108" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance: Polymorphism in Depth</h2>
<p>如果使用多态，那么直接接收一个<code>Shape</code>基类的对象，便可以实现运行时动态分发方法，并且也可以支持未来可能会添加的任意具体的图形子类。</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">GUI</span> {
   <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">render</span><span class="hljs-params">(Shape shape)</span> { shape.draw(getCanvas()); }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="109" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="109" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance: Polymorphism in Depth</h2>
<p><strong>尽量不要在构造器中使用多态函数</strong></p>
<p>否则基类构造器在执行时，可能会错误的调用了子类的多态函数，但是此时子类的数据还未被正确初始化，这可能会导致错误的结果甚至异常崩溃。</p>
<p>因此，尽可能的用简单的语句进行成员变量初始化。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="110" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="110" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance: Polymorphism in Depth</h2>
<p>Java中不是所有事物都支持多态：</p>
<ol>
<li><code>static</code>和<code>final</code>方法是<em>前期调用绑定</em>，即他们所调用的方法在编译时已经确定</li>
<li>成员域不存在多态。如果存在重名，只会单纯的出现了标识符覆盖。对重名域的访问只和方法实现所在的类绑定。</li>
<li><code>private</code>方法默认为<code>final</code>，因此即使重名也不会出现重载也不会支持多态。</li>
</ol>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="111" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="111" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance: Downcasting</h2>
<p>可以向上转型就可以向下转型。前提是需要判断一下是否真的是某个具体子类然后再尝试转型，否则会触发<code>java.lang.ClassCastException</code>异常。</p>
<p>判断某个对象是否是一个类的实例，可以使用<code>instanceof</code>关键字：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">if</span> (shape <span class="hljs-keyword">instanceof</span> Circle) {
   <span class="hljs-type">Circle</span> <span class="hljs-variable">circle</span> <span class="hljs-operator">=</span> (Circle) shape;
   <span class="hljs-comment">// do something with circle</span>
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="112" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="112" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Inheritance: Downcasting</h2>
<p>一个小语法糖：<em>[JEP394, Java16]</em> Pattern Matching for <code>instanceof</code></p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">if</span> (shape <span class="hljs-keyword">instanceof</span> Circle circle) {
   <span class="hljs-comment">// do something with circle</span>
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="113" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="113" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Composition vs Inheritance</h2>
<ul>
<li>两种方法都可以重用现有类的代码</li>
<li>组合适用于我们需要<em>使用</em>现有类的功能与接口的情况，继承适用于我们想新建一个现有类的特例，我们可以重新实现和扩展现有类的接口。</li>
<li>继承可能带来的问题是<em>破坏封装</em>，即子类被允许暴露父类的受保护域和方法，这通常是不推荐的。</li>
<li><strong>组合优先于继承</strong></li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="114" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="114" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Delegate</h2>
<p>考虑一辆可以载一些人的公共汽车，我们可以让公共汽车继承自<code>HashSet</code>来实现保存车上乘客信息的功能：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> { ... }
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Bus</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HashSet</span>&lt;Person&gt; { ... }

<span class="hljs-type">var</span> <span class="hljs-variable">bus</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bus</span>();
bus.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;c7w&quot;</span>));
bus.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;lambda&quot;</span>));
bus.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;xsun2001&quot;</span>));
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="115" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="115" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Delegate</h2>
<p>显然，这个设计并不好。一方面，公共汽车应当<em>是一辆</em>载具，<em>有一些</em>乘客，我们应当<em>组合</em>一个乘客的集合。另一方面，直接继承会给公共汽车一堆本来不需要的数据和实现。</p>
<p>但是，我们确实需要提供类似<em>继承</em>的功能，因为我们确实需要加入<em>add</em> <em>remove</em> <em>size</em> <em>clear</em>这种和集合很类似的接口。</p>
<p>很多其他的语言提供了<em>代理 delegate</em>或者<em>混入 mixin</em>等语法特性和概念。但是Java<s>显然</s>没有相关的语法支持。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="116" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="116" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Delegate</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Bus</span> {
   <span class="hljs-keyword">private</span> Set&lt;Person&gt; passengers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>();
   <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">add</span><span class="hljs-params">(Person p)</span> { <span class="hljs-keyword">return</span> passengers.add(p); }
   <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">remove</span><span class="hljs-params">(Person p)</span> { <span class="hljs-keyword">return</span> passengers.remove(p); }
   <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">size</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> passengers.size(); }
   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clear</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> passengers.clear(); }
}
</code></pre>
<p>在Java中，可以通过组合+手动转发的方法实现delegate。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="117" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="117" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Abstract class</h2>
<p>某些类本身就是作为其他类的父类而存在。比如上面提到的<code>Shape</code>类，它提供的接口实际上都是没有意义的哑实现，必须要借助具体的子类才能起作用。在Java中可以使用<em>抽象类 Abstract Class</em>来表达。</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Shape</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-type">double</span> <span class="hljs-title function_">area</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">inside</span><span class="hljs-params">(<span class="hljs-type">double</span> x, <span class="hljs-type">double</span> y)</span>;
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="118" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="118" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Reuse classes</h1>
<h2>Abstract class</h2>
<p>抽象类可以包含<em>抽象方法 Abstract Methods</em>，也就是在签名中带有<code>abstract</code>关键字的方法。这些方法没有实现，类似于C++中的<em>纯虚函数</em>。</p>
<p>抽象类不能被直接实例化，因为它们不提供具体接口的实现，还因为这在概念上是没有意义的：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-type">var</span> <span class="hljs-variable">shape</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Shape</span>(); <span class="hljs-comment">// Error</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="119" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="119" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Base of all: <code>java.lang.Object</code></h1>
<p><code>java.lang.Object</code>是所有类的超类，它代表的语义也非常直观：所有对象都<em>是一个</em>对象，确切的来说，是Java语言内的对象<code>java.lang.Object</code></p>
<p>根据继承的规则，任何类都包含了<code>java.lang.Object</code>中提供的公开接口，并应该在需要的时候提供正确的重载：</p>
<ul>
<li><code>String toString()</code></li>
<li><code>boolean equals(Object obj)</code></li>
<li><code>int hashCode()</code></li>
</ul>
<p>其他函数与更加细致的描述参见API文档：<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html">java.lang.Object</a></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="120" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="120" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Base of all: <code>java.lang.Object</code></h1>
<h2>对象的字符串描述：<code>String toString()</code></h2>
<p><code>System.out.println</code>和字符串拼接都接受对象作为参数或操作数，它们利用的就是<code>toString()</code>方法将任何对象都转化为字符串。设计好的字符串描述对于日志、调试等方面都有重要作用。</p>
<p>默认的<code>toString()</code>实现返回的是<code>&lt;类型&gt;@&lt;内存地址&gt;</code>，如<code>Circle@68be2bc2</code>，这显然没什么用。与其介绍怎么写比较好，我还是更推荐直接让IDEA自动生成一个就好了。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="121" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="121" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Base of all: <code>java.lang.Object</code></h1>
<h2>对象的字符串描述：<code>String toString()</code></h2>
<p>IDEA内置了大量的<code>toString()</code>实现模版，我推荐使用第一个，也就是最简单的一个：<code>String concat (+)</code>。<em>[JEP280, Java9]</em> 使用了<code>invokedynamic</code>指令提升了字符串拼接的性能表现，因此可以放心使用。</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> {
   <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Circle{&quot;</span> + <span class="hljs-string">&quot;r=&quot;</span> + r + <span class="hljs-string">&#x27;}&#x27;</span>;
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="122" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="122" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Base of all: <code>java.lang.Object</code></h1>
<h2>是否相同：<code>boolean equals(Object obj)</code></h2>
<p><code>equals</code>方法提供了比较对象<em>内容</em>是否相同、或者说在<em>逻辑上</em>而不是在<em>物理地址</em>上相同的实现。正确实现<code>equals</code>可以保证Java集合框架中判断包含、<code>Set</code>去重复等基础语义的正确性。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="123" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="123" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Base of all: <code>java.lang.Object</code></h1>
<h2>是否相同：<code>boolean equals(Object obj)</code></h2>
<p><code>equals</code>方法应当满足：对于非<code>null</code>对象引用<code>x,y,z</code>，有：</p>
<ol>
<li><em>自反性</em>：<code>x.equals(x) == true</code></li>
<li><em>对称性</em>：<code>x.equals(y) == y.equals(x)</code></li>
<li><em>传递性</em>：<code>x.equals(y) &amp;&amp; y.equals(z)</code> <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.054ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.242ex" role="img" focusable="false" viewBox="0 -525 1000 549"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="21D2" d="M580 514Q580 525 596 525Q601 525 604 525T609 525T613 524T615 523T617 520T619 517T622 512Q659 438 720 381T831 300T927 263Q944 258 944 250T935 239T898 228T840 204Q696 134 622 -12Q618 -21 615 -22T600 -24Q580 -24 580 -17Q580 -13 585 0Q620 69 671 123L681 133H70Q56 140 56 153Q56 168 72 173H725L735 181Q774 211 852 250Q851 251 834 259T789 283T735 319L725 327H72Q56 332 56 347Q56 360 70 367H681L671 377Q638 412 609 458T580 514Z"></path></g></g></g></svg></mjx-container> <code>x.equals(z) == true</code></li>
<li><em>一致性</em>：连续的调用<code>equals</code>方法的结果应当一致</li>
<li><code>x.equals(null) == false</code></li>
</ol>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="124" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="124" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Base of all: <code>java.lang.Object</code></h1>
<h2>是否相同：<code>boolean equals(Object obj)</code></h2>
<p>但是，在Java中实现正确的<code>equals</code>实际上是一个较为困难的事情。我推荐的实现方法是：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Class</span> {
   <span class="hljs-meta">@Override</span>
   <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">equals</span><span class="hljs-params">(Object o)</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span> == o) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">if</span> (!(o <span class="hljs-keyword">instanceof</span> Class clazz)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">return</span> <span class="hljs-comment">/* 依次比较各个域 */</span>;
   }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="125" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="125" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Base of all: <code>java.lang.Object</code></h1>
<h2>是否相同：<code>boolean equals(Object obj)</code></h2>
<ul>
<li><code>if(this==o) return true;</code> 如果两个对象引用相同，那内容一定相同</li>
<li><code>if (!(o instanceof Class)) return false;</code> 如果不是这个类的对象，那么一定不相同
<ul>
<li>有时这个实现为：<code>if (o == null || getClass() != o.getClass()) return false;</code></li>
<li>两种方法的区别在于是否接受子类与父类相同。一般情况是接受的，例如不同实现的集合<code>Set</code>，如果包含元素相同，也应当认为是相同的。当然，具体的实现选用需要具体情况讨论。</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="126" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="126" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Base of all: <code>java.lang.Object</code></h1>
<h2>是否相同：<code>boolean equals(Object obj)</code></h2>
<ul>
<li>比较各个域的方法
<ul>
<li>若为整数类型，直接<code>==</code>判断</li>
<li>若为浮点类型，使用<code>Double.compare</code>或<code>Float.compare</code>判断，这两个静态类函数可以帮忙处理<code>NaN</code>相关的情况</li>
<li>若为对象引用，使用<code>Objects.equals</code>判断，这个静态函数可以帮忙处理空指针</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="127" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="127" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Base of all: <code>java.lang.Object</code></h1>
<h2>是否相同：<code>boolean equals(Object obj)</code></h2>
<p>当然，如果没听懂，那就交给IDEA自动生成。如果你听懂了，也最好交给IDEA自动生成。<s>如果不是讲课我也快忘了怎么写了，完全被IDEA惯坏了（悲</s></p>
<p>选择：Template = <code>java.util.Objects.equals and hashCode (java 7+)</code><br />
并且勾选 &quot;Accept subclasses are parameter to equals() method&quot;</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="128" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="128" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Base of all: <code>java.lang.Object</code></h1>
<h2>散列函数：<code>int hashCode()</code></h2>
<p>散列函数的有效实现可以提供<code>HashMap</code> <code>HashSet</code>等哈希表相关数据结构的正确性和高性能。</p>
<p>应当保证：</p>
<ol>
<li>相同的对象散列值必须相同：<code>x.equals(y) == true</code> <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.054ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.242ex" role="img" focusable="false" viewBox="0 -525 1000 549"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="21D2" d="M580 514Q580 525 596 525Q601 525 604 525T609 525T613 524T615 523T617 520T619 517T622 512Q659 438 720 381T831 300T927 263Q944 258 944 250T935 239T898 228T840 204Q696 134 622 -12Q618 -21 615 -22T600 -24Q580 -24 580 -17Q580 -13 585 0Q620 69 671 123L681 133H70Q56 140 56 153Q56 168 72 173H725L735 181Q774 211 852 250Q851 251 834 259T789 283T735 319L725 327H72Q56 332 56 347Q56 360 70 367H681L671 377Q638 412 609 458T580 514Z"></path></g></g></g></svg></mjx-container> <code>x.hashCode() == y.hashCode()</code></li>
<li>不同对象的散列值尽可能的不同</li>
<li><code>equals()</code>和<code>hashCode()</code><strong>必须同时重载</strong>。IDEA会帮你同时生成。</li>
</ol>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="129" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="129" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Base of all: <code>java.lang.Object</code></h1>
<h2>散列函数：<code>int hashCode()</code></h2>
<p>为了减轻程序员设计散列函数的负担，Java提供了<code>Objects#hash</code>静态方法计算散列值，你只需要：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Class</span> {
   <span class="hljs-meta">@Override</span>
   <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">hashCode</span><span class="hljs-params">()</span> {
      <span class="hljs-keyword">return</span> Objects.hash( <span class="hljs-comment">/* 填入各个成员域 */</span> );
   }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="130" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="130" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Enhance Functionality</h1>
<p>在上一大节中，我们学习了重用现有类的技术。在这一大节中，我们将会认识扩展类的功能的技术：<em>接口 interface</em></p>
<p><code>interface</code>实际上是<code>abstract class</code>的进一步抽象形式。<code>abstract class</code>允许含有不包含实现的抽象方法，而<code>interface</code>只定义了抽象方法，并且也不被允许有成员域（毕竟没有具体实现也不需要关联数据）。</p>
<p><code>interface</code>描述了对象之间可以使用的方法，定义了对象之间互相通讯的协议。因为其只含有方法声明，因此也没有了继承的<em>只允许单一继承</em>的限制。实现接口会让类的功能扩展，而不会引入其他的实现依赖。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="131" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="131" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Enhance Functionality</h1>
<h2>Using <code>interface</code></h2>
<p>观察发现，我们的图形基类<code>Shape</code>只包含了抽象方法，因此可以直接转化为接口：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Shape</span> {
    <span class="hljs-type">double</span> <span class="hljs-title function_">area</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">()</span>;
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">inside</span><span class="hljs-params">(<span class="hljs-type">double</span> x, <span class="hljs-type">double</span> y)</span>;
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="132" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="132" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Enhance Functionality</h1>
<h2>Using <code>interface</code></h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Shape</span> {
    <span class="hljs-type">double</span> <span class="hljs-title function_">area</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">()</span>;
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">inside</span><span class="hljs-params">(<span class="hljs-type">double</span> x, <span class="hljs-type">double</span> y)</span>;
}
</code></pre>
<ul>
<li>使用<code>interface</code>关键字声明接口</li>
<li>接口中的方法应当都为<code>public abstract</code>，因此无需再次声明</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="133" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="133" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Enhance Functionality</h1>
<h2>Using <code>interface</code></h2>
<p>其他具体的图形类也都应该进行相应的修改：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Circle</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Shape</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> r;
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Circle</span><span class="hljs-params">(<span class="hljs-type">double</span> r)</span> { <span class="hljs-built_in">this</span>.r = r; }
    
    <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">area</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> Math.PI * r * r; }
    <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">()</span> { <span class="hljs-comment">/* ... */</span> }
    <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">inside</span><span class="hljs-params">(<span class="hljs-type">double</span> x, <span class="hljs-type">double</span> y)</span> {
        <span class="hljs-keyword">return</span> x * x + y * y &lt; r * r;
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="134" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="134" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Enhance Functionality</h1>
<h2>Using <code>interface</code></h2>
<p><code>class Circle implements Shape</code></p>
<p>使用<code>implements</code>关键字声明实现的接口列表。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="135" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="135" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Enhance Functionality</h1>
<h2><code>static</code> fields</h2>
<p>可以为<code>interface</code>内声明变量，但是这不是成员变量，而是默认的<code>public static final</code>变量，也就是接口的静态常量。</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Shape</span> {
   <span class="hljs-type">int</span> <span class="hljs-variable">MAX_WIDTH</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span>, MAX_HEIGHT = <span class="hljs-number">100</span>;
}

<span class="hljs-type">int</span> <span class="hljs-variable">width</span> <span class="hljs-operator">=</span> Shape.MAX_WIDTH;
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="136" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="136" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Enhance Functionality</h1>
<h2><code>static</code> methods</h2>
<p><code>interface</code>内允许有<code>static</code>方法，同样默认为<code>public</code>可见性。</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Shape</span> {
   <span class="hljs-keyword">static</span> Shape <span class="hljs-title function_">createUnitCircle</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Circle</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>); }
}

<span class="hljs-type">var</span> <span class="hljs-variable">unit</span> <span class="hljs-operator">=</span> Shape.createUnitCircle();
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="137" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="137" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Enhance Functionality</h1>
<h2><code>default</code> methods</h2>
<p>Java允许接口内存在带有实现的<code>default</code>方法。</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Shape</span> {
   <span class="hljs-type">boolean</span> <span class="hljs-title function_">inside</span><span class="hljs-params">(<span class="hljs-type">double</span> x, <span class="hljs-type">double</span> y)</span>;
   <span class="hljs-keyword">default</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">outside</span><span class="hljs-params">(<span class="hljs-type">double</span> x, <span class="hljs-type">double</span> y)</span> {
      <span class="hljs-keyword">return</span> !inside(x, y);
   }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="138" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="138" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Enhance Functionality</h1>
<h2><code>default</code> methods</h2>
<ul>
<li><code>default</code>提供默认的方法实现，这也意味着实现接口的类可以进行重载</li>
<li>接口的某些方法可以由已有的方法导出，比如判断集合<code>Set</code>是否为空<code>isEmpty()</code>时，对于大多数集合来说，可以通过判断<code>size() == 0</code>实现。这时就可以使用<code>default</code>来避免每个子类都写一句<code>size() == 0</code></li>
<li><code>default</code>用于保证二进制兼容性。修改已有接口可能导致以前使用这个接口的类库出现方法未实现的错误。通过添加<code>default</code>函数可以避免这个问题。</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="139" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="139" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Enhance Functionality</h1>
<h2><code>default</code> methods</h2>
<p>但是这又引入了<em>diamond problem</em>，即类实现了两个具有相同<code>default</code>方法的接口时出现的实现歧义。</p>
<p>在Java中，如果出现这种情况，你<em>必须</em>重载这个冲突的方法来提供自己的实现。如果想使用提供的<code>default</code>实现，你应当通过<code>&lt;interface_name&gt;.super.&lt;func_name&gt;()</code>手动指定使用哪一个接口。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="140" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="140" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Enhance Functionality</h1>
<h2><code>default</code> methods</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Inter1</span> {
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">foo</span><span class="hljs-params">()</span> { System.out.println(<span class="hljs-string">&quot;Inter1&quot;</span>); }
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Inter2</span> {
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">foo</span><span class="hljs-params">()</span> { System.out.println(<span class="hljs-string">&quot;Inter2&quot;</span>); }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Inter1</span>, Inter2 {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">foo</span><span class="hljs-params">()</span> { Inter1.<span class="hljs-built_in">super</span>.foo(); }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="141" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="141" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Enhance Functionality</h1>
<h2><code>default</code> methods</h2>
<ul>
<li><strong><code>default</code> method VS <code>abstract</code> class</strong></li>
<li>可能有同学回想起了抽象类。确实，这两种机制都允许具体实现和纯接口混合，那么我们应当选择哪一种方案呢？</li>
<li><strong>优先选择使用<code>interface</code></strong></li>
<li>如果确实需要类提供的功能，如需要成员域、构造器、完全访问控制等只有类才具有的特性，才应该考虑抽象类。</li>
<li>接口没有单一继承限制，因此可以提升系统扩展性。</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="142" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="142" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Inner class</h1>
<p>内部类就是定义在类内部的类。内部类的定义也需要访问控制符。</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Outer</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Inner</span> {
        <span class="hljs-comment">// ...</span>
    }
    <span class="hljs-comment">// ...</span>
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="143" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="143" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Inner class</h1>
<p>除了命名上的嵌套关系，内部类最重要的一点就是，具有对<em>外围对象</em>的访问权，甚至可以访问<em>外围对象</em>的<code>private</code>成员。</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Outer</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Outer class&quot;</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Inner</span> {
        <span class="hljs-keyword">public</span> String <span class="hljs-title function_">outerName</span> <span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> name;
        }
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="144" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="144" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Inner class</h1>
<p>如果出现命名覆盖或者想明确使用外围对象的成员，需要使用<code>.this</code>语法：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Outer</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Outer class&quot;</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Inner</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Inner class&quot;</span>;
        <span class="hljs-keyword">public</span> String <span class="hljs-title function_">outerName</span> <span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> Outer.<span class="hljs-built_in">this</span>.name;
        }
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="145" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="145" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Inner class</h1>
<p>可以在外部类里直接实例化内部类。如果不在外部类内，那么必须显式提供外围对象的引用，并使用<code>.new</code>语法实例化：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Outer</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Inner</span> { <span class="hljs-comment">/* ... */</span> }
    <span class="hljs-keyword">public</span> Inner <span class="hljs-title function_">innerInstance</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Inner</span>(); }
}

<span class="hljs-comment">// Outside of class Outer</span>
<span class="hljs-type">Outer</span> <span class="hljs-variable">outer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Outer</span>();
Outer.<span class="hljs-type">Inner</span> <span class="hljs-variable">inner</span> <span class="hljs-operator">=</span> outer.<span class="hljs-keyword">new</span> <span class="hljs-title class_">Inner</span>();
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="146" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="146" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Inner class</h1>
<p>内部类提供了隐藏实细节的一种方式。通过调整内部类的访问控制，外部系统甚至有可能找不到具体接口实现或子类的具体对象。这完全阻止了依赖于类型的编码，完全隐藏了实现细节。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="147" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="147" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Inner class</h1>
<p>内部类提供了另一种<em>多重继承</em>的实现方案。通过返回内部类的实例，可以向外部提供继承自不同父类的对象，并且这些对象都可以访问外围对象内的任何数据和方法。</p>
<p>比如我们想让一个类同时提供<code>Class1</code> <code>Class2</code>的功能，但是我们又不能同时继承自这两个类，那么我们可以为我们的类提供两个内部类<code>SubClass1</code> <code>SubClass2</code>，分别继承自两个父类，并在需要某个类的功能时，实例化并返回对应内部类的对象。</p>
<p>这相当于共享充电宝的三个不同插口的充电线，我们需要哪个规格的插口，就“调用对应的方法”获取充电线的实例。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="148" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="148" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Inner class</h1>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AppleLightning</span> { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UsbTypeC</span> { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UsbMicroTypeB</span> { <span class="hljs-comment">/* ... */</span> }

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PowerBank</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> powerLeft;

    <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppleLightningImpl</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppleLightning</span> { <span class="hljs-comment">/* ... */</span> }
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">UsbTypeCImpl</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">UsbTypeC</span> { <span class="hljs-comment">/* ... */</span> }
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">UsbMicroTypeBImpl</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">UsbMicroTypeB</span> { <span class="hljs-comment">/* ... */</span> }

    <span class="hljs-keyword">public</span> AppleLightning <span class="hljs-title function_">lightning</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AppleLightningImpl</span>(); }
    <span class="hljs-keyword">public</span> UsbTypeC       <span class="hljs-title function_">typeC</span><span class="hljs-params">()</span>     { <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UsbTypeCImpl</span>(); }
    <span class="hljs-keyword">public</span> UsbMicroTypeB  <span class="hljs-title function_">microB</span><span class="hljs-params">()</span>    { <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UsbMicroTypeBImpl</span>(); }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="149" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="149" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Inner class</h1>
<h2>Local inner class</h2>
<p><strong>局部内部类</strong>：你可以在方法内部甚至任意的作用域内定义类。</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PowerBank</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> powerLeft;
    
    <span class="hljs-keyword">public</span> AppleLightning <span class="hljs-title function_">lightning</span><span class="hljs-params">()</span> { 
        <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppleLightningImpl</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppleLightning</span> { <span class="hljs-comment">/* ... */</span> }

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AppleLightningImpl</span>();
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="150" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="150" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Inner class</h1>
<h2>Anonymous inner class</h2>
<p><strong>匿名内部类</strong>：观察下面的例子：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PowerBank</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> powerLeft;
    
    <span class="hljs-keyword">public</span> AppleLightning <span class="hljs-title function_">lightning</span><span class="hljs-params">()</span> { 
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AppleLightning</span>() {
            <span class="hljs-comment">// Implements of AppleLightningImpl</span>
        };
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="151" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="151" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Inner class</h1>
<h2>Anonymous inner class</h2>
<p><code>new BaseClass() { /* ... */ };</code>创建了一个匿名内部类的对象，这实际上等价与（类名为编译器生成）：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BaseClass$1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseClass</span> { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">new</span> <span class="hljs-title class_">BaseClass$1</span>();
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="152" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="152" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Inner class</h1>
<h2>Anonymous inner class</h2>
<p>匿名内部类不允许有构造器，因为显然我们并不知道匿名类的名字。如果我们需要对类进行初始化操作，需要使用<em>实例初始化</em>：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> AppleLightning <span class="hljs-title function_">lightning</span><span class="hljs-params">()</span> { 
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AppleLightning</span>() {
        { System.out.println(<span class="hljs-string">&quot;Init AppleLightning&quot;</span>); }
    };
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="153" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="153" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Inner class</h1>
<h2>Anonymous inner class</h2>
<p>在匿名内部类中使用的外部变量必须为<code>final</code>或者<em>等效<code>final</code>的</em>。</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Calculator</span> { <span class="hljs-type">int</span> <span class="hljs-title function_">apply</span><span class="hljs-params">(<span class="hljs-type">int</span> a)</span>; }

Calculator <span class="hljs-title function_">mul</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> {
    <span class="hljs-comment">// x = 10; x is effectively final</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Calculator</span>() {
        <span class="hljs-meta">@Override</span> <span class="hljs-type">int</span> <span class="hljs-title function_">apply</span><span class="hljs-params">(<span class="hljs-type">int</span> a)</span> { <span class="hljs-keyword">return</span> x * a; }
    }
}

mul(<span class="hljs-number">5</span>).apply(<span class="hljs-number">3</span>); <span class="hljs-comment">// == 15</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="154" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="154" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Inner class</h1>
<h2>Anonymous inner class</h2>
<p>上一页的例子展示了类似函数式编程中<em>柯里化 Currying</em>的语法，只不过Java没有运算符重载，因此还是得写一个<code>.apply</code>。</p>
<p>这也展示了使用匿名内部类创建<em>闭包</em>的特性。<em>闭包</em>是将一个函数实现和周围状态/词法环境捆绑到一起的组合，它拥有能访问创建自己时的作用域的能力，在栗子中，则是可以访问外围方法的参数<code>int x</code>，即使函数已经退出运行。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="155" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="155" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Inner class</h1>
<h2>Anonymous inner class</h2>
<p>Java对匿名内部类所用外部变量的<code>final</code>要求源自于内部管理闭包的机制：Java会在创建匿名内部类时，自动将所需的外部变量拷贝进去。如果后面对外部变量进行修改，那么匿名内部类中的值和外部变量的值会不一致，出现令人疑惑的语义问题。因此Java设计者让这些外部变量为<code>final</code>，不允许修改。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="156" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="156" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Inner class</h1>
<h2>Lambda Expression</h2>
<p>有熟悉JavaScript或任何现代一点的语言的同学可能会说：你这Java的闭包保熟吗？怎么语法这么繁琐？不仅要<code>new</code>还得重写一遍方法签名？</p>
<p>这时自然就要介绍<s>对Java来说</s>重量级的语法特性了：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">Calculator <span class="hljs-title function_">mul</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> {
    <span class="hljs-keyword">return</span> (<span class="hljs-type">int</span> y) -&gt; x * y;
}
</code></pre>
<p>是不是一下子就觉得现代起来了！</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="157" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="157" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Inner class</h1>
<h2>Lambda Expression</h2>
<p>Lambda表达式的参数列表也支持<code>var</code>自动推断：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">Calculator <span class="hljs-title function_">mul</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> {
    <span class="hljs-keyword">return</span> (<span class="hljs-keyword">var</span> y) -&gt; x * y;
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="158" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="158" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Inner class</h1>
<h2>Lambda Expression</h2>
<p>Lambda表达式实际上可以看做一种特殊的匿名内部类：</p>
<ul>
<li>只允许实现<em>函数式接口</em>，也就是只含有一个方法的接口。这种接口只代表了这个方法，也称为函数。</li>
<li>比如我们的<code>Calculator</code>就只包含一个方法<code>int apply(int)</code>，因此可成为函数式接口。</li>
</ul>
<p>关于Lambda表达式的其他用法和标准库支持，我们会在<em>高级语法特性</em>章节中详细讲解。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="159" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="159" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Enum</h1>
<p><em>枚举 Enum</em>是一种特殊的类，用于为一系列相关的常量提供命名空间和更好的语义。</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">Size</span> { SMALL, MEDIUM, LARGE, EXTRA_LARGE }
</code></pre>
<p>这等价于：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Size</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Enum</span>&lt;Size&gt; {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Size</span> <span class="hljs-variable">SMALL</span>       <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Size</span>();
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Size</span> <span class="hljs-variable">MEDIUM</span>      <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Size</span>();
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Size</span> <span class="hljs-variable">LARGE</span>       <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Size</span>();
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Size</span> <span class="hljs-variable">EXTRA_LARGE</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Size</span>();
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="160" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="160" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Enum</h1>
<p>枚举类也可以有构造器，我们需要声明枚举项的同时提供构造器的参数：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">Size</span> {
    SMALL(<span class="hljs-string">&quot;S&quot;</span>), MEDIUM(<span class="hljs-string">&quot;M&quot;</span>), LARGE(<span class="hljs-string">&quot;L&quot;</span>), EXTRA_LARGE(<span class="hljs-string">&quot;XL&quot;</span>);
    
    <span class="hljs-keyword">private</span> String abbr;
    <span class="hljs-keyword">private</span> <span class="hljs-title function_">Size</span><span class="hljs-params">(String abbr)</span> { <span class="hljs-built_in">this</span>.abbr = abbr; }
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getAbbr</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> abbr; }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="161" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="161" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Enum</h1>
<p>可以像访问类常量一样访问枚举项：<code>var mySize = Size.LARGE;</code></p>
<p><code>toString()</code>被实现为返回枚举项的名字：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; Size.SMALL.toString()
$<span class="hljs-number">31</span> ==&gt; <span class="hljs-string">&quot;SMALL&quot;</span>
</code></pre>
<p><code>ordinal()</code>返回枚举项的次序：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; Size.EXTRA_LARGE.ordinal()
$<span class="hljs-number">32</span> ==&gt; <span class="hljs-number">3</span>
</code></pre>
<p>更多方法参见API文档：<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Enum.html">java.lang.Enum&lt;E&gt;</a></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="162" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="162" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Recap</h1>
<p>在本章节<em>Fundamental OOP</em>中，我们学习了</p>
<ul>
<li>面向对象的基本概念</li>
<li>创建、使用类的语法</li>
<li>重用类的方法：组合和继承</li>
<li>扩展类的方法：接口</li>
<li>使用内部类进一步封装实现</li>
<li>使用匿名内部类和Lambda表达式创建闭包</li>
</ul>
<p>至此，Java的所有基本语法特性均已介绍，大家已经正式入门Java啦～</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="163" data-paginate="true" data-background-image="url('img/bg.jpg')" data-class="lead" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" class="lead" data-marpit-pagination="163" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--class:lead;--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>Chapter 3</em></h1>
<h1>Design Patterns</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="164" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="164" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>What are Design Patterns</h1>
<ul>
<li><em>设计模式 Design Patterns</em>是一套最佳实践，描述了软件开发人员在面临一些一般性问题时使用和总结出的解决方案。</li>
<li>1994年， Erich Gamma、Richard Helm、Ralph Johnson 和 John Vlissides合著了<em>Design Patterns - Elements of Reusable Object-Oriented Software</em>（《设计模式——可复用面向对象软件的基础》），首次提出了设计模式的概念，并对大多数常见的设计模式进行了分类组织和讨论。这四位作者也被称为<em>四人帮 GoF, Gang of Four</em>。</li>
<li>合理的利用设计模式让代码组织真正的工程化，减少耦合、提升可维护性、提升复用度。</li>
<li>本章我会带大家认识一些常见的设计模式，并介绍Java标准库中相应的设计范例。</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="165" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="165" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>OOP Principle</h1>
<ul>
<li><strong>对接口编程而不是对实现编程</strong></li>
<li><strong>组合优先于继承</strong></li>
<li><strong>单一职责原则：类的职责应当尽可能的少而清晰</strong></li>
<li><strong>合理使用设计模式，而不要滥用</strong></li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="166" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="166" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Catalog</h2>
<p>创造型模式描述了如何创建对象：</p>
<ol>
<li><em>Builder</em> 建造者模式</li>
<li><em>Factory Method</em> 工厂方法模式</li>
<li><em>Abstract Factory</em> 抽象工厂模式</li>
<li><em>Singleton</em> 单例模式</li>
</ol>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="167" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="167" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Builder</h2>
<p>考虑我们现在看到的这个课件。我使用<a href="https://marp.app/">Marp</a>将Markdown转化为PPT形式的课件。它也有将Markdown转化为Html等其他格式的能力。</p>
<p>Markdown的结构都是统一的，由多级标签、列表、代码块等基础元素组成。但是背后成品的表现形式是多样化的。如果我们直接写Markdown到PDF/Html的方法，那么可能需要重复写读取、解析Markdown的过程。这时我们就需要<em>构建者</em>模式来优化设计。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="168" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="168" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Builder</h2>
<p>构建者模式通常由一个<em>指导者 Director</em>类、一个<em>构造者 Builder</em>接口/抽象类和若干个具体构建者实现类组成。<br />
在我们的例子中，<em>Builder</em>提供构建其他格式文档所需要的接口：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">DocumentBuilder</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">appendText</span><span class="hljs-params">(String para)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">appendHeader</span><span class="hljs-params">(String header, <span class="hljs-type">int</span> level)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">appendInlineCode</span><span class="hljs-params">(String code)</span>;
    <span class="hljs-comment">// ... More elements</span>
    String <span class="hljs-title function_">build</span><span class="hljs-params">()</span>;  <span class="hljs-comment">// Get build result</span>
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="169" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="169" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Builder</h2>
<p><em>Director</em>管理Markdown的解析，并使用<em>Builder</em>构建转化后的文档：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MarkdownDirector</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> DocumentBuilder builder;
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">MarkdownDirector</span><span class="hljs-params">(DocumentBuilder builder)</span> { <span class="hljs-built_in">this</span>.builder = builder; }
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">convert</span><span class="hljs-params">(String markdownText)</span> {
        markdownText.lines().forEach(<span class="hljs-built_in">this</span>::parseLine);
        <span class="hljs-keyword">return</span> builder.build();
    }
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">parseLine</span><span class="hljs-params">(String line)</span> {
        <span class="hljs-comment">// ...</span>
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="170" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="170" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Builder</h2>
<p><em>Director</em>管理Markdown的解析，并使用<em>Builder</em>构建转化后的文档：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-comment">// Demo implement</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">parseLine</span><span class="hljs-params">(String line)</span> {
    <span class="hljs-keyword">if</span> (line.startsWith(<span class="hljs-string">&quot;###### &quot;</span>)) builder.appendHeader(line.substring(<span class="hljs-number">7</span>), <span class="hljs-number">6</span>);
    <span class="hljs-keyword">if</span> (line.startsWith(<span class="hljs-string">&quot;##### &quot;</span>)) builder.appendHeader(line.substring(<span class="hljs-number">6</span>), <span class="hljs-number">5</span>);
    <span class="hljs-comment">// ...</span>
    <span class="hljs-keyword">if</span> (line.startsWith(<span class="hljs-string">&quot;# &quot;</span>)) builder.appendHeader(line.substring(<span class="hljs-number">2</span>), <span class="hljs-number">1</span>);
    <span class="hljs-keyword">if</span> (line.startsWith(<span class="hljs-string">&quot;- &quot;</span>)) builder.appendUnorderedList(line.substring(<span class="hljs-number">2</span>));
    <span class="hljs-comment">// ...</span>
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="171" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="171" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Builder</h2>
<p>具体的<em>Builder</em>实现包含了对应具体目标文件格式的转化实现，比如：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">HtmlBuilder</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">DocumentBuilder</span> {
    <span class="hljs-keyword">private</span> StringBuilder strBuf;
    <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">appendText</span><span class="hljs-params">(String para)</span> {
        strBuf.append(<span class="hljs-string">&quot;&lt;p&gt;&quot;</span>).append(para).append(<span class="hljs-string">&quot;&lt;/p&gt;\n&quot;</span>);
    }
    <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">appendHeader</span><span class="hljs-params">(String header, <span class="hljs-type">int</span> level)</span> {
        strBuf.append(<span class="hljs-string">&quot;&lt;h&quot;</span> + level + <span class="hljs-string">&quot;&gt;&quot;</span>)
              .append(header)
              .append(<span class="hljs-string">&quot;&lt;/h&quot;</span> + level + <span class="hljs-string">&quot;&gt;\n&quot;</span>)
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="172" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="172" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Builder</h2>
<p>具体的<em>Builder</em>实现包含了对应具体目标文件格式的转化实现，比如：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">HtmlBuilder</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">DocumentBuilder</span> {
    <span class="hljs-keyword">private</span> StringBuilder strBuf;
    <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> String <span class="hljs-title function_">build</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> strBuf.toString();
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="173" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="173" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Builder</h2>
<p>作为这个格式转化系统的使用者，我们可以根据需要的文件格式提供相应的构建器：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException {
    <span class="hljs-type">DocumentBuilder</span> <span class="hljs-variable">builder</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">switch</span> (args[<span class="hljs-number">2</span>]) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;pdf&quot;</span>  -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">PDFBuilder</span>();
        <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;html&quot;</span> -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlBuilder</span>();
        <span class="hljs-keyword">default</span>     -&gt; { System.exit(-<span class="hljs-number">1</span>); yield <span class="hljs-literal">null</span>; }
    }
    <span class="hljs-type">String</span> <span class="hljs-variable">markdown</span> <span class="hljs-operator">=</span> Files.readString(Path.of(args[<span class="hljs-number">0</span>]));
    <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MarkdownDirector</span>(builder).convert(markdown);
    Files.writeString(Path.of(args[<span class="hljs-number">1</span>]), result);
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="174" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="174" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Builder</h2>
<p>使用建造者模式的好处在于：</p>
<ol>
<li>分离<em>指导者</em>和<em>构建者</em>的具体实现。<em>指导者</em>无需关心具体结果对象的具体内部表示形式、实现方法和组成顺序。</li>
<li>提升模块化，有利于合作开发，也有利于快速定位错误。</li>
</ol>
<p>在以下情况使用建造者模式：</p>
<ol>
<li>复杂对象的创建<em>流程</em>和<em>具体内部实现、数据表示</em>是分离的</li>
</ol>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="175" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="175" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Builder</h2>
<p>Java内最知名的构建者实例就是<code>java.lang.StringBuilder</code>，它提供了构建大型字符串所需的所有方法：</p>
<ul>
<li><code>append(*)</code> <code>insert(int, *)</code> <code>replace(int, int, String)</code></li>
<li><code>length()</code> <code>charAt(int)</code> <code>substring(int, int)</code></li>
<li><code>toString()</code></li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="176" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="176" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Abstract Factory</h2>
<p>考虑IntelliJ IDEA和现在绝大多数GUI编辑器/IDE，它们都支持换主题皮肤的功能。我们可以为每一套皮肤都提供一整套GUI实现，但是显然这个工作量就过大了。</p>
<p>我们发现，GUI一般都由一些基本的元素组成，如按钮、菜单、文本框、文本区等。这些基本元素被称为<em>组件 Widget</em>。它们可能会有不同的渲染实现，但是GUI的布局总是相同的。因此我们可以分离这两者。</p>
<p>不同的皮肤实际上是提供了不同实现的组件的类，这个类被称为<em>抽象工厂 Abstract Factory</em>。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="177" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="177" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Abstract Factory</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Button</span>    { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">class</span> <span class="hljs-title class_">TextField</span> { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">class</span> <span class="hljs-title class_">TextArea</span>  { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Toolbar</span>   { <span class="hljs-comment">/* ... */</span> }

<span class="hljs-comment">// Abstract Factory</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Theme</span> {
    Button    <span class="hljs-title function_">createButton</span><span class="hljs-params">()</span>;
    TextField <span class="hljs-title function_">createTextField</span><span class="hljs-params">()</span>;
    TextArea  <span class="hljs-title function_">createTextArea</span><span class="hljs-params">()</span>;
    Toolbar   <span class="hljs-title function_">createToolbar</span><span class="hljs-params">()</span>;
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="178" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="178" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Abstract Factory</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DarkButton</span>    <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Button</span>    { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">class</span> <span class="hljs-title class_">DarkTextField</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">TextField</span> { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">class</span> <span class="hljs-title class_">DarkTextArea</span>  <span class="hljs-keyword">extends</span> <span class="hljs-title class_">TextArea</span>  { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">class</span> <span class="hljs-title class_">DarkToolbar</span>   <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Toolbar</span>   { <span class="hljs-comment">/* ... */</span> }

<span class="hljs-keyword">class</span> <span class="hljs-title class_">DarkTheme</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Theme</span> {
    <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> Button    <span class="hljs-title function_">createButton</span><span class="hljs-params">()</span>    { <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DarkButton</span>(); }
    <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> TextField <span class="hljs-title function_">createTextField</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DarkTextField</span>(); }
    <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> TextArea  <span class="hljs-title function_">createTextArea</span><span class="hljs-params">()</span>  { <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DarkTextArea</span>(); }
    <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> Toolbar   <span class="hljs-title function_">createToolbar</span><span class="hljs-params">()</span>   { <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DarkToolbar</span>(); }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="179" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="179" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Abstract Factory</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LightButton</span>    <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Button</span>    { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">class</span> <span class="hljs-title class_">LightTextField</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">TextField</span> { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">class</span> <span class="hljs-title class_">LightTextArea</span>  <span class="hljs-keyword">extends</span> <span class="hljs-title class_">TextArea</span>  { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">class</span> <span class="hljs-title class_">LightToolbar</span>   <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Toolbar</span>   { <span class="hljs-comment">/* ... */</span> }

<span class="hljs-keyword">class</span> <span class="hljs-title class_">LightTheme</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Theme</span> {
    <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> Button    <span class="hljs-title function_">createButton</span><span class="hljs-params">()</span>    { <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LightButton</span>(); }
    <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> TextField <span class="hljs-title function_">createTextField</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LightTextField</span>(); }
    <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> TextArea  <span class="hljs-title function_">createTextArea</span><span class="hljs-params">()</span>  { <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LightTextArea</span>(); }
    <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> Toolbar   <span class="hljs-title function_">createToolbar</span><span class="hljs-params">()</span>   { <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LightToolbar</span>(); }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="180" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="180" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Abstract Factory</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">GUI</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Theme theme;
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">GUI</span><span class="hljs-params">(Theme theme)</span> {
        <span class="hljs-built_in">this</span>.theme = theme;
        build();
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">build</span><span class="hljs-params">()</span> {
        <span class="hljs-type">var</span> <span class="hljs-variable">btn1</span> <span class="hljs-operator">=</span> theme.createButton();
        btn1.setGeometry(<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">30</span>, <span class="hljs-number">10</span>);
        btn1.setText(<span class="hljs-string">&quot;This is a button&quot;</span>);
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="181" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="181" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Abstract Factory</h2>
<p>应用抽象工厂模式可以：</p>
<ol>
<li>隔离具体实现类。</li>
<li>更换具体实现类的家族，并保证这些实现类的行为一致性。</li>
</ol>
<p>应当使用抽象工厂模式，当：</p>
<ol>
<li>你的系统和它所以依赖的组件的创建、组合和内部表示是独立的</li>
<li>你的系统需要更换组件家族，而组件家族被设计为需要一起使用</li>
</ol>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="182" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="182" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Abstract Factory</h2>
<p>Java Swing是Java提供的跨平台GUI库，它就提供了和我们例子很类似的更换主题，或者叫*Java Swing Look&amp;Feel (L&amp;F)*的功能，这是抽象工厂模式的最经典例子。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="183" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="183" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Factory Method</h2>
<p>考虑一个需要数据库连接的应用。对不同数据库的连接是由不同类来实现和处理的，但是具体的数据库类型一般不是编译期决定的，而是由运行时的配置文件等控制。</p>
<p>通过<em>工厂方法 Factory Method</em>，可以将创建具体数据库连接的责任转移给工厂方法内部。其得名，就是因为它负责“制造”对象，就如同一个工厂一样。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="184" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="184" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Factory Method</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">DatabaseConnection</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">open</span><span class="hljs-params">()</span>;
    Result <span class="hljs-title function_">executeSQL</span><span class="hljs-params">(String sql)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MySqlConnection</span>    <span class="hljs-keyword">implements</span> <span class="hljs-title class_">DatabaseConnection</span> { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SqliteConnection</span>   <span class="hljs-keyword">implements</span> <span class="hljs-title class_">DatabaseConnection</span> { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PostgresConnection</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">DatabaseConnection</span> { <span class="hljs-comment">/* ... */</span> }
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="185" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="185" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Factory Method</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DatabaseConnectionFactory</span> {
    <span class="hljs-keyword">private</span> String type;
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">DatabaseConnectionFactory</span><span class="hljs-params">(String type)</span> { <span class="hljs-built_in">this</span>.type == type; }

    <span class="hljs-keyword">public</span> DatabaseConnection <span class="hljs-title function_">createConnection</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">switch</span>(type) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;mysql&quot;</span>    -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">MySqlConnection</span>();
            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;sqlite&quot;</span>   -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">SqliteConnection</span>();
            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;postgres&quot;</span> -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">PostgresConnection</span>();
            <span class="hljs-keyword">default</span>         -&gt; <span class="hljs-literal">null</span>;
        }
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="186" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="186" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Factory Method</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
    <span class="hljs-type">var</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DatabaseConnectionFactory</span>(args[<span class="hljs-number">0</span>]);
    <span class="hljs-type">var</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> factory.createConnection();
    conn.open();
    conn.executeSQL(<span class="hljs-string">&quot;SELECT * FROM user&quot;</span>);
    conn.close();
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="187" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="187" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Factory Method</h2>
<p>工厂方法通常也可以是静态的<code>static</code>：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DatabaseConnectionFactory</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> DatabaseConnection <span class="hljs-title function_">createConnection</span><span class="hljs-params">(String type)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">switch</span>(type) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;mysql&quot;</span>    -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">MySqlConnection</span>();
            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;sqlite&quot;</span>   -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">SqliteConnection</span>();
            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;postgres&quot;</span> -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">PostgresConnection</span>();
            <span class="hljs-keyword">default</span>         -&gt; <span class="hljs-literal">null</span>;
        }
    }
}
<span class="hljs-type">var</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> DatabaseConnectionFactory.createConnection(args[<span class="hljs-number">0</span>]);
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="188" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="188" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Factory Method</h2>
<p>工厂方法是Java中应用最广泛的设计模式之一。</p>
<ol>
<li>消除对具体实现类的编译期绑定，进而强化了面向接口编程</li>
<li>工厂方法实际上和构造器的功能非常相似，这个设计模式有时还被称作<em>虚拟构造器 virtual constructor</em>。工厂方法命名和语法都更加自由，可以作为更灵活、语义更明显的构造器使用。</li>
</ol>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="189" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="189" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Factory Method</h2>
<p>Java中工厂方法的应用随处可见：</p>
<ul>
<li>各个接口中的<code>of</code>系列静态方法几乎都是静态工厂方法：
<ul>
<li><code>Set.of(...)</code> <code>Map.of(...)</code> <code>List.of(...)</code></li>
<li><code>Year.of()</code> <code>Mouth.of()</code> <code>DayOfWeek.of()</code></li>
<li><code>Path.of()</code></li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="190" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="190" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Factory Method</h2>
<p>Java中工厂方法的应用随处可见：</p>
<ul>
<li><code>java.util.concurrent.Executors</code>提供了若干工厂方法来实例化满足不同线程调度需求的执行器实现</li>
<li><code>java.sql.DriverManager</code>是Java标准库对本节例子的具体体现
<ul>
<li><code>java.sql.DriverManager#getConnection(String url)</code>通过解析url中的协议名，自动在类路径中寻找符合要求的数据库驱动类，然后通过数据库驱动建立连接</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="191" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="191" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Singleton</h2>
<p><em>单例 Singleton</em>模式说明某些类只应当存在一个实例。比如OS只应该有一个窗口管理球，也只应该有一个（逻辑上的）文件系统。对Java程序来说，Java运行时环境也应该是唯一的。事实也是如此，<code>java.lang.Runtime</code>类的确是一个单例，需要使用<code>java.lang.Runtime#getRuntime()</code>获取这个对象。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="192" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="192" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Singleton</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Singleton</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> INSTANCE;                 <span class="hljs-comment">// 1.</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title function_">Singleton</span><span class="hljs-params">()</span> { <span class="hljs-comment">/* ... */</span> }        <span class="hljs-comment">// 2.</span>

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Singleton <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> {  <span class="hljs-comment">// 3.</span>
        <span class="hljs-keyword">if</span>(INSTANCE == <span class="hljs-literal">null</span>) {               <span class="hljs-comment">// 4.</span>
            INSTANCE = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Singleton</span>();
        }
        <span class="hljs-keyword">return</span> INSTANCE;
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="193" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="193" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Creational Patterns</h1>
<h2>Singleton</h2>
<ol>
<li>用私有静态成员域保存单例对象</li>
<li>将构造器设置为私有的<em>private</em>，这可以防止他人新建其他的对象来破坏单例</li>
<li>如果单例需要在并发环境下使用，可以加入<code>synchronized</code>关键字来保证这个函数同时只能有一个线程进入执行</li>
<li>一般采用<em>懒初始化</em>的方法，在真正需要单例的时候再创建。</li>
</ol>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="194" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="194" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Catalog</h2>
<p>结构化模式告诉我们如何组织、重用不同的类：</p>
<ol>
<li><em>Adapter</em> 适配器模式</li>
<li><em>Decorator</em> 装饰器模式</li>
<li><em>Flyweight</em> 享元模式</li>
<li><em>Proxy</em> 代理模式</li>
</ol>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="195" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="195" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Adapter</h2>
<p><em>适配器 Adapter</em>模式，顾名思义，是通过<em>Adapter</em>类将两个不兼容的接口连接到一起，如下面的例子：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">AppleLightning</span> { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">UsbTypeC</span>       { <span class="hljs-comment">/* ... */</span> }

<span class="hljs-keyword">class</span> <span class="hljs-title class_">TypeC2Lightning</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">AppleLightning</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> UsbTypeC usb;
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">TypeC2Lightning</span><span class="hljs-params">(UsbTypeC usb)</span> { <span class="hljs-built_in">this</span>.usb = usb; }
    <span class="hljs-comment">// Lightning methods</span>
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="196" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="196" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Adapter</h2>
<p>Java标准库中最常用的适配器，就是连接<code>Reader</code> <code>Writer</code>与<code>InputStream</code> <code>OutputStream</code>的<code>InputStreamReader</code> <code>OutputStreamWriter</code></p>
<ul>
<li><code>Reader</code> <code>Writer</code>：用于读取<strong>字符流</strong></li>
<li><code>InputStream</code> <code>OutputStream</code>：用于读取<strong>字节流</strong></li>
<li><code>InputStreamReader</code> <code>OutputStreamWriter</code>：适配器类，用于处理原始<strong>字节流</strong>，通过字符集编码等信息转化为<strong>字符流</strong></li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="197" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="197" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Adapter</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-type">var</span> <span class="hljs-variable">fileInput</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">&quot;input.txt&quot;</span>);
<span class="hljs-type">var</span> <span class="hljs-variable">fileReader</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InputStreamReader</span>(fileInput, <span class="hljs-string">&quot;UTF-8&quot;</span>);
<span class="hljs-type">var</span> <span class="hljs-variable">charBuf</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">char</span>[<span class="hljs-number">100</span>];
<span class="hljs-type">var</span> <span class="hljs-variable">charCount</span> <span class="hljs-operator">=</span> fileReader.read(charBuf, <span class="hljs-number">0</span>, <span class="hljs-number">100</span>);
<span class="hljs-type">var</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(charBuf);
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="198" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="198" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Adapter</h2>
<p>适配器模式的使用场景比较明显，写法也比较直接，因此介绍的篇幅较短。但是要注意，请不要滥用适配器，否则会对类型系统带来混乱，增加无用代码的数量。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="199" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="199" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Decorator</h2>
<p><em>装饰器 Decorator</em>模式相信大家都已经很熟悉了，大家的python课程应该讲过python对装饰器函数的语法支持。装饰器和适配器都是<em>包装</em>对象的模式，但是装饰器的重要区别在于，它是将接口包装到<em>同一个</em>接口，只不过装饰上增强的功能性。而适配器是包装为另一个不兼容的接口。</p>
<p>考虑VSCode的代码区，是在最朴素的文本区上，加入了缩略图、滚动条等组件，而且缩略图这种组件实际上在配置中是可以移除的。需要添加额外功能并支持动态添加/移除时，就应当使用装饰器模式。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="200" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="200" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Decorator</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Component</span> { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">class</span> <span class="hljs-title class_">TextArea</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Component</span> { <span class="hljs-comment">/* ... */</span> }

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ThumbnailDecorator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">TextArea</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> TextArea internal;
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ThumbnailDecorator</span><span class="hljs-params">(TextArea textArea)</span> { internal = textArea;}
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ScrollBarDecorator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Component</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Component internal;
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ScrollBarDecorator</span><span class="hljs-params">(Component comp)</span> { internal = comp;}
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="201" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="201" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Decorator</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">GUIFactory</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Component <span class="hljs-title function_">createCodeArea</span><span class="hljs-params">(<span class="hljs-type">boolean</span> enableThumbnail)</span> {
        <span class="hljs-type">var</span> <span class="hljs-variable">textArea</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextArea</span>();
        <span class="hljs-keyword">return</span> enableThumbnail ? <span class="hljs-keyword">new</span> <span class="hljs-title class_">ScrollBarDecorator</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ThumbnailDecorator</span>(textArea))
                               : <span class="hljs-keyword">new</span> <span class="hljs-title class_">ScrollBarDecorator</span>(textArea);
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="202" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="202" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Decorator</h2>
<p><code>java.io</code>包的设计处处体现了装饰器模式。我们以输入流为例：</p>
<ul>
<li><code>java.io.InputStream</code> 是通用的基类，基本功能就是<code>read</code>读取一个字节或者字节数组</li>
<li>终端流，即真正产生数据的流：
<ul>
<li><code>java.io.ByteArrayInputStream</code> 从字节数组中读</li>
<li><code>java.io.FileInputStream</code> 从文件中读</li>
<li><code>java.io.PipedInputStream</code> 从连接到的另一个输出流中读</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="203" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="203" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Decorator</h2>
<p><code>java.io</code>包的设计处处体现了装饰器模式。我们以输入流为例：</p>
<ul>
<li>装饰器流，即为现有流添加额外功能的流：
<ul>
<li><code>java.io.BufferedInputStream</code> 为现有流加个缓冲区以提升性能</li>
<li><code>java.util.zip.CheckedInputStream</code> 边读边算CRC32等校验码</li>
<li><code>java.util.zip.Inflater/DeflaterInputStream</code> 解压缩/压缩原始数据</li>
<li><code>java.security.DigestInputStream</code> 边读边算MD5/SHA-1等消息摘要</li>
<li><code>javax.crypto.CipherInputStream</code> 将原始数据通过AES/RSA等密钥算法加密/解密</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="204" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="204" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Decorator</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-type">var</span> <span class="hljs-variable">fileInput</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">&quot;data.gzip&quot;</span>);
<span class="hljs-type">var</span> <span class="hljs-variable">checkedInput</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CheckedInputStream</span>(fileInput, <span class="hljs-keyword">new</span> <span class="hljs-title class_">CRC32</span>());
<span class="hljs-type">var</span> <span class="hljs-variable">gzipInput</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">GZIPInputStream</span>(checkedInput);

<span class="hljs-type">var</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> gzipInput.readAllBytes();
<span class="hljs-type">var</span> <span class="hljs-variable">checksum</span> <span class="hljs-operator">=</span> checkedInput.getChecksum().getValue();
<span class="hljs-keyword">assert</span>(checksum == <span class="hljs-number">1234567890L</span>);
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="205" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="205" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Decorator</h2>
<p>装饰器模式带来的好处有：</p>
<ol>
<li>保证<em>单一职责原则</em>。可以看到，上面我介绍的一大堆输入流子类都可以用简短的一句话描述它们的全部功能。</li>
<li>提供比继承更多的灵活性。我们可以任意组合装饰器流来加任何我们想使用的功能。</li>
</ol>
<p>但是也有一些小缺点需要注意：</p>
<ol>
<li>可能会留下一大堆散件，比如获取校验码你仍然需要保留<code>checkedInput</code></li>
</ol>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="206" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="206" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Flyweight</h2>
<p>考虑Minecraft，一个（最初）使用Java编写的、全球最知名的沙盒游戏之一。Minecraft的地形由一大堆方块组成，而这些方块都带有自己的数据，比如位置、方向、材质、碰撞箱、变种与其他信息（如铁砧损坏程度等）。我们很容易给出下面的简单设计：</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="207" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="207" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Flyweight</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Block</span> {
    <span class="hljs-keyword">protected</span> <span class="hljs-type">int</span> x, y, z, facing;
    <span class="hljs-keyword">protected</span> <span class="hljs-type">int</span> hardness, toolLevel, resistance;
    <span class="hljs-keyword">protected</span> Image texture;
    <span class="hljs-keyword">protected</span> AABB aabb;
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Block</span><span class="hljs-params">( <span class="hljs-comment">/* ... */</span> )</span> { <span class="hljs-comment">/* ... */</span> }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onTick</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClick</span><span class="hljs-params">(Player player, <span class="hljs-type">int</span> button)</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onDestroy</span><span class="hljs-params">(Entity destroyer)</span>;
    <span class="hljs-comment">// ...</span>
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="208" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="208" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Flyweight</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LogBlock</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Block</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> woodType;
    <span class="hljs-comment">// Implementation of abstract methods ...</span>
}
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AnvilBlock</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Block</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> damageType;
    <span class="hljs-comment">// Implementation of abstract methods ...</span>
}
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Cobblestone</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Block</span> { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Bedrock</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Block</span> { <span class="hljs-comment">/* ... */</span> }
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="209" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="209" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Flyweight</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">World</span> {
    <span class="hljs-keyword">private</span> List&lt;Block&gt; blocks = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Block&gt;();
    
    Block <span class="hljs-title function_">getBlockAt</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y, <span class="hljs-type">int</span> y)</span> {
        <span class="hljs-comment">// ...</span>
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="210" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="210" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Flyweight</h2>
<p>但是这种方法显然存在较大的性能问题：</p>
<p>有很多数据对于相同种类的方块都是重复的，没有必要每个位置都单独存一遍。对于Minecraft这种，世界大小上限约为<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.05ex;" xmlns="http://www.w3.org/2000/svg" width="23.219ex" height="2.005ex" role="img" focusable="false" viewBox="0 -864 10262.9 886"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path></g><g data-mml-node="mo" transform="translate(722.2,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="msup" transform="translate(1722.4,0)"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)"></path></g><g data-mml-node="mn" transform="translate(1033,393.1) scale(0.707)"><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path></g></g><g data-mml-node="mo" transform="translate(3381.2,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mn" transform="translate(4381.4,0)"><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path></g><g data-mml-node="mo" transform="translate(5103.7,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="msup" transform="translate(6103.9,0)"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)"></path></g><g data-mml-node="mn" transform="translate(1033,393.1) scale(0.707)"><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path></g></g><g data-mml-node="mo" transform="translate(7762.7,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mn" transform="translate(8762.9,0)"><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1000,0)"></path></g></g></g></svg></mjx-container>个<code>Block</code>的巨型对象，这些重复数据对于内存和硬盘空间来说都是不可接受的。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="211" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="211" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Flyweight</h2>
<p>我们可以通过分离重复的数据和不重复的数据，或称为<em>固有状态 intrinsic</em>和<em>外围状态 extrinsic</em>，通过分离存储两种状态的对象，来减少运行时内存占用。比如，方块的材质、硬度、爆炸抗性等信息是固有状态，方块的位置、朝向等信息是外围状态。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="212" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="212" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Flyweight</h2>
<p>为了区分外围状态，一种方法是为方块的更新或事件处理函数加入外围状态参数：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Block</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onTick</span><span class="hljs-params">(ExtrinsicBlockState states)</span>;
    <span class="hljs-comment">// ...</span>
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="213" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="213" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Flyweight</h2>
<p>另一种方式是直接为外围状态添加公开的<code>set</code>方法：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Block</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">setX</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> { <span class="hljs-built_in">this</span>.x = x; }
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">setY</span><span class="hljs-params">(<span class="hljs-type">int</span> y)</span> { <span class="hljs-built_in">this</span>.y = y; }
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">setZ</span><span class="hljs-params">(<span class="hljs-type">int</span> z)</span> { <span class="hljs-built_in">this</span>.z = z; }
    <span class="hljs-comment">// ...</span>
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="214" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="214" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Flyweight</h2>
<p>然后通过工厂类和享元对象池等技术储存、构建不同固有状态的方块的享元：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BlockFactory</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Block <span class="hljs-title function_">createBlockInstance</span><span class="hljs-params">(<span class="hljs-type">int</span> blockId)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">switch</span>(blockId) {
            <span class="hljs-keyword">case</span> <span class="hljs-number">0</span> -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cobblestone</span>();
            <span class="hljs-keyword">case</span> <span class="hljs-number">1</span> -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">AnvilBlock</span>();
            <span class="hljs-comment">// ...</span>
        }
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="215" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="215" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Flyweight</h2>
<p>然后通过工厂类和享元对象池等技术储存、构建不同固有状态的方块的享元：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BlockFactory</span> {
    <span class="hljs-keyword">private</span> Map&lt;Integer, Block&gt; blockPool = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
    <span class="hljs-keyword">public</span> Block <span class="hljs-title function_">getBlockInstance</span><span class="hljs-params">(<span class="hljs-type">int</span> blockId)</span> {
        <span class="hljs-keyword">return</span> blockPool.computeIfAbsent(
            blockId,
            BlockFactory::createBlockInstance
        );
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="216" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="216" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Flyweight</h2>
<p>这样，<code>World</code>就不需要存储整个<code>Block</code>了，而只需要<code>blockId</code>指定享元对象，并在具体操作之前设置外围状态即可。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="217" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="217" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Flyweight</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">World</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span>[] blocks;
    <span class="hljs-keyword">private</span> <span class="hljs-type">BlockFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BlockFactory</span>();
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">tick</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// for xyz...</span>
            <span class="hljs-type">var</span> <span class="hljs-variable">block</span> <span class="hljs-operator">=</span> factory.getBlockInstance(blocks[idx]);
            block.setX(x); block.setY(y); block.setZ(z);
            block.onTick();
        <span class="hljs-comment">// end for</span>
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="218" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="218" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Flyweight</h2>
<p>Java中的享元实例是基本整数数据类型的包装类的<code>valueOf</code>方法：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Integer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Number</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Comparable</span>&lt;Integer&gt;, Constable, ConstantDesc {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IntegerCache</span> {
        <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Integer[] cache;
    }

    <span class="hljs-meta">@IntrinsicCandidate</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Integer <span class="hljs-title function_">valueOf</span><span class="hljs-params">(<span class="hljs-type">int</span> i)</span> {
        <span class="hljs-keyword">if</span> (i &gt;= IntegerCache.low &amp;&amp; i &lt;= IntegerCache.high)
            <span class="hljs-keyword">return</span> IntegerCache.cache[i + (-IntegerCache.low)];
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>(i);
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="219" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="219" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Flyweight</h2>
<p>如果基本类型的值在缓存范围内，就返回缓存的对象引用。对于<code>Integer</code>，根据Java语言规范，默认缓存<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="10.811ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 4778.7 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path></g><g data-mml-node="mo" transform="translate(278,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(1056,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" transform="translate(500,0)"></path><path data-c="38" d="M70 417T70 494T124 618T248 666Q319 666 374 624T429 515Q429 485 418 459T392 417T361 389T335 371T324 363L338 354Q352 344 366 334T382 323Q457 264 457 174Q457 95 399 37T249 -22Q159 -22 101 29T43 155Q43 263 172 335L154 348Q133 361 127 368Q70 417 70 494ZM286 386L292 390Q298 394 301 396T311 403T323 413T334 425T345 438T355 454T364 471T369 491T371 513Q371 556 342 586T275 624Q268 625 242 625Q201 625 165 599T128 534Q128 511 141 492T167 463T217 431Q224 426 228 424L286 386ZM250 21Q308 21 350 55T392 137Q392 154 387 169T375 194T353 216T330 234T301 253T274 270Q260 279 244 289T218 306L210 311Q204 311 181 294T133 239T107 157Q107 98 150 60T250 21Z" transform="translate(1000,0)"></path></g><g data-mml-node="mo" transform="translate(2556,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mn" transform="translate(3000.7,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" transform="translate(500,0)"></path><path data-c="37" d="M55 458Q56 460 72 567L88 674Q88 676 108 676H128V672Q128 662 143 655T195 646T364 644H485V605L417 512Q408 500 387 472T360 435T339 403T319 367T305 330T292 284T284 230T278 162T275 80Q275 66 275 52T274 28V19Q270 2 255 -10T221 -22Q210 -22 200 -19T179 0T168 40Q168 198 265 368Q285 400 349 489L395 552H302Q128 552 119 546Q113 543 108 522T98 479L95 458V455H55V458Z" transform="translate(1000,0)"></path></g><g data-mml-node="mo" transform="translate(4500.7,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path></g></g></g></svg></mjx-container>的整数。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="220" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="220" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Proxy</h2>
<p>考虑远程过程调用（Remote Procedure Call, RPC），我们需要在本地调用远程代码。但是显然我们不可能<code>new</code>一个远程对象，我们不知道它具体的实现，更不知道怎么管理别的机器的内存。这时我们就需要一个<em>代理 Proxy</em>类作为本地的占位符，代替本地代码发送远程过程调用请求。这样我们可以和具体实现解耦合，甚至可以无缝在本地实现和远程代码实现之间转换。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="221" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="221" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Proxy</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserInfoRepo</span> {
    List&lt;String&gt; <span class="hljs-title function_">getAllUserName</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">RPCUserInfoRepo</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">UserInfoRepo</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String httpEndpoint;
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">RPCUserInfoRepo</span><span class="hljs-params">(String endpoint)</span> { httpEndpoint = endpoint; }
    <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title function_">getAllUserName</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// 1. Send HTTP Request</span>
        <span class="hljs-comment">// 2. Parse JSON Result</span>
        <span class="hljs-comment">// 3. Return List&lt;String&gt;</span>
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="222" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="222" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Proxy</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserInfoRepo</span> {
    List&lt;String&gt; <span class="hljs-title function_">getAllUserName</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">DBUserInfoRepo</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">UserInfoRepo</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Connection db;
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">DBUserInfoRepo</span><span class="hljs-params">(Connection db)</span> { <span class="hljs-built_in">this</span>.db = db; }
    <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title function_">getAllUserName</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// 1. sql: SELECT name FROM user</span>
        <span class="hljs-comment">// 2. Return List&lt;String&gt;</span>
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="223" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="223" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Proxy</h2>
<p>但是真正让代理模式在Java发光发热的是<em>真正的动态性</em>。Java允许在运行时改变字节码，创造新的类，换句话说，<em>运行时编译代码</em>。比如上例中的<code>RPCUserInfoRepo</code>和<code>DBUserInfoRepo</code>都不需要我们手动编写，我们只要声明：我们需要使用一个用户信息仓库，支持框架会自动生成、创建实现类并实例化对象供我们使用。</p>
<p>我们这次使用<a href="https://spring.io/projects/spring-data-jpa"><strong>Spring Data JPA</strong></a>作为例子。<a href="https://spring.io/"><em>Spring</em></a>是Java最流行的后端框架的集合，<em>Spring Data</em>是其关系型数据库支持，<a href="https://jakarta.ee/specifications/persistence/3.0/"><em>JPA</em></a>是<em>Java/Jakarta Persistence API</em>的缩写，是持久化层的API描述。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="224" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="224" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Proxy</h2>
<p>我们声明一个<code>User</code>类：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> {
  <span class="hljs-meta">@Id</span>
  <span class="hljs-meta">@GeneratedValue(strategy=GenerationType.AUTO)</span>
  <span class="hljs-keyword">private</span> Long id;
  <span class="hljs-meta">@NonNull</span> <span class="hljs-keyword">private</span> String nickName;
  <span class="hljs-meta">@NonNull</span> <span class="hljs-keyword">private</span> String email;
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="225" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="225" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Proxy</h2>
<p>我们声明我们需要的数据仓库的接口，比如我们需要寻找对应昵称的所有用户：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-meta">@Repository</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserRepository</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">CrudRepository</span>&lt;User, Long&gt; {
    List&lt;User&gt; <span class="hljs-title function_">findAllByNickName</span><span class="hljs-params">(String nickName)</span>;
}
</code></pre>
<p><a href="https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/repository/CrudRepository.html"><em>CrudRepository</em></a> 也内置了大量常用函数，包括<code>findAll</code> <code>save</code> <code>delete</code> <code>count</code>等。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="226" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="226" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Proxy</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-meta">@SpringBootApplication</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AccessingDataJpaApplication</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        SpringApplication.run(AccessingDataJpaApplication.class);
    }
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> CommandLineRunner <span class="hljs-title function_">demo</span><span class="hljs-params">(UserRepository repo)</span> {
        <span class="hljs-keyword">return</span> (args) -&gt; {
            repo.save(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">&quot;xsun2001&quot;</span>, <span class="hljs-string">&quot;xcx19@mails.tsinghua.edu.cn&quot;</span>));
            <span class="hljs-type">var</span> <span class="hljs-variable">userList</span> <span class="hljs-operator">=</span> repo.findAll();
        };
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="227" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="227" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Proxy</h2>
<p>我们做了如下事情：</p>
<ol>
<li>定义了数据格式<code>User</code>类</li>
<li>定义了我们想要的查询、更新方法<code>UserRepository</code></li>
<li>直接使用<code>UserRepository</code>进行数据操作</li>
<li>让Spring启动程序</li>
</ol>
<p>但是Spring替我们做的事情包括但不限于：</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="228" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="228" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Proxy</h2>
<ol>
<li>自动发现<code>User</code>，根据<code>User</code>内部的注解和成员变量，自动生成数据库表生成语句，如有必要，自动合并、迁移、重整已有数据表中的数据</li>
<li>自动发现<code>UserRepository</code>，根据方法名称、参数、返回值等信息，自动解析生成SQL语句，自动处理数据库连接和SQL执行，自动组织数据库的执行结果，生成本节所说的<em>Proxy</em>类</li>
<li>自动发现<code>@Bean public CommandLineRunner demo(UserRepository repo)</code>，根据参数得知我们想要一个<code>UserRepository</code>实现，因此实例化代理类并注入。根据返回值类型判断需要运行返回结果。</li>
</ol>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="229" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="229" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Structural Patterns</h1>
<h2>Proxy</h2>
<p><em>动态代理</em>配合<em>依赖注入</em>是究极解耦合方案。因此Java自己也不知道实现代码到底放在哪里，直到真正需要的时候才会自动生成。</p>
<p>可以从<em>Spring Data JPA</em>的例子看到，我们只关心<em>接口</em>和<em>数据</em>的设计与使用，消除了我们手动操作、处理数据库的繁琐代码。</p>
<p>再加上依赖注入，我们甚至都没有<code>new</code>过任何相关的类，全都交给<em>Spring</em>处理。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="230" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="230" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Behavioral Patterns</h1>
<h2>Catalog</h2>
<p>行为模式告诉我们如何让系统中的对象协作：</p>
<ul>
<li><em>Template Method</em> 模版方法模式</li>
<li><em>Iterator</em> 迭代器模式</li>
<li><em>Visitor</em> 访问者模式</li>
<li><em>Strategy</em> 策略模式</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="231" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="231" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Behavioral Patterns</h1>
<h2>Catalog</h2>
<p>行为模式实际上还有很多，但是其中有些模式我认为只是把比较直观的做法赋予了个名字，没有本质上的提升。因此我挑选了几个最为常用、最有代表性的行为模式进行讲解。</p>
<p>行为模式描述的更多的是实现细节，因此后续描述时会直接介绍Java标准库中的例子而不介绍过于抽象的表达。<s>绝对不是我想偷懒！</s></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="232" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="232" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Behavioral Patterns</h1>
<h2>Template Method</h2>
<p><em>模版方法 Template Method</em>模式可以为方法比较多的接口提供一组共享的默认实现，来简化子类派生的过程。Java的集合框架也大量应用了这个模式，典型的命名特征是<code>Inter</code>接口和<code>AbstractInter</code>抽象类来提供模板实现。</p>
<p>比如<code>List</code>接口有27个需要实现的方法。但实际上，一个最简单的、不可变的列表只需要实现一个<code>get(int)</code>方法即可。这种列表实际上用途也非常广泛，比如在整个程序中传递支持的文件类型列表信息等。<code>AbstractList</code>就为这种用途提供了除了<code>get(int)</code>之外的所有接口的模版实现。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="233" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="233" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Behavioral Patterns</h1>
<h2>Template Method</h2>
<p><code>AbstractList&lt;E&gt;</code>为不同功能的列表提供了不同的重载方式：</p>
<ul>
<li>不可变的列表只需要实现<code>get(int)</code> <code>size()</code></li>
<li>可变的列表需要实现<code>get(int)</code> <code>set(int, E)</code></li>
<li>可以扩展大小的列表还应该实现<code>add(int, E)</code> <code>remove(int)</code></li>
</ul>
<p>其余的包括<code>addAll</code> <code>removeAll</code> <code>iterator</code> <code>subList</code> <code>contains</code>等其他方法全都可以由上述基本方法派生出来，并在模版方法里提供具体实现。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="234" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="234" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Behavioral Patterns</h1>
<h2>Iterator</h2>
<p><em>迭代器 Iterator</em>相信大家或多或少都听说过。<em>Iterator</em>提供了顺序访问一组<em>聚合</em>对象的通用方法，而无需关心内部存储实现，比如用数组还是用哈希表等。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="235" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="235" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Behavioral Patterns</h1>
<h2>Iterator</h2>
<p>Java集合框架提供了<code>java.util.Iterator</code>用于描述集合元素迭代器：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">package</span> java.util;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Iterator</span>&lt;E&gt; {
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasNext</span><span class="hljs-params">()</span>;
    E <span class="hljs-title function_">next</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">remove</span><span class="hljs-params">()</span> { <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnsupportedOperationException</span>(<span class="hljs-string">&quot;remove&quot;</span>); }
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">forEachRemaining</span><span class="hljs-params">(Consumer&lt;? <span class="hljs-built_in">super</span> E&gt; action)</span> {
        Objects.requireNonNull(action);
        <span class="hljs-keyword">while</span> (hasNext())
            action.accept(next());
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="236" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="236" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Behavioral Patterns</h1>
<h2>Iterator</h2>
<p>它的接口都很简洁明了：</p>
<ul>
<li><code>hasNext()</code> 是否还有下一个元素，如果有，</li>
<li><code>next()</code> 获取下一个元素</li>
<li><code>remove()</code> 删除当前元素。默认不支持删除。</li>
<li><code>forEachRemaining(Consumer&lt;? super E&gt; action)</code> 对后续所有元素应用<code>action</code></li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="237" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="237" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Behavioral Patterns</h1>
<h2>Iterator</h2>
<p><code>Iterator</code>的基本使用可以直接参考<code>forEachRemaining</code>的实现：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-type">var</span> <span class="hljs-variable">iter</span> <span class="hljs-operator">=</span> getIterator();
whiel(iter.hasNext()) {
    <span class="hljs-type">var</span> <span class="hljs-variable">obj</span> <span class="hljs-operator">=</span> iter.next();
    <span class="hljs-comment">// do something with obj</span>
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="238" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="238" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Behavioral Patterns</h1>
<h2>Iterator</h2>
<p><code>java.lang.Iterable&lt;T&gt;</code>接口描述了可以被迭代的聚合对象：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Iterable</span>&lt;T&gt; {
    Iterator&lt;T&gt; <span class="hljs-title function_">iterator</span><span class="hljs-params">()</span>;

    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">forEach</span><span class="hljs-params">(Consumer&lt;? <span class="hljs-built_in">super</span> T&gt; action)</span> {
        Objects.requireNonNull(action);
        <span class="hljs-keyword">for</span> (T t : <span class="hljs-built_in">this</span>) { action.accept(t); }
    }
    <span class="hljs-keyword">default</span> Spliterator&lt;T&gt; <span class="hljs-title function_">spliterator</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> Spliterators.spliteratorUnknownSize(iterator(), <span class="hljs-number">0</span>);
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="239" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="239" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Behavioral Patterns</h1>
<h2>Iterator</h2>
<ul>
<li><code>java.lang.Iterable&lt;T&gt;</code>只有一个接口函数：<code>iterator</code>，返回一个迭代器<code>Iterator&lt;T&gt;</code>。</li>
<li><code>forEach</code>方法的实现展现了<code>Iterable</code>的另一种用法
<ul>
<li>除了使用<code>iterator()</code>方法获取迭代器并按照常规方法访问，Java支持<em>for-each</em>循环来遍历可迭代对象：</li>
<li><code>for (T t : iterable) { /* do something with t */ }</code></li>
</ul>
</li>
<li><code>spliterator()</code>提供了<em>可并发的</em>迭代器实现</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="240" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="240" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Behavioral Patterns</h1>
<h2>Iterator</h2>
<p>Java集合框架和标准库的很多类都是可迭代的：</p>
<ul>
<li>集合框架本身就是元素的集合，因此自然都是可迭代的</li>
<li><code>java.nio.file.Path</code>是自身的可迭代对象，便于分离目录结构</li>
<li><code>java.nio.file.DirectoryStream&lt;T&gt;</code>是<code>T</code>的可迭代对象，用于获取目录下的所有文件和子目录信息</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="241" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="241" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Behavioral Patterns</h1>
<h2>Visitor</h2>
<p><em>访问者 Visitor</em>模式也是遍历一组对象所用的设计模式，但是与迭代器不同的是，访问者一般用于访问层次化、结构化对象，并且子对象的类型或者处理方式可能不同。最经典的例子就是文件目录访问者：<code>java.nio.file.FileVisitor</code></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="242" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="242" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Behavioral Patterns</h1>
<h2>Visitor</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">package</span> java.nio.file;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">FileVisitor</span>&lt;T&gt; {
    FileVisitResult <span class="hljs-title function_">preVisitDirectory</span><span class="hljs-params">(T dir, BasicFileAttributes attrs)</span>
        <span class="hljs-keyword">throws</span> IOException;   <span class="hljs-comment">// 进入目录之前</span>
    FileVisitResult <span class="hljs-title function_">visitFile</span><span class="hljs-params">(T file, BasicFileAttributes attrs)</span>
        <span class="hljs-keyword">throws</span> IOException;   <span class="hljs-comment">// 处理文件</span>
    FileVisitResult <span class="hljs-title function_">visitFileFailed</span><span class="hljs-params">(T file, IOException exc)</span>
        <span class="hljs-keyword">throws</span> IOException;   <span class="hljs-comment">// 处理文件错误</span>
    FileVisitResult <span class="hljs-title function_">postVisitDirectory</span><span class="hljs-params">(T dir, IOException exc)</span>
        <span class="hljs-keyword">throws</span> IOException;   <span class="hljs-comment">// 目录遍历完成</span>
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="243" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="243" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Behavioral Patterns</h1>
<h2>Visitor</h2>
<p><code>FileVisitResult</code>是一个枚举类型，用于控制后续访问目录的过程，比如继续遍历文件，或者在找到所需要的文件后退出等等：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">package</span> java.nio.file;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">FileVisitResult</span> {
    CONTINUE,      <span class="hljs-comment">// 继续遍历</span>
    TERMINATE,     <span class="hljs-comment">// 终止遍历</span>
    SKIP_SUBTREE,  <span class="hljs-comment">// 继续遍历，但是跳过子目录下的所有文件/目录</span>
    SKIP_SIBLINGS; <span class="hljs-comment">// 继续遍历，但是跳过同目录下的其他文件/目录</span>
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="244" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="244" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Behavioral Patterns</h1>
<h2>Visitor</h2>
<p>有时我们可能只需要某个方法的实现，这时就是<em>模版方法</em>体现作用的时候了。Java提供了<code>java.nio.file.SimpleFileVisitor&lt;T&gt;</code>作为<code>FileVisitor&lt;T&gt;</code>的空实现。实现的方式大概是没有错误的时候就<code>CONTINUE</code>，有异常就抛出异常终止整个过程。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="245" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="245" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Behavioral Patterns</h1>
<h2>Visitor</h2>
<p>使用<code>java.nio.file.Files#walkFileTree</code>遍历文件树：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-type">var</span> <span class="hljs-variable">start</span> <span class="hljs-operator">=</span> Path.of(<span class="hljs-string">&quot;.&quot;</span>);

Files.walkFileTree(start, <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleFileVisitor</span>&lt;Path&gt;() {
    <span class="hljs-comment">// ... Implementations</span>
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="246" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="246" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Behavioral Patterns</h1>
<h2>Visitor</h2>
<p>比如我们来统计目录下java源代码文件的数量，就可以：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">FileCounter</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Path</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">SimpleFileVisitor</span>&lt;T&gt; {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getCount</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> count; }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String ext;
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">FileCounter</span><span class="hljs-params">(String ext)</span> { <span class="hljs-built_in">this</span>.ext = ext; }

    <span class="hljs-comment">// ...</span>
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="247" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="247" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Behavioral Patterns</h1>
<h2>Visitor</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">FileCounter</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Path</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">SimpleFileVisitor</span>&lt;T&gt; {
    <span class="hljs-comment">// ...</span>

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> FileVisitResult <span class="hljs-title function_">visitFile</span><span class="hljs-params">(T file, BasicFileAttributes attrs)</span> <span class="hljs-keyword">throws</span> IOException {
        <span class="hljs-keyword">if</span> (file.endsWith(ext)) ++count;
        <span class="hljs-keyword">return</span> FileVisitResult.CONTINUE;
    }
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> FileVisitResult <span class="hljs-title function_">visitFileFailed</span><span class="hljs-params">(T file, IOException exc)</span> <span class="hljs-keyword">throws</span> IOException
        { <span class="hljs-keyword">return</span> FileVisitResult.CONTINUE; }
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> FileVisitResult <span class="hljs-title function_">postVisitDirectory</span><span class="hljs-params">(T dir, IOException exc)</span> <span class="hljs-keyword">throws</span> IOException
        { <span class="hljs-keyword">return</span> FileVisitResult.CONTINUE; }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="248" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="248" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Behavioral Patterns</h1>
<h2>Visitor</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException{
    <span class="hljs-type">var</span> <span class="hljs-variable">visitor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileCounter</span>&lt;Path&gt;(args[<span class="hljs-number">1</span>]);

    Files.walkFileTree(Path.of(args[<span class="hljs-number">0</span>]), visitor);

    System.out.println(
        <span class="hljs-string">&quot;Counts of &quot;</span> + args[<span class="hljs-number">1</span>] + <span class="hljs-string">&quot; file in &quot;</span> + args[<span class="hljs-number">0</span>] + <span class="hljs-string">&quot; = &quot;</span> + visitor.getCount()
    );
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="249" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="249" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Behavioral Patterns</h1>
<h2>Strategy</h2>
<p>一个功能可能有多种不同的算法实现。抽象出<em>算法</em>实例的模式称为<em>策略 Strategy</em>模式。<em>Strategy</em>可以在运行时调配不同的算法实现，这对使用功能的客户端来说是无缝的。这个模式最经典的例子是对数组排序使用的不同<em>排序器 Comparator</em>。</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-meta">@FunctionalInterface</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Comparator</span>&lt;T&gt; {
    <span class="hljs-type">int</span> <span class="hljs-title function_">compare</span><span class="hljs-params">(T o1, T o2)</span>;
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="250" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="250" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Behavioral Patterns</h1>
<h2>Strategy</h2>
<p>比如我们要根据用户的年龄进行排序，可以定义这样的排序器：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-meta">@Data</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> {
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserComparator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Comparator</span>&lt;User&gt; {
    <span class="hljs-type">int</span> <span class="hljs-title function_">compare</span><span class="hljs-params">(User o1, User o2)</span> {
        <span class="hljs-keyword">return</span> Integer.compare(o1.getAge(), o2.getAge());
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="251" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="251" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Behavioral Patterns</h1>
<h2>Strategy</h2>
<p>使用<code>Arrays#sort</code>排序数组，使用<code>Collections#sort</code>排序列表。它们均可以接受一个排序器作为第二个参数：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">User[] userArray = fetchUsers();

Arrays.sort(userArray, <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserComparator</span>());
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="252" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="252" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Behavioral Patterns</h1>
<h2>Strategy</h2>
<p>有同学可能发现了，<code>Comparator</code>是一个<em>函数式接口</em><code>@FunctionalInterface</code>，因此可以使用Lambda表达式：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">Arrays.sort(
    userArray,
    (<span class="hljs-keyword">var</span> o1, <span class="hljs-keyword">var</span> o2) -&gt; Integer.compare(o1.getAge(), o2.getAge())
);
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="253" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="253" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Behavioral Patterns</h1>
<h2>Strategy</h2>
<p><code>Comparator</code>还提供了一些工厂方法，用于产生各种各样的比较器实现：</p>
<ul>
<li><code>reversed()</code>：创建当前比较器的反转版</li>
<li><code>thenComparing()</code>系列：当前比较器如果相等，那么再用提供的比较器或键值比较</li>
<li><code>comparing()</code>系列：提取对象中的某个键进行比较</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="254" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="254" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Behavioral Patterns</h1>
<h2>Strategy</h2>
<p>比如我们要提供一个先根据年龄排序，再根据名字的长度排序，长度相同的忽略大小写进行排序的比较器，我们可以使用：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-type">var</span> <span class="hljs-variable">comparator</span> <span class="hljs-operator">=</span> Comparator&lt;User&gt;
        .comparingInt(User::getAge)
        .thenComparing(User::getName, 
            Comparator&lt;&gt;.comparingInt(String::length)
                        .thenComparing(String.CASE_INSENSITIVE_ORDER);
        )
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="255" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="255" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Recap</h1>
<p>设计模式是面向对象编程的重要一环。上面讲的内容可能确实较多也比较难以理解，但是这些知识都不限于Java，其他面向对象编程语言都可以应用，而且对各位的OOP课程应该有比较大的帮助。</p>
<p>最后一点：</p>
<p><strong>不要首先考虑设计模式，要首先考虑具体要实现的功能。</strong> 与其在象牙塔上分析到底怎么实现比较好，不如先用具体的类写一写。在软件系统逐步演进、复杂度逐渐提高的过程中，再关注系统中耦合程度高、扩展困难、设计臃肿的地方，然后运用合适设计模式进行重构。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="256" data-paginate="true" data-background-image="url('img/bg.jpg')" data-class="lead" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" class="lead" data-marpit-pagination="256" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--class:lead;--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1><em>Chapter 4</em></h1>
<h1>Advanced language feature</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="257" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="257" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h1>JEP: JDK Enhancement Proposals</h1>
<ul>
<li>目前，Java的新特性、功能均需要先提出并起草<em>JEP</em>草案</li>
<li>在OpenJDK社区充分审核、修改、投票后成为正式的、带编号<em>JEP</em>提案</li>
<li>开发<em>JEP</em>对应的功能分支，通过所有平台测试、代码审查后，择期并入下一个发行版本的主分支</li>
<li>本节课提到的<em>JEP</em>都标注了并入的Java版本和提案原文连接，便于同学们学习参考</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="258" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="258" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2><em>[<a href="https://openjdk.org/jeps/361">JEP361</a>, Java14]</em> Switch Expressions</h2>
<p>与传统的<code>switch</code>不同，<code>switch</code>表达式使用<code>-&gt;</code>连接<code>case</code>子句和具体代码块，并且<code>case</code>子句可以一次匹配多个，代码块也不需要<code>break</code>来防止连续执行。</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">switch</span> (day) {
    <span class="hljs-keyword">case</span> MONDAY, FRIDAY, SUNDAY -&gt; System.out.println(<span class="hljs-number">6</span>);
    <span class="hljs-keyword">case</span> TUESDAY                -&gt; System.out.println(<span class="hljs-number">7</span>);
    <span class="hljs-keyword">case</span> THURSDAY, SATURDAY     -&gt; System.out.println(<span class="hljs-number">8</span>);
    <span class="hljs-keyword">case</span> WEDNESDAY              -&gt; System.out.println(<span class="hljs-number">9</span>);
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="259" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="259" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2><em>[<a href="https://openjdk.org/jeps/361">JEP361</a>, Java14]</em> Switch Expressions</h2>
<p><code>switch</code>表达式，顾名思义可以产生表达式的值：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">howMany</span><span class="hljs-params">(<span class="hljs-type">int</span> k)</span> {
    System.out.println(
        <span class="hljs-keyword">switch</span> (k) {
            <span class="hljs-keyword">case</span>  <span class="hljs-number">1</span> -&gt; <span class="hljs-string">&quot;one&quot;</span>;
            <span class="hljs-keyword">case</span>  <span class="hljs-number">2</span> -&gt; <span class="hljs-string">&quot;two&quot;</span>;
            <span class="hljs-keyword">default</span> -&gt; <span class="hljs-string">&quot;many&quot;</span>;
        }
    );
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="260" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="260" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2><em>[<a href="https://openjdk.org/jeps/361">JEP361</a>, Java14]</em> Switch Expressions</h2>
<p>如果需要复杂代码块，使用<code>{}</code>包围，并使用<code>yield</code>关键字产生<code>case</code>子句对应的值：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">switch</span> (day) {
    <span class="hljs-keyword">case</span> MONDAY  -&gt; <span class="hljs-number">0</span>;
    <span class="hljs-keyword">case</span> TUESDAY -&gt; <span class="hljs-number">1</span>;
    <span class="hljs-keyword">default</span>      -&gt; {
        <span class="hljs-type">int</span> <span class="hljs-variable">k</span> <span class="hljs-operator">=</span> day.toString().length();
        <span class="hljs-type">int</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> f(k);
        yield result;
    }
};
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="261" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="261" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2><em>[<a href="https://openjdk.org/jeps/394">JEP394</a>, Java16]</em> Pattern Matching for <code>instanceof</code></h2>
<p>使用<code>instanceof</code>判断一个对象是否为一个类的实例。一般来说，如果判断出确实是某一个类的实例，那下面一般都要向下转型为那个类的对象后再使用：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> createObject();
<span class="hljs-keyword">if</span> (o <span class="hljs-keyword">instanceof</span> MyClass) {
    <span class="hljs-type">var</span> <span class="hljs-variable">myobj</span> <span class="hljs-operator">=</span> (MyClass) o;
    <span class="hljs-comment">// do something with myobj</span>
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="262" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="262" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2><em>[<a href="https://openjdk.org/jeps/394">JEP394</a>, Java16]</em> Pattern Matching for <code>instanceof</code></h2>
<p>为了简化这这一过程，引入了<code>instanceof</code>的模式匹配语法：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> createObject();
<span class="hljs-keyword">if</span> (o <span class="hljs-keyword">instanceof</span> MyClass myobj) {
    <span class="hljs-comment">// do something with myobj</span>
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="263" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="263" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2><em>[<a href="https://openjdk.org/jeps/394">JEP394</a>, Java16]</em> Pattern Matching for <code>instanceof</code></h2>
<p>模式匹配出的变量名的作用域会由Java自动推导：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> createObject();
<span class="hljs-keyword">if</span> (o <span class="hljs-keyword">instanceof</span> MyClass myobj) {
    <span class="hljs-comment">// myobj is available</span>
}
<span class="hljs-comment">// myobj is not available</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="264" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="264" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2><em>[<a href="https://openjdk.org/jeps/394">JEP394</a>, Java16]</em> Pattern Matching for <code>instanceof</code></h2>
<p>模式匹配出的变量名的作用域会由Java自动推导：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> createObject();
<span class="hljs-keyword">if</span> (!(o <span class="hljs-keyword">instanceof</span> MyClass myobj)) {
    <span class="hljs-comment">// myobj is NOT available</span>
}
<span class="hljs-comment">// myobj is available</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="265" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="265" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2><em>[<a href="https://openjdk.org/jeps/394">JEP394</a>, Java16]</em> Pattern Matching for <code>instanceof</code></h2>
<p>模式匹配出的变量名的作用域会由Java自动推导：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> createObject();
<span class="hljs-keyword">if</span> (o <span class="hljs-keyword">instanceof</span> String s &amp;&amp; s.length() &gt; <span class="hljs-number">5</span>) { <span class="hljs-comment">// s is available after &amp;&amp;</span>
    <span class="hljs-comment">// s is available</span>
}
<span class="hljs-comment">// s is available</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="266" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="266" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2><em>[<a href="https://openjdk.org/jeps/394">JEP394</a>, Java16]</em> Pattern Matching for <code>instanceof</code></h2>
<p>模式匹配出的变量名的作用域会由Java自动推导：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> createObject();
<span class="hljs-keyword">if</span> (o <span class="hljs-keyword">instanceof</span> String s || s.length() &gt; <span class="hljs-number">5</span>) { <span class="hljs-comment">// CE!</span>
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="267" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="267" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2><em>[<a href="https://openjdk.org/jeps/395">JEP395</a>, Java16]</em> Records</h2>
<p>对于纯数据类，我们仍然要定义一大堆构造函数、赋值、Getter&amp;Setter、<code>toString</code>、<code>hashCode()</code>、<code>equals(Object)</code>等一大堆方法。尽管这些方法都可以让IDE帮忙生成，但是一大堆没营养的代码堆在那里都让人觉得异常繁琐。</p>
<p><em>记录 Record</em>就是为了解决这个问题而生。<em>Record</em>是一个<strong>只读</strong>的数据类，并且Java编译器会自动生成上面说的那一堆方法。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="268" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="268" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2><em>[<a href="https://openjdk.org/jeps/395">JEP395</a>, Java16]</em> Records</h2>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">record</span> <span class="hljs-title class_">Point</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span> {}
</code></pre>
<p>这就是一个典型的<em>Record</em>。它大多数行为都与普通类没有区别，除了它的Getter方法不叫<code>getXXX</code>而直接和变量名相同：</p>
&lt;div class="columns"&gt;
&lt;div&gt;
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; <span class="hljs-type">var</span> <span class="hljs-variable">p1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Point</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)
p1 ==&gt; Point[x=<span class="hljs-number">1</span>, y=<span class="hljs-number">2</span>]
jshell&gt; p1.toString()
$<span class="hljs-number">35</span> ==&gt; <span class="hljs-string">&quot;Point[x=1, y=2]&quot;</span>
jshell&gt; p1.hashCode()
$<span class="hljs-number">36</span> ==&gt; <span class="hljs-number">33</span>
</code></pre>
&lt;/div&gt;
&lt;div&gt;
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java">jshell&gt; p1.x()
$<span class="hljs-number">37</span> ==&gt; <span class="hljs-number">1</span>
jshell&gt; <span class="hljs-type">var</span> <span class="hljs-variable">p2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Point</span>(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)
p2 ==&gt; Point[x=<span class="hljs-number">2</span>, y=<span class="hljs-number">3</span>]
jshell&gt; p1.equals(p2)
$<span class="hljs-number">38</span> ==&gt; <span class="hljs-literal">false</span>
</code></pre>
&lt;/div&gt;
&lt;/div&gt;
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="269" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="269" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2><em>[<a href="https://openjdk.org/jeps/395">JEP395</a>, Java16]</em> Records</h2>
<h3>Compact Canonical Constructor</h3>
<p>可以使用紧凑型构造器来预处理或验证输入参数：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">record</span> <span class="hljs-title class_">Rational</span><span class="hljs-params">(<span class="hljs-type">int</span> num, <span class="hljs-type">int</span> denom)</span> {
    Rational {
        <span class="hljs-type">int</span> <span class="hljs-variable">gcd</span> <span class="hljs-operator">=</span> gcd(num, denom);
        num /= gcd;
        denom /= gcd;
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="270" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="270" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2><em>[<a href="https://openjdk.org/jeps/395">JEP395</a>, Java16]</em> Records</h2>
<h3>Compact Canonical Constructor</h3>
<p>紧凑型构建器运行完后，Java会再根据改变后的参数值对成员域进行一遍初始化。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="271" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="271" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2><em>[<a href="https://openjdk.org/jeps/395">JEP395</a>, Java16]</em> Records</h2>
<h3>Conventional Constructor</h3>
<p>也可以定义传统的构建器：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">record</span> <span class="hljs-title class_">Rational</span><span class="hljs-params">(<span class="hljs-type">int</span> num, <span class="hljs-type">int</span> denom)</span> {
    Rational(<span class="hljs-type">int</span> num, <span class="hljs-type">int</span> demon) {
        <span class="hljs-type">int</span> <span class="hljs-variable">gcd</span> <span class="hljs-operator">=</span> gcd(num, denom);
        num /= gcd;
        denom /= gcd;
        <span class="hljs-built_in">this</span>.num = num;
        <span class="hljs-built_in">this</span>.denom = denom;
    }
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="272" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="272" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2><em>[<a href="https://openjdk.org/jeps/395">JEP395</a>, Java16]</em> Records</h2>
<h3>Rules</h3>
<ul>
<li><em>record</em>类不应该继承其他的类，因为它默认继承<code>java.lang.Record</code></li>
<li><em>record</em>类隐式为<code>final</code>，并不允许为<code>abstract</code></li>
<li><em>record</em>类的成员变量隐式为<code>final</code></li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="273" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="273" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2>Annotation</h2>
<p><em>注解 Annotation</em>为代码提供了一些附加信息，如<code>@Override</code>。通过提供响应的注解处理程序，可以实现：</p>
<ol>
<li>编译时代码检查</li>
<li>编译时代码生成</li>
<li>运行时动态发现与注册</li>
</ol>
<p>等功能。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="274" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="274" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2>Annotation</h2>
<p>本次课程不讲解反射系统，因此也不会设计注解处理程序的设计。本节的目的在于如何使用注解语法。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="275" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="275" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2>Annotation</h2>
<p>Java标准库内提供的注解有：</p>
<ul>
<li><code>@Override</code>：检查是否重载方法</li>
<li><code>@Deprecated</code>：表示注解的类、常量、方法被废弃</li>
<li><code>@FunctionalInterface</code>：表示注解的接口是函数式接口</li>
<li><code>@SuppressWarnings</code>：用于让编译器忽略特定的警告</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="276" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="276" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2>Annotation</h2>
<p>注解也可以有参数值，如<code>@Deprecated</code>有<code>forRemoval</code>（警告后续版本会被移除）和<code>since</code>（从那个版本开始废弃），语法如下：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-meta">@Deprecated(forRemoval=true, since=&quot;v233&quot;)</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">OldClass</span> { <span class="hljs-comment">/* ... */</span> }
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="277" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="277" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2>Annotation</h2>
<p>声明注解的语法如下：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-meta">@Documented</span>
<span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span>
<span class="hljs-meta">@Target(value={CONSTRUCTOR, FIELD, LOCAL_VARIABLE,
                METHOD, PACKAGE, MODULE, PARAMETER, TYPE})</span>
<span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> Deprecated {
    String <span class="hljs-title function_">since</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-string">&quot;&quot;</span>;
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">forRemoval</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-literal">false</span>;
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="278" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="278" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2>Annotation</h2>
<ul>
<li><code>@Document</code>：提示这个注解应该被收入JavaDoc</li>
<li><code>@Retention(RetentionPolicy.RUNTIME)</code>：表示这个注解的信息应该保留到什么时候
<ul>
<li><code>RetentionPolicy.RUNTIME</code>：保留至运行时，反射系统可以读取</li>
<li><code>RetentionPolicy.CLASS</code>：保留至类文件</li>
<li><code>RetentionPolicy.SOURCE</code>：编译后即被丢弃</li>
</ul>
</li>
<li><code>@Target(value={ /* ... */ })</code>：提示这个注解可以应用给谁</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="279" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="279" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2>Annotation</h2>
<ul>
<li><code>@interface</code>：声明注解</li>
<li><code>&lt;Type&gt; name() [default &lt;value&gt;]</code>：声明某一类型的参数，可以提供默认值</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="280" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="280" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2>Annotation</h2>
<p>注解系统在Java标准库中应用较少，但是在其他库，如Lombok，Spring等中，都会起到举足轻重的作用。如果有时间，我们也会接触到这些类库。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="281" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="281" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2>Exception Handling</h2>
<p>Java的错误处理机制是基于<em>异常 Exception</em>的。Java程序中的任何问题、错误都是一个<code>java.lang.Throwable</code>对象，代表可以被<code>throw</code>抛出。它的子类有：</p>
<ul>
<li><code>java.lang.Throwable</code>
<ul>
<li><code>java.lang.Exception</code>：异常，可恢复的程序代码错误，应当处理</li>
<li><code>java.lang.Error</code>：错误，JVM严重的、不可恢复的错误，程序员不应当处理它们</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="282" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="282" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2>Exception Handling</h2>
<p>想要向外部抛出异常表示程序出错，使用<code>throw</code>：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">if</span> (!SUPPORTED_FILETYPE.contains(filetype)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(filetype + <span class="hljs-string">&quot; is not supported&quot;</span>);
}
</code></pre>
<p>异常均支持在实例化的时候提供自定义的错误信息以便调试查错。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="283" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="283" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2>Exception Handling</h2>
<p>想要捕获异常，使用<code>try-catch</code>：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">try</span> {
    <span class="hljs-type">var</span> <span class="hljs-variable">content</span> <span class="hljs-operator">=</span> Files.readString(Path.of(location));
} <span class="hljs-keyword">catch</span> (IOException e) {
    System.err.println(<span class="hljs-string">&quot;Failed to read &quot;</span> + location);
    e.printStackTrace();
}
</code></pre>
<p>使用<code>printStackTrace()</code>函数打印异常栈信息，描述了异常传播的途径和对应的源代码位置等信息。</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="284" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="284" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2>Exception Handling</h2>
<p>你可以利用捕获的异常去构建其他类型等异常并重新抛出，原来捕获等异常就称为新异常的<em>原因</em>。这样可以提升异常系统的语义，也防止单一异常栈过长：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">try</span> {
    <span class="hljs-type">var</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> Files.readString(Path.of(configFile));
} <span class="hljs-keyword">catch</span> (IOException e) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">GameInitException</span>(<span class="hljs-string">&quot;Failed to read config file&quot;</span>, e);
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="285" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="285" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2>Exception Handling</h2>
<p>你可以一次捕获多个异常：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">try</span> {
    <span class="hljs-type">var</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> Files.readString(Path.of(configFile));
    <span class="hljs-type">var</span> <span class="hljs-variable">jsonConfig</span> <span class="hljs-operator">=</span> parseJSON(config);
} <span class="hljs-keyword">catch</span> (IOException e) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">GameInitException</span>(<span class="hljs-string">&quot;Failed to read config file&quot;</span>, e);
} <span class="hljs-keyword">catch</span> (JSONException e) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">GameInitException</span>(<span class="hljs-string">&quot;Config file format error&quot;</span>, e);
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="286" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="286" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2>Exception Handling</h2>
<p>如果有一些系统资源，如文件句柄等，无论后续读取是否正常，都应该将其关闭。这时就需要<code>finally</code>子句进行资源回收：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-type">var</span> <span class="hljs-variable">input</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileReader</span>(<span class="hljs-string">&quot;file.txt&quot;</span>);
<span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// read data using input</span>
} <span class="hljs-keyword">catch</span> (IOException e) {
    <span class="hljs-comment">// error handling</span>
} <span class="hljs-keyword">finally</span> {
    input.close();
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="287" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="287" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2>Exception Handling</h2>
<p>对于实现了<code>AutoCloseable</code>接口的类，如所有输入输出组件，支持<code>try-with-resources</code>自动调用<code>close()</code>而无需<code>finally</code>：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">try</span> (<span class="hljs-type">var</span> <span class="hljs-variable">input</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileReader</span>(<span class="hljs-string">&quot;file.txt&quot;</span>)) {
    <span class="hljs-comment">// read data using input</span>
} <span class="hljs-keyword">catch</span> (IOException e) {
    <span class="hljs-comment">// error handling</span>
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="288" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="288" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2>Exception Handling</h2>
<p>异常分为两类：</p>
<ul>
<li><code>java.lang.RuntimeException</code>：运行时异常，又称为非检查异常。通常表示程序逻辑错误，比如数组越界，空指针等问题。</li>
<li>其他<code>java.lang.Exception</code>子类但是不是<code>java.lang.RuntimeException</code>子类的其他类：受检查异常。通常表示外部环境诱导的错误，程序应该考虑这些情况并进行处理，比如文件不存在，网络连接超时等问题。</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="289" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="289" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2>Exception Handling</h2>
<p>受检查异常得名的原因在于：</p>
<ul>
<li>可能抛出受检查异常的代码必须被<code>try-catch</code>处理，或者向外部声明自己可能传播受检查异常</li>
</ul>
<p>通过<code>throws</code>子句声明方法可能会抛出某些受检查异常：</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException {
    <span class="hljs-type">var</span> <span class="hljs-variable">content</span> <span class="hljs-operator">=</span> Files.readString(Path.of(args[<span class="hljs-number">0</span>]));
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="290" data-paginate="true" data-background-image="url('img/bg.jpg')" data-theme="gaia" data-style=".columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
" data-marpit-pagination="290" data-marpit-pagination-total="290" style="--paginate:true;--background-image:url('img/bg.jpg');--theme:gaia;--style:.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
}
;background-image:url('img/bg.jpg');background-position:center;background-repeat:no-repeat;background-size:cover;">
<h1>Advanced language feature</h1>
<h2>Exception Handling</h2>
<p>你可以使用Java标准库中提供的异常类，请参见<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Exception.html">API Ref</a>中的<code>Direct Known Subclasses</code>小节寻找是否有自己需要的异常类。</p>
<p>通过继承自<code>java.lang.Exception</code>或<code>java.lang.RuntimeException</code>，你也可以创建自定义的受检异常和非受检异常类。你可以让其包含更多调试信息或生成更清晰直观的<code>toString()</code>表示。</p>
</section>
<script>!function(){"use strict";const t={h1:{proto:()=>HTMLHeadingElement,attrs:{role:"heading","aria-level":"1"},style:"display: block; font-size: 2em; margin-block-start: 0.67em; margin-block-end: 0.67em; margin-inline-start: 0px; margin-inline-end: 0px; font-weight: bold;"},h2:{proto:()=>HTMLHeadingElement,attrs:{role:"heading","aria-level":"2"},style:"display: block; font-size: 1.5em; margin-block-start: 0.83em; margin-block-end: 0.83em; margin-inline-start: 0px; margin-inline-end: 0px; font-weight: bold;"},h3:{proto:()=>HTMLHeadingElement,attrs:{role:"heading","aria-level":"3"},style:"display: block; font-size: 1.17em; margin-block-start: 1em; margin-block-end: 1em; margin-inline-start: 0px; margin-inline-end: 0px; font-weight: bold;"},h4:{proto:()=>HTMLHeadingElement,attrs:{role:"heading","aria-level":"4"},style:"display: block; margin-block-start: 1.33em; margin-block-end: 1.33em; margin-inline-start: 0px; margin-inline-end: 0px; font-weight: bold;"},h5:{proto:()=>HTMLHeadingElement,attrs:{role:"heading","aria-level":"5"},style:"display: block; font-size: 0.83em; margin-block-start: 1.67em; margin-block-end: 1.67em; margin-inline-start: 0px; margin-inline-end: 0px; font-weight: bold;"},h6:{proto:()=>HTMLHeadingElement,attrs:{role:"heading","aria-level":"6"},style:"display: block; font-size: 0.67em; margin-block-start: 2.33em; margin-block-end: 2.33em; margin-inline-start: 0px; margin-inline-end: 0px; font-weight: bold;"},span:{proto:()=>HTMLSpanElement},pre:{proto:()=>HTMLElement,style:"display: block; font-family: monospace; white-space: pre; margin: 1em 0; --marp-auto-scaling-white-space: pre;"}},e="data-marp-auto-scaling-wrapper",i="data-marp-auto-scaling-svg",n="data-marp-auto-scaling-container";class o extends HTMLElement{constructor(){super(),this.svgPreserveAspectRatio="xMinYMid meet";const t=t=>([e])=>{const{width:i,height:n}=e.contentRect;this[t]={width:i,height:n},this.updateSVGRect()};this.attachShadow({mode:"open"}),this.containerObserver=new ResizeObserver(t("containerSize")),this.wrapperObserver=new ResizeObserver(t("wrapperSize"))}static get observedAttributes(){return["data-downscale-only"]}connectedCallback(){var t,o,s,r,a;this.shadowRoot.innerHTML=`\n<style>\n  svg[${i}] { display: block; width: 100%; height: auto; vertical-align: top; }\n  span[${n}] { display: table; white-space: var(--marp-auto-scaling-white-space, nowrap); width: max-content; }\n</style>\n<div ${e}>\n  <svg part="svg" ${i}>\n    <foreignObject><span ${n}><slot></slot></span></foreignObject>\n  </svg>\n</div>\n    `.split(/\n\s*/).join(""),this.wrapper=null!==(t=this.shadowRoot.querySelector(`div[${e}]`))&&void 0!==t?t:void 0;const l=this.svg;this.svg=null!==(s=null===(o=this.wrapper)||void 0===o?void 0:o.querySelector(`svg[${i}]`))&&void 0!==s?s:void 0,this.svg!==l&&(this.svgComputedStyle=this.svg?window.getComputedStyle(this.svg):void 0),this.container=null!==(a=null===(r=this.svg)||void 0===r?void 0:r.querySelector(`span[${n}]`))&&void 0!==a?a:void 0,this.observe()}disconnectedCallback(){this.svg=void 0,this.svgComputedStyle=void 0,this.wrapper=void 0,this.container=void 0,this.observe()}attributeChangedCallback(){this.observe()}observe(){this.containerObserver.disconnect(),this.wrapperObserver.disconnect(),this.wrapper&&this.wrapperObserver.observe(this.wrapper),this.container&&this.containerObserver.observe(this.container),this.svgComputedStyle&&this.observeSVGStyle(this.svgComputedStyle)}observeSVGStyle(t){const e=()=>{const i=(()=>{const e=t.getPropertyValue("--preserve-aspect-ratio");if(e)return e.trim();return`x${(({textAlign:t,direction:e})=>{if(t.endsWith("left"))return"Min";if(t.endsWith("right"))return"Max";if("start"===t||"end"===t){let i="rtl"===e;return"end"===t&&(i=!i),i?"Max":"Min"}return"Mid"})(t)}YMid meet`})();i!==this.svgPreserveAspectRatio&&(this.svgPreserveAspectRatio=i,this.updateSVGRect()),t===this.svgComputedStyle&&requestAnimationFrame(e)};e()}updateSVGRect(){var t,e,i,n,o,s,r;let a=Math.ceil(null!==(e=null===(t=this.containerSize)||void 0===t?void 0:t.width)&&void 0!==e?e:0);const l=Math.ceil(null!==(n=null===(i=this.containerSize)||void 0===i?void 0:i.height)&&void 0!==n?n:0);void 0!==this.dataset.downscaleOnly&&(a=Math.max(a,null!==(s=null===(o=this.wrapperSize)||void 0===o?void 0:o.width)&&void 0!==s?s:0));const c=null===(r=this.svg)||void 0===r?void 0:r.querySelector(":scope > foreignObject");if(null==c||c.setAttribute("width",`${a}`),null==c||c.setAttribute("height",`${l}`),this.svg&&(this.svg.setAttribute("viewBox",`0 0 ${a} ${l}`),this.svg.setAttribute("preserveAspectRatio",this.svgPreserveAspectRatio),this.svg.style.height=a<=0||l<=0?"0":""),this.container){const t=this.svgPreserveAspectRatio.toLowerCase();this.container.style.marginLeft=t.startsWith("xmid")||t.startsWith("xmax")?"auto":"0",this.container.style.marginRight=t.startsWith("xmi")?"auto":"0"}}}const s=(t,{attrs:e={},style:i})=>class extends t{constructor(...t){super(...t);for(const[t,i]of Object.entries(e))this.hasAttribute(t)||this.setAttribute(t,i);this.attachShadow({mode:"open"})}static get observedAttributes(){return["data-auto-scaling"]}connectedCallback(){this._update()}attributeChangedCallback(){this._update()}_update(){const t=i?`<style>:host { ${i} }</style>`:"";let e="<slot></slot>";const{autoScaling:n}=this.dataset;if(void 0!==n){e=`<marp-auto-scaling exportparts="svg:auto-scaling" ${"downscale-only"===n?"data-downscale-only":""}>${e}</marp-auto-scaling>`}this.shadowRoot.innerHTML=t+e}};let r;const a=Symbol(),l="marpitSVGPolyfill:setZoomFactor,",c=Symbol();let d,p;function g(t){const e="object"==typeof t&&t.target||document,i="object"==typeof t?t.zoom:t;window[c]||(Object.defineProperty(window,c,{configurable:!0,value:!0}),window.addEventListener("message",(({data:t,origin:e})=>{if(e===window.origin)try{if(t&&"string"==typeof t&&t.startsWith(l)){const[,e]=t.split(","),i=Number.parseFloat(e);Number.isNaN(i)||(p=i)}}catch(t){console.error(t)}})));let n=!1;Array.from(e.querySelectorAll("svg[data-marpit-svg]"),(t=>{var e,o,s,r;t.style.transform||(t.style.transform="translateZ(0)");const a=i||p||t.currentScale||1;d!==a&&(d=a,n=a);const l=t.getBoundingClientRect(),{length:c}=t.children;for(let i=0;i<c;i+=1){const n=t.children[i];if(n.getScreenCTM){const t=n.getScreenCTM();if(t){const i=null!==(o=null===(e=n.x)||void 0===e?void 0:e.baseVal.value)&&void 0!==o?o:0,c=null!==(r=null===(s=n.y)||void 0===s?void 0:s.baseVal.value)&&void 0!==r?r:0,d=n.children.length;for(let e=0;e<d;e+=1){const o=n.children[e];if("SECTION"===o.tagName){const{style:e}=o;e.transformOrigin||(e.transformOrigin=`${-i}px ${-c}px`),e.transform=`scale(${a}) matrix(${t.a}, ${t.b}, ${t.c}, ${t.d}, ${t.e-l.left}, ${t.f-l.top}) translateZ(0.0001px)`;break}}}}}})),!1!==n&&Array.from(e.querySelectorAll("iframe"),(({contentWindow:t})=>{null==t||t.postMessage(`${l}${n}`,"null"===window.origin?"*":window.origin)}))}function h({once:t=!1,target:e=document}={}){const i="Apple Computer, Inc."===navigator.vendor?[g]:[];let n=!t;const o=()=>{for(const t of i)t({target:e});n&&window.requestAnimationFrame(o)};return o(),()=>{n=!1}}d=1,p=void 0;const m=Symbol(),v=(e=document)=>{if("undefined"==typeof window)throw new Error("Marp Core's browser script is valid only in browser context.");if(((e=document)=>{const i=window[a];i||customElements.define("marp-auto-scaling",o);for(const n of Object.keys(t)){const o=`marp-${n}`,a=t[n].proto();null!=r||(r=!!document.createElement("div",{is:"marp-auto-scaling"}).outerHTML.startsWith("<div is")),r&&a!==HTMLElement?i||customElements.define(o,s(a,{style:t[n].style}),{extends:n}):(i||customElements.define(o,s(HTMLElement,t[n])),e.querySelectorAll(`${n}[is="${o}"]`).forEach((t=>{t.outerHTML=t.outerHTML.replace(new RegExp(`^<${n}`,"i"),`<${o}`).replace(new RegExp(`</${n}>$`,"i"),`</${o}>`)})))}window[a]=!0})(e),e[m])return e[m];const i=h({target:e}),n=()=>{i(),delete e[m]},l=Object.assign(n,{cleanup:n,update:()=>v(e)});return Object.defineProperty(e,m,{configurable:!0,value:l}),l},u=document.currentScript;v(u?u.getRootNode():document)}();
</script></foreignObject></svg></div><script>/*!! License: https://unpkg.com/@marp-team/marp-cli@2.0.4/lib/bespoke.js.LICENSE.txt */
!function(){"use strict";const e=document.body,t=(...e)=>history.replaceState(...e),n="presenter",r="next",o=["",n,r],a="data-bespoke-marp-",i=(e,{protocol:t,host:n,pathname:r,hash:o}=location)=>{const a=e.toString();return`${t}//${n}${r}${a?"?":""}${a}${o}`},s=()=>e.dataset.bespokeView,l=e=>new URLSearchParams(location.search).get(e),c=(e,n={})=>{var r;const o={location,setter:t,...n},a=new URLSearchParams(o.location.search);for(const t of Object.keys(e)){const n=e[t];"string"==typeof n?a.set(t,n):a.delete(t)}try{o.setter({...null!==(r=window.history.state)&&void 0!==r?r:{}},"",i(a,o.location))}catch(e){console.error(e)}},d=(()=>{const e="bespoke-marp";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}})(),u=e=>{try{return localStorage.getItem(e)}catch(e){return null}},m=(e,t)=>{try{return localStorage.setItem(e,t),!0}catch(e){return!1}},f=e=>{try{return localStorage.removeItem(e),!0}catch(e){return!1}},g=(e,t)=>{const n="aria-hidden";t?e.setAttribute(n,"true"):e.removeAttribute(n)},p=e=>{e.parent.classList.add("bespoke-marp-parent"),e.slides.forEach((e=>e.classList.add("bespoke-marp-slide"))),e.on("activate",(t=>{const n="bespoke-marp-active",r=t.slide,o=r.classList,a=!o.contains(n);if(e.slides.forEach((e=>{e.classList.remove(n),g(e,!0)})),o.add(n),g(r,!1),a){const e=`${n}-ready`;o.add(e),document.body.clientHeight,o.remove(e)}}))},v=e=>{let t=0,n=0;Object.defineProperty(e,"fragments",{enumerable:!0,value:e.slides.map((e=>[null,...e.querySelectorAll("[data-marpit-fragment]")]))});const r=r=>void 0!==e.fragments[t][n+r],o=(r,o)=>{t=r,n=o,e.fragments.forEach(((e,t)=>{e.forEach(((e,n)=>{if(null==e)return;const i=t<r||t===r&&n<=o;e.setAttribute(`${a}fragment`,(i?"":"in")+"active");const s=`${a}current-fragment`;t===r&&n===o?e.setAttribute(s,"current"):e.removeAttribute(s)}))})),e.fragmentIndex=o;const i={slide:e.slides[r],index:r,fragments:e.fragments[r],fragmentIndex:o};e.fire("fragment",i)};e.on("next",(({fragment:a=!0})=>{if(a){if(r(1))return o(t,n+1),!1;const a=t+1;e.fragments[a]&&o(a,0)}else{const r=e.fragments[t].length;if(n+1<r)return o(t,r-1),!1;const a=e.fragments[t+1];a&&o(t+1,a.length-1)}})),e.on("prev",(({fragment:a=!0})=>{if(r(-1)&&a)return o(t,n-1),!1;const i=t-1;e.fragments[i]&&o(i,e.fragments[i].length-1)})),e.on("slide",(({index:t,fragment:n})=>{let r=0;if(void 0!==n){const o=e.fragments[t];if(o){const{length:e}=o;r=-1===n?e-1:Math.min(Math.max(n,0),e-1)}}o(t,r)})),o(0,0)},h=document,y=()=>!(!h.fullscreenEnabled&&!h.webkitFullscreenEnabled),b=()=>!(!h.fullscreenElement&&!h.webkitFullscreenElement),w=e=>{e.fullscreen=()=>{y()&&(async()=>{return b()?null===(e=h.exitFullscreen||h.webkitExitFullscreen)||void 0===e?void 0:e.call(h):((e=h.body)=>{var t;return null===(t=e.requestFullscreen||e.webkitRequestFullscreen)||void 0===t?void 0:t.call(e)})();var e})()},document.addEventListener("keydown",(t=>{"f"!==t.key&&"F11"!==t.key||t.altKey||t.ctrlKey||t.metaKey||!y()||(e.fullscreen(),t.preventDefault())}))},x="bespoke-marp-inactive",k=(e=2e3)=>({parent:t,fire:n})=>{const r=t.classList,o=e=>n(`marp-${e?"":"in"}active`);let a;const i=()=>{a&&clearTimeout(a),a=setTimeout((()=>{r.add(x),o()}),e),r.contains(x)&&(r.remove(x),o(!0))};for(const e of["mousedown","mousemove","touchend"])document.addEventListener(e,i);setTimeout(i,0)},E=["AUDIO","BUTTON","INPUT","SELECT","TEXTAREA","VIDEO"],$=e=>{e.parent.addEventListener("keydown",(e=>{if(!e.target)return;const t=e.target;(E.includes(t.nodeName)||"true"===t.contentEditable)&&e.stopPropagation()}))},L=e=>{window.addEventListener("load",(()=>{for(const t of e.slides){const e=t.querySelector("marp-auto-scaling, [data-auto-scaling], [data-marp-fitting]");t.setAttribute(`${a}load`,e?"":"hideable")}}))},S=({interval:e=250}={})=>t=>{document.addEventListener("keydown",(e=>{if(" "===e.key&&e.shiftKey)t.prev();else if("ArrowLeft"===e.key||"ArrowUp"===e.key||"PageUp"===e.key)t.prev({fragment:!e.shiftKey});else if(" "!==e.key||e.shiftKey)if("ArrowRight"===e.key||"ArrowDown"===e.key||"PageDown"===e.key)t.next({fragment:!e.shiftKey});else if("End"===e.key)t.slide(t.slides.length-1,{fragment:-1});else{if("Home"!==e.key)return;t.slide(0)}else t.next();e.preventDefault()}));let n,r,o=0;t.parent.addEventListener("wheel",(a=>{let i=!1;const s=(e,t)=>{e&&(i=i||((e,t)=>((e,t)=>{const n="X"===t?"Width":"Height";return e[`client${n}`]<e[`scroll${n}`]})(e,t)&&((e,t)=>{const{overflow:n}=e,r=e[`overflow${t}`];return"auto"===n||"scroll"===n||"auto"===r||"scroll"===r})(getComputedStyle(e),t))(e,t)),(null==e?void 0:e.parentElement)&&s(e.parentElement,t)};if(0!==a.deltaX&&s(a.target,"X"),0!==a.deltaY&&s(a.target,"Y"),i)return;a.preventDefault();const l=Math.sqrt(a.deltaX**2+a.deltaY**2);if(void 0!==a.wheelDelta){if(void 0===a.webkitForce&&Math.abs(a.wheelDelta)<40)return;if(a.deltaMode===a.DOM_DELTA_PIXEL&&l<4)return}else if(a.deltaMode===a.DOM_DELTA_PIXEL&&l<12)return;r&&clearTimeout(r),r=setTimeout((()=>{n=0}),e);const c=Date.now()-o<e,d=l<=n;if(n=l,c||d)return;let u;(a.deltaX>0||a.deltaY>0)&&(u="next"),(a.deltaX<0||a.deltaY<0)&&(u="prev"),u&&(t[u](),o=Date.now())}))},P=(e=".bespoke-marp-osc")=>{const t=document.querySelector(e);if(!t)return()=>{};const n=(e,n)=>{t.querySelectorAll(`[${a}osc=${JSON.stringify(e)}]`).forEach(n)};return y()||n("fullscreen",(e=>e.style.display="none")),d||n("presenter",(e=>{e.disabled=!0,e.title="Presenter view is disabled due to restricted localStorage."})),e=>{t.addEventListener("click",(t=>{if(t.target instanceof HTMLElement){const{bespokeMarpOsc:n}=t.target.dataset;n&&t.target.blur();const r={fragment:!t.shiftKey};"next"===n?e.next(r):"prev"===n?e.prev(r):"fullscreen"===n?null==e||e.fullscreen():"presenter"===n&&e.openPresenterView()}})),e.parent.appendChild(t),e.on("activate",(({index:t})=>{n("page",(n=>n.textContent=`Page ${t+1} of ${e.slides.length}`))})),e.on("fragment",(({index:t,fragments:r,fragmentIndex:o})=>{n("prev",(e=>e.disabled=0===t&&0===o)),n("next",(n=>n.disabled=t===e.slides.length-1&&o===r.length-1))})),e.on("marp-active",(()=>g(t,!1))),e.on("marp-inactive",(()=>g(t,!0))),y()&&(e=>{for(const t of["","webkit"])h.addEventListener(t+"fullscreenchange",e)})((()=>n("fullscreen",(e=>e.classList.toggle("exit",y()&&b())))))}},_=e=>{window.addEventListener("message",(t=>{if(t.origin!==window.origin)return;const[n,r]=t.data.split(":");if("navigate"===n){const[t,n]=r.split(",");let o=Number.parseInt(t,10),a=Number.parseInt(n,10)+1;a>=e.fragments[o].length&&(o+=1,a=0),e.slide(o,{fragment:a})}}))};var T=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];let I=e=>String(e).replace(/[&<>"']/g,(e=>`&${A[e]};`)),A={"&":"amp","<":"lt",">":"gt",'"':"quot","'":"apos"},M="dangerouslySetInnerHTML",D={className:"class",htmlFor:"for"},O={};function C(e,t){let n=[],r="";t=t||{};for(let e=arguments.length;e-- >2;)n.push(arguments[e]);if("function"==typeof e)return t.children=n.reverse(),e(t);if(e){if(r+="<"+e,t)for(let e in t)!1!==t[e]&&null!=t[e]&&e!==M&&(r+=` ${D[e]?D[e]:I(e)}="${I(t[e])}"`);r+=">"}if(-1===T.indexOf(e)){if(t[M])r+=t[M].__html;else for(;n.length;){let e=n.pop();if(e)if(e.pop)for(let t=e.length;t--;)n.push(e[t]);else r+=!0===O[e]?e:I(e)}r+=e?`</${e}>`:""}return O[r]=!0,r}const N=({children:e})=>C(null,null,...e),B="bespoke-marp-presenter-",q={container:`${B}container`,dragbar:`${B}dragbar-container`,next:`${B}next`,nextContainer:`${B}next-container`,noteContainer:`${B}note-container`,noteWrapper:`${B}note-wrapper`,noteButtons:`${B}note-buttons`,infoContainer:`${B}info-container`,infoPage:`${B}info-page`,infoPageText:`${B}info-page-text`,infoPagePrev:`${B}info-page-prev`,infoPageNext:`${B}info-page-next`,noteButtonsBigger:`${B}note-bigger`,noteButtonsSmaller:`${B}note-smaller`,infoTime:`${B}info-time`,infoTimer:`${B}info-timer`},K=e=>{const{title:t}=document;document.title="[Presenter view]"+(t?` - ${t}`:"");const n={},r=e=>(n[e]=n[e]||document.querySelector(`.${e}`),n[e]);document.body.appendChild((e=>{const t=document.createElement("div");return t.className=q.container,t.appendChild(e),t.insertAdjacentHTML("beforeend",C(N,null,C("div",{class:q.nextContainer},C("iframe",{class:q.next,src:"?view=next"})),C("div",{class:q.dragbar}),C("div",{class:q.noteContainer},C("div",{class:q.noteWrapper}),C("div",{class:q.noteButtons},C("button",{class:q.noteButtonsSmaller,tabindex:"-1",title:"Smaller notes font size"},"Smaller notes font size"),C("button",{class:q.noteButtonsBigger,tabindex:"-1",title:"Bigger notes font size"},"Bigger notes font size"))),C("div",{class:q.infoContainer},C("div",{class:q.infoPage},C("button",{class:q.infoPagePrev,tabindex:"-1",title:"Previous"},"Previous"),C("span",{class:q.infoPageText}),C("button",{class:q.infoPageNext,tabindex:"-1",title:"Next"},"Next")),C("time",{class:q.infoTime,title:"Current time"}),C("time",{class:q.infoTimer,title:"Timer"})))),t})(e.parent)),(e=>{let t=!1;r(q.dragbar).addEventListener("mousedown",(()=>{t=!0,r(q.dragbar).classList.add("active")})),window.addEventListener("mouseup",(()=>{t=!1,r(q.dragbar).classList.remove("active")})),window.addEventListener("mousemove",(e=>{if(!t)return;const n=e.clientX/document.documentElement.clientWidth*100;r(q.container).style.setProperty("--bespoke-marp-presenter-split-ratio",`${Math.max(0,Math.min(100,n))}%`)})),r(q.nextContainer).addEventListener("click",(()=>e.next()));const n=r(q.next),o=(a=n,(e,t)=>{var n;return null===(n=a.contentWindow)||void 0===n?void 0:n.postMessage(`navigate:${e},${t}`,"null"===window.origin?"*":window.origin)});var a;n.addEventListener("load",(()=>{r(q.nextContainer).classList.add("active"),o(e.slide(),e.fragmentIndex),e.on("fragment",(({index:e,fragmentIndex:t})=>o(e,t)))}));const i=document.querySelectorAll(".bespoke-marp-note");i.forEach((e=>{e.addEventListener("keydown",(e=>e.stopPropagation())),r(q.noteWrapper).appendChild(e)})),e.on("activate",(()=>i.forEach((t=>t.classList.toggle("active",t.dataset.index==e.slide())))));let s=0;const l=e=>{s=Math.max(-5,s+e),r(q.noteContainer).style.setProperty("--bespoke-marp-note-font-scale",(1.2**s).toFixed(4))},c=()=>l(1),d=()=>l(-1),u=r(q.noteButtonsBigger),m=r(q.noteButtonsSmaller);u.addEventListener("click",(()=>{u.blur(),c()})),m.addEventListener("click",(()=>{m.blur(),d()})),document.addEventListener("keydown",(e=>{"+"===e.key&&c(),"-"===e.key&&d()}),!0),e.on("activate",(({index:t})=>{r(q.infoPageText).textContent=`${t+1} / ${e.slides.length}`}));const f=r(q.infoPagePrev),g=r(q.infoPageNext);f.addEventListener("click",(t=>{f.blur(),e.prev({fragment:!t.shiftKey})})),g.addEventListener("click",(t=>{g.blur(),e.next({fragment:!t.shiftKey})})),e.on("fragment",(({index:t,fragments:n,fragmentIndex:r})=>{f.disabled=0===t&&0===r,g.disabled=t===e.slides.length-1&&r===n.length-1}));let p=new Date;const v=()=>{const e=new Date,t=e=>`${Math.floor(e)}`.padStart(2,"0"),n=e.getTime()-p.getTime(),o=t(n/1e3%60),a=t(n/1e3/60%60),i=t(n/36e5%24);r(q.infoTime).textContent=e.toLocaleTimeString(),r(q.infoTimer).textContent=`${i}:${a}:${o}`};v(),setInterval(v,250),r(q.infoTimer).addEventListener("click",(()=>{p=new Date}))})(e)},F=e=>{if(!(e=>e.syncKey&&"string"==typeof e.syncKey)(e))throw new Error("The current instance of Bespoke.js is invalid for Marp bespoke presenter plugin.");Object.defineProperties(e,{openPresenterView:{enumerable:!0,value:j},presenterUrl:{enumerable:!0,get:U}}),d&&document.addEventListener("keydown",(t=>{"p"!==t.key||t.altKey||t.ctrlKey||t.metaKey||(t.preventDefault(),e.openPresenterView())}))};function j(){const{max:e,floor:t}=Math,n=e(t(.85*window.innerWidth),640),r=e(t(.85*window.innerHeight),360);return window.open(this.presenterUrl,B+this.syncKey,`width=${n},height=${r},menubar=no,toolbar=no`)}function U(){const e=new URLSearchParams(location.search);return e.set("view","presenter"),e.set("sync",this.syncKey),i(e)}const V=e=>{const t=s();return t===r&&e.appendChild(document.createElement("span")),{"":F,[n]:K,[r]:_}[t]},X=e=>{e.on("activate",(t=>{document.querySelectorAll(".bespoke-progress-parent > .bespoke-progress-bar").forEach((n=>{n.style.flexBasis=100*t.index/(e.slides.length-1)+"%"}))}))},H=e=>{const t=Number.parseInt(e,10);return Number.isNaN(t)?null:t},R=(e={})=>{const t={history:!0,...e};return e=>{let n=!0;const r=e=>{const t=n;try{return n=!0,e()}finally{n=t}},o=(t={fragment:!0})=>{((t,n)=>{const{min:r,max:o}=Math,{fragments:a,slides:i}=e,s=o(0,r(t,i.length-1)),l=o(0,r(n||0,a[s].length-1));s===e.slide()&&l===e.fragmentIndex||e.slide(s,{fragment:l})})((H(location.hash.slice(1))||1)-1,t.fragment?H(l("f")||""):null)};e.on("fragment",(({index:e,fragmentIndex:r})=>{n||c({f:0===r||r.toString()},{location:{...location,hash:`#${e+1}`},setter:(...e)=>t.history?history.pushState(...e):history.replaceState(...e)})})),setTimeout((()=>{o(),window.addEventListener("hashchange",(()=>r((()=>{o({fragment:!1}),c({f:void 0})})))),window.addEventListener("popstate",(()=>{n||r((()=>o()))})),n=!1}),0)}},W=(e={})=>{var n;const r=e.key||(null===(n=window.history.state)||void 0===n?void 0:n.marpBespokeSyncKey)||Math.random().toString(36).slice(2),o=`bespoke-marp-sync-${r}`;var a;a={marpBespokeSyncKey:r},c({},{setter:(e,...n)=>t({...e,...a},...n)});const i=()=>{const e=u(o);return e?JSON.parse(e):Object.create(null)},s=e=>{const t=i(),n={...t,...e(t)};return m(o,JSON.stringify(n)),n},l=()=>{window.removeEventListener("pageshow",l),s((e=>({reference:(e.reference||0)+1})))};return e=>{l(),Object.defineProperty(e,"syncKey",{value:r,enumerable:!0});let t=!0;setTimeout((()=>{e.on("fragment",(e=>{t&&s((()=>({index:e.index,fragmentIndex:e.fragmentIndex})))}))}),0),window.addEventListener("storage",(n=>{if(n.key===o&&n.oldValue&&n.newValue){const r=JSON.parse(n.oldValue),o=JSON.parse(n.newValue);if(r.index!==o.index||r.fragmentIndex!==o.fragmentIndex)try{t=!1,e.slide(o.index,{fragment:o.fragmentIndex,forSync:!0})}finally{t=!0}}}));const n=()=>{const{reference:e}=i();void 0===e||e<=1?f(o):s((()=>({reference:e-1})))};window.addEventListener("pagehide",(e=>{e.persisted&&window.addEventListener("pageshow",l),n()})),e.on("destroy",n)}},{PI:J,abs:Y,sqrt:z,atan2:G}=Math,Q={passive:!0},Z=({slope:e=-.7,swipeThreshold:t=30}={})=>n=>{let r;const o=n.parent,a=e=>{const t=o.getBoundingClientRect();return{x:e.pageX-(t.left+t.right)/2,y:e.pageY-(t.top+t.bottom)/2}};o.addEventListener("touchstart",(({touches:e})=>{r=1===e.length?a(e[0]):void 0}),Q),o.addEventListener("touchmove",(e=>{if(r)if(1===e.touches.length){e.preventDefault();const t=a(e.touches[0]),n=t.x-r.x,o=t.y-r.y;r.delta=z(Y(n)**2+Y(o)**2),r.radian=G(n,o)}else r=void 0})),o.addEventListener("touchend",(o=>{if(r){if(r.delta&&r.delta>=t&&r.radian){const t=(r.radian-e+J)%(2*J)-J;n[t<0?"next":"prev"](),o.stopPropagation()}r=void 0}}),Q)},ee=new Map;ee.clear(),ee.set("none",{backward:{both:void 0,incoming:void 0,outgoing:void 0},forward:{both:void 0,incoming:void 0,outgoing:void 0}});const te={both:"",outgoing:"outgoing-",incoming:"incoming-"},ne={forward:"",backward:"-backward"},re=e=>`--marp-bespoke-transition-animation-${e}`,oe=e=>`--marp-transition-${e}`,ae=re("name"),ie=re("duration"),se=e=>new Promise((t=>{const n={},r=document.createElement("div"),o=e=>{r.remove(),t(e)};r.addEventListener("animationstart",(()=>o(n))),Object.assign(r.style,{animationName:e,animationDuration:"1s",animationFillMode:"both",animationPlayState:"paused",position:"absolute",pointerEvents:"none"}),document.body.appendChild(r);const a=getComputedStyle(r).getPropertyValue(oe("duration"));a&&(n.defaultDuration=a),((e,t)=>{requestAnimationFrame((()=>{e.style.animationPlayState="running",requestAnimationFrame((()=>t(void 0)))}))})(r,o)})),le=async e=>ee.has(e)?ee.get(e):(e=>{const t={},n=[];for(const[r,o]of Object.entries(te))for(const[a,i]of Object.entries(ne)){const s=`marp-${o}transition${i}-${e}`;n.push(se(s).then((e=>{t[a]=t[a]||{},t[a][r]=e?{...e,name:s}:void 0})))}return Promise.all(n).then((()=>t))})(e).then((t=>(ee.set(e,t),t))),ce=e=>Object.values(e).flatMap(Object.values).every((e=>!e)),de=(e,{type:t,backward:n})=>{const r=e[n?"backward":"forward"],o=(()=>{const e=r[t],n=e=>({[ae]:e.name});if(e)return n(e);if(r.both){const e=n(r.both);return"incoming"===t&&(e[re("direction")]="reverse"),e}})();return!o&&n?de(e,{type:t,backward:!1}):o||{[ae]:"__bespoke_marp_transition_no_animation__"}},ue=e=>{if(e)try{const t=JSON.parse(e);if((e=>{if("object"!=typeof e)return!1;const t=e;return"string"==typeof t.name&&(void 0===t.duration||"string"==typeof t.duration)})(t))return t}catch(e){}},me="_tSId",fe="_tA",ge="bespoke-marp-transition-warming-up",pe=window.matchMedia("(prefers-reduced-motion: reduce)"),ve="__bespoke_marp_transition_reduced_outgoing__",he="__bespoke_marp_transition_reduced_incoming__",ye={forward:{both:void 0,incoming:{name:he},outgoing:{name:ve}},backward:{both:void 0,incoming:{name:he},outgoing:{name:ve}}},be=e=>{if(!document.createDocumentTransition)return;const t=t=>(void 0!==t&&(e._tD=t),e._tD);let n;t(!1);const r=(e,n)=>{requestAnimationFrame((async()=>{t(e);try{await n()}catch(e){console.warn(e)}finally{t(!1)}}))};((...e)=>{const t=[...new Set(e).values()];return Promise.all(t.map((e=>le(e)))).then()})(...Array.from(document.querySelectorAll("section[data-transition], section[data-transition-back]")).flatMap((e=>[e.dataset.transition,e.dataset.transitionBack].flatMap((e=>{const t=ue(e);return[null==t?void 0:t.name,(null==t?void 0:t.builtinFallback)?`__builtin__${t.name}`:void 0]})).filter((e=>!!e))))).then((()=>{document.querySelectorAll("style").forEach((e=>{e.innerHTML=e.innerHTML.replace(/--marp-transition-duration:[^;}]*[;}]/g,(e=>e.slice(0,-1)+"!important"+e.slice(-1)))}))}));const o=(n,{back:o,cond:a})=>i=>{var s;const l=t();if(l)return!!i._tA||!("object"!=typeof l||(l.abandon(),!i.forSync));if(!a(i))return!0;const c=e.slides[e.slide()],d=()=>{var e;return null!==(e=i.back)&&void 0!==e?e:o},u="data-transition"+(d()?"-back":""),m=c.querySelector(`section[${u}]`);if(!m)return!0;const f=ue(null!==(s=m.getAttribute(u))&&void 0!==s?s:void 0);return!f||((async(e,{builtinFallback:t=!0}={})=>{let n=await le(e);if(ce(n)){if(!t)return;return n=await le(`__builtin__${e}`),ce(n)?void 0:n}return n})(f.name,{builtinFallback:f.builtinFallback}).then((e=>{if(!e)return r(!0,(()=>n(i)));let o=e;pe.matches&&(console.warn("Use a constant animation to transition because preferring reduced motion by viewer has detected. "),o=ye);const a=document.getElementById(me);a&&a.remove();const s=document.createElement("style");s.id=me,document.head.appendChild(s),((e,t)=>{const n=[`:root{${oe("direction")}:${t.backward?-1:1};}`],r=t=>{var n,o,a;const i=(null===(n=e[t].both)||void 0===n?void 0:n.defaultDuration)||(null===(o=e[t].outgoing)||void 0===o?void 0:o.defaultDuration)||(null===(a=e[t].incoming)||void 0===a?void 0:a.defaultDuration);return"forward"===t?i:i||r("forward")},o=t.duration||r(t.backward?"backward":"forward");void 0!==o&&n.push(`::page-transition-container(*){${ie}:${o};}`);const a=e=>Object.entries(e).map((([e,t])=>`${e}:${t};`)).join("");return n.push(`::page-transition-outgoing-image(root){${a(de(e,{...t,type:"outgoing"}))}}`,`::page-transition-incoming-image(root){${a(de(e,{...t,type:"incoming"}))}}`),n})(o,{backward:d(),duration:f.duration}).forEach((e=>{var t;return null===(t=s.sheet)||void 0===t?void 0:t.insertRule(e)}));try{const e=document.createDocumentTransition(),t=document.documentElement.classList;t.add(ge);let o=!1;const a=()=>{o||(n(i),o=!0,t.remove(ge))};r(e,(async()=>{try{await e.start(a)}catch(e){console.error(e),a()}finally{s.remove(),t.remove(ge)}}))}catch(e){t(!1)}})),!1)};e.on("prev",o((t=>e.prev({...t,[fe]:!0})),{back:!0,cond:e=>{var t;return e.index>0&&!((null===(t=e.fragment)||void 0===t||t)&&n.fragmentIndex>0)}})),e.on("next",o((t=>e.next({...t,[fe]:!0})),{cond:t=>t.index+1<e.slides.length&&!(n.fragmentIndex+1<n.fragments.length)})),setTimeout((()=>{e.on("slide",o((t=>e.slide(t.index,{...t,[fe]:!0})),{cond:t=>{const n=e.slide();return t.index!==n&&(t.back=t.index<n,!0)}}))}),0),e.on("fragment",(e=>{n=e}))};let we;const xe=()=>(void 0===we&&(we="wakeLock"in navigator&&navigator.wakeLock),we),ke=async()=>{const e=xe();if(e)try{return await e.request("screen")}catch(e){console.warn(e)}return null},Ee=async()=>{if(!xe())return;let e;const t=()=>{e&&"visible"===document.visibilityState&&ke()};for(const e of["visibilitychange","fullscreenchange"])document.addEventListener(e,t);return e=await ke(),e};((t=document.getElementById("p"))=>{(()=>{const t=l("view");e.dataset.bespokeView=t===r||t===n?t:""})();const a=(e=>{const t=l(e);return c({[e]:void 0}),t})("sync")||void 0;var i,d,u,m,f,g,h,y,b,x,E,_;i=t,d=((...e)=>{const t=o.findIndex((e=>s()===e));return e.map((([e,n])=>e[t]&&n)).filter((e=>e))})([[1,1,0],W({key:a})],[[1,1,1],V(t)],[[1,1,0],$],[[1,1,1],p],[[1,0,0],k()],[[1,1,1],L],[[1,1,1],R({history:!1})],[[1,1,0],S()],[[1,1,0],w],[[1,0,0],X],[[1,1,0],Z()],[[1,0,0],P()],[[1,0,0],be],[[1,1,1],v],[[1,1,0],Ee]),m=1===(i.parent||i).nodeType?i.parent||i:document.querySelector(i.parent||i),f=[].filter.call("string"==typeof i.slides?m.querySelectorAll(i.slides):i.slides||m.children,(function(e){return"SCRIPT"!==e.nodeName})),g={},h=function(e,t){return(t=t||{}).index=f.indexOf(e),t.slide=e,t},x=function(e,t){f[e]&&(u&&b("deactivate",h(u,t)),u=f[e],b("activate",h(u,t)))},E=function(e,t){var n=f.indexOf(u)+e;b(e>0?"next":"prev",h(u,t))&&x(n,t)},_={off:y=function(e,t){g[e]=(g[e]||[]).filter((function(e){return e!==t}))},on:function(e,t){return(g[e]||(g[e]=[])).push(t),y.bind(null,e,t)},fire:b=function(e,t){return(g[e]||[]).reduce((function(e,n){return e&&!1!==n(t)}),!0)},slide:function(e,t){if(!arguments.length)return f.indexOf(u);b("slide",h(f[e],t))&&x(e,t)},next:E.bind(null,1),prev:E.bind(null,-1),parent:m,slides:f,destroy:function(e){b("destroy",h(u,e)),g={}}},(d||[]).forEach((function(e){e(_)})),u||x(0)})()}();</script></body></html>